<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kubernetes on ä¹±ä¸–æµ®ç”Ÿ</title><link>https://atbug.com/tags/kubernetes/</link><description>Recent content in Kubernetes on ä¹±ä¸–æµ®ç”Ÿ</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Mon, 07 Feb 2022 01:00:29 +0800</lastBuildDate><atom:link href="https://atbug.com/tags/kubernetes/index.xml" rel="self" type="application/rss+xml"/><item><title>æ¢ç§˜ k8eï¼šæç®€ Kubernetes å‘è¡Œç‰ˆ</title><link>https://atbug.com/articles/explore-simple-kubernetes-distribution/</link><pubDate>Mon, 07 Feb 2022 01:00:29 +0800</pubDate><guid>https://atbug.com/articles/explore-simple-kubernetes-distribution/</guid><description>TL;DR æœ¬æ–‡ä»‹ç»å¹¶å®‰è£…ä½“éªŒäº†æç®€ Kubernetes å‘è¡Œç‰ˆï¼Œä¹Ÿé¡ºä¾¿åˆ†æå­¦ä¹ ä¸‹ç¼–è¯‘çš„æµç¨‹ã€‚
èƒŒæ™¯ k8e æœ¬æ„ä¸º kuber easyï¼Œæ˜¯ä¸€ä¸ª Kubernetes çš„æç®€å‘è¡Œç‰ˆï¼Œæ„å›¾è®©äº‘åŸç”Ÿè½åœ°éƒ¨ç½² Kubernetes æ›´è½»æ¾ã€‚k8e æ˜¯åŸºäºå¦ä¸€ä¸ªå‘è¡Œç‰ˆ k3s ï¼Œç»è¿‡è£å‰ªï¼ˆå»æ‰äº† Edge/IoT ç›¸å…³åŠŸèƒ½ã€traefixç­‰ï¼‰ã€æ‰©å±•ï¼ˆåŠ å…¥ ingressã€sidecar å®ç°ã€ciliumç­‰ï¼‰è€Œæ¥ã€‚
k8e å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š
å•äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé›†æˆäº† k8s çš„å„ç§ç»„ä»¶ã€containerdã€runcã€kubectlã€nerdctl ç­‰ ä½¿ç”¨ cilium ä½œä¸º cni çš„å®ç°ï¼Œæ–¹ä¾¿ eBPF çš„å¿«é€Ÿè½åœ° æ”¯æŒåŸºäº Pipy çš„ ingressã€sidecar proxyï¼Œå®ç°åº”ç”¨æµé‡ä¸€ç«™å¼ç®¡ç† åªç»´æŠ¤ä¸€ä¸ª k8s ç‰ˆæœ¬ï¼Œç›®å‰æ˜¯ 1.</description></item><item><title>è¿½è¸ª Kubernetes ä¸­çš„ç½‘ç»œæµé‡</title><link>https://atbug.com/articles/tracing-path-of-kubernetes-network-packets/</link><pubDate>Sat, 22 Jan 2022 10:15:31 +0800</pubDate><guid>https://atbug.com/articles/tracing-path-of-kubernetes-network-packets/</guid><description>è¯‘è€…æ³¨ï¼š
è¿™ç¯‡æ–‡ç« å¾ˆå…¨é¢çš„ç½—åˆ—å‡ºäº† Kubernetes ä¸­æ¶‰åŠçš„ç½‘ç»œçŸ¥è¯†ï¼Œä» Linux å†…æ ¸çš„ç½‘ç»œå†…å®¹ï¼Œåˆ°å®¹å™¨ã€Kubernetesï¼Œä¸€ä¸€è¿›è¡Œäº†è¯¦ç»†çš„è¯´æ˜ã€‚
â€‹æ–‡ç« ç¯‡å¹…æœ‰ç‚¹é•¿ï¼Œä¸å¾—ä¸è¯´ï¼Œç½‘ç»œæ˜¯å¾ˆå¤æ‚å¾ˆéº»çƒ¦çš„ä¸€å±‚ï¼Œä½†æ°æ°è¿™å±‚å¤šå¹´æ¥å˜åŒ–ä¸å¤§ã€‚å¸Œæœ›ç¿»è¯‘çš„å†…å®¹å¯¹å¤§å®¶èƒ½æœ‰æ‰€å¸®åŠ©ï¼Œæœ‰è¯¯çš„åœ°æ–¹ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶æŒ‡æ­£ã€‚
æœ¬æ–‡ç¿»è¯‘è·å¾— Learnk8s çš„æˆæƒï¼ŒåŸæ–‡ Tracing the path of network traffic in Kubernetes ä½œè€… Kristijan Mitevskiã€‚
TL;DRï¼š æœ¬æ–‡å°†ä»£ç†äº†è§£ Kubernetes é›†ç¾¤å†…å¤–çš„æ•°æ®æµè½¬ã€‚ä»æœ€åˆçš„ Web è¯·æ±‚å¼€å§‹ï¼Œä¸€ç›´åˆ°æ‰˜ç®¡åº”ç”¨ç¨‹åºçš„å®¹å™¨ã€‚
ç›®å½• ç›®å½• Kubernetes ç½‘ç»œè¦æ±‚ Linux ç½‘ç»œå‘½åç©ºé—´å¦‚æœåœ¨ pod ä¸­å·¥ä½œ Pause å®¹å™¨åˆ›å»º Pod ä¸­çš„ç½‘ç»œå‘½åç©ºé—´ ä¸º Pod åˆ†é…äº† IP åœ°å€ æ£€æŸ¥é›†ç¾¤ä¸­ pod åˆ° pod çš„æµé‡ Pod å‘½åç©ºé—´è¿æ¥åˆ°ä»¥å¤ªç½‘æ¡¥æ¥å™¨ è·Ÿè¸ªåŒä¸€èŠ‚ç‚¹ä¸Š pod é—´çš„æµé‡ è·Ÿè¸ªä¸åŒèŠ‚ç‚¹ä¸Š pod é—´çš„é€šä¿¡ ä½è¿ç®—çš„å·¥ä½œåŸç† å®¹å™¨ç½‘ç»œæ¥å£ - CNI æ£€æŸ¥ pod åˆ°æœåŠ¡çš„æµé‡ ä½¿ç”¨ Netfilter å’Œ Iptables æ‹¦æˆªå’Œé‡å†™æµé‡ æ£€æŸ¥æœåŠ¡çš„å“åº” å›é¡¾ Kubernetes ç½‘ç»œè¦æ±‚ åœ¨æ·±å…¥äº†è§£ Kubernetes ä¸­çš„æ•°æ®æµè½¬ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¾„æ¸…ä¸‹ Kubernetes ç½‘ç»œçš„è¦æ±‚ã€‚</description></item><item><title>Kubernetes HPA åŸºäº Prometheus è‡ªå®šä¹‰æŒ‡æ ‡çš„å¯æ§å¼¹æ€§ä¼¸ç¼©</title><link>https://atbug.com/articles/kubernetes-pod-autoscale-on-prometheus-metrics/</link><pubDate>Tue, 18 Jan 2022 12:03:59 +0800</pubDate><guid>https://atbug.com/articles/kubernetes-pod-autoscale-on-prometheus-metrics/</guid><description>åœ¨ã€ŠKubernetes çš„è‡ªåŠ¨ä¼¸ç¼©ä½ ç”¨å¯¹äº†å—ï¼Ÿã€‹ ä¸€æ–‡ä¸­è¯¦ç»†è¯´æ˜äº†å¦‚ä½•ä½¿ç”¨ Kubernetes çš„è‡ªåŠ¨ä¼¸ç¼©ã€‚åœ¨ Kubernetes ä¸­å¼¹æ€§ä¼¸ç¼©ä¸»è¦æœ‰ä¸‰ç§ï¼šHPAã€VPAã€CAã€‚æœ¬æ–‡ä¸å†è¯¦ç»†è¯´æ˜ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹é‚£ç¯‡æ–‡ç« ã€‚è¿™é‡Œä¸»è¦æ¥è¯´ä¸‹ Pod æ°´å¹³ç¼©æ”¾ HPAã€‚
éšç€ Kubernetes v1.23 çš„å‘å¸ƒï¼ŒHPA çš„ API æ¥åˆ°äº†ç¨³å®šç‰ˆ autoscaling/v2ï¼š
åŸºäºè‡ªå®šä¹‰æŒ‡æ ‡çš„ä¼¸ç¼© åŸºäºå¤šé¡¹æŒ‡æ ‡çš„ä¼¸ç¼© å¯é…ç½®çš„ä¼¸ç¼©è¡Œä¸º ä»æœ€åˆçš„ v1 ç‰ˆæœ¬ HPA åªæ”¯æŒ CPUã€å†…å­˜åˆ©ç”¨ç‡çš„ä¼¸ç¼©ï¼Œåˆ°åæ¥çš„è‡ªå®šä¹‰æŒ‡æ ‡ã€èšåˆå±‚ API çš„æ”¯æŒï¼Œåˆ°äº† v1.18 ç‰ˆæœ¬åˆåŠ å…¥äº†é…ç½®ä¼¸ç¼©è¡Œä¸ºçš„æ”¯æŒï¼ŒHPA ä¹Ÿè¶Šæ¥è¶Šå¥½ç”¨ã€å¯é ã€‚
ä¾é  CPU æˆ–è€…å†…å­˜æŒ‡æ ‡çš„æ‰©å®¹å¹¶éä½¿ç”¨æ‰€æœ‰ç³»ç»Ÿï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡é‚£ä¹ˆå¯é ã€‚å¯¹å¤§éƒ¨åˆ†çš„ web åç«¯ç³»ç»Ÿæ¥è¯´ï¼ŒåŸºäº RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰çš„å¼¹æ€§ä¼¸ç¼©æ¥å¤„ç†çªå‘çš„æµé‡åˆ™ä¼šæ›´åŠ é è°±ã€‚</description></item><item><title>Colimaï¼šMacOS ä¸Šçš„æç®€å®¹å™¨è¿è¡Œæ—¶å’Œ Kubernetesï¼ˆæ”¯æŒ m1ï¼‰</title><link>https://atbug.com/articles/containers-runtime-on-macos-with-colima/</link><pubDate>Sun, 26 Dec 2021 12:31:16 +0800</pubDate><guid>https://atbug.com/articles/containers-runtime-on-macos-with-colima/</guid><description>Colima æ˜¯ä¸€ä¸ªä»¥æœ€å°åŒ–è®¾ç½®æ¥åœ¨MacOSä¸Šè¿è¡Œå®¹å™¨è¿è¡Œæ—¶å’Œ Kubernetes çš„å·¥å…·ã€‚æ”¯æŒ m1ï¼ˆæ–‡æœ«è®¨è®ºï¼‰ï¼ŒåŒæ ·ä¹Ÿæ”¯æŒ Linuxã€‚
Colima çš„åå­—å–è‡ª Container on Limaã€‚Lima æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºå·¥å…·ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨çš„æ–‡ä»¶å…±äº«ã€ç«¯å£è½¬å‘ä»¥åŠ containerdã€‚
Colima å®é™…ä¸Šæ˜¯é€šè¿‡ Lima å¯åŠ¨äº†åä¸º colima çš„è™šæ‹Ÿæœºï¼Œä½¿ç”¨è™šæ‹Ÿæœºä¸­çš„ containerd ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ã€‚
ä½¿ç”¨ Colima çš„ä½¿ç”¨å¾ˆç®€å•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥åˆ›å»ºè™šæ‹Ÿæœºï¼Œé»˜è®¤æ˜¯ Docker çš„è¿è¡Œæ—¶ã€‚
åˆæ¬¡è¿è¡Œéœ€è¦ä¸‹è½½è™šæ‹Ÿæœºé•œåƒåˆ›å»ºè™šæ‹Ÿæœºï¼Œè€—æ—¶å› ç½‘ç»œæƒ…å†µæœ‰æ‰€å·®å¼‚ã€‚ä¹‹åï¼Œå¯åŠ¨è™šæ‹Ÿæœºå°±åªéœ€è¦ 30s å·¦å³çš„æ—¶é—´ã€‚
colima start INFO[0000] starting colima INFO[0000] creating and starting ... context=vm INFO[0119] provisioning .</description></item><item><title>OpenFaaS - ä»¥è‡ªå·±çš„æ–¹å¼è¿è¡Œå®¹å™¨åŒ–å‡½æ•°</title><link>https://atbug.com/articles/openfaas-case-study-zh/</link><pubDate>Fri, 17 Dec 2021 09:13:59 +0800</pubDate><guid>https://atbug.com/articles/openfaas-case-study-zh/</guid><description>è¯‘è€…æ³¨ï¼š æœ¬æ–‡ç¯‡å¹…è¾ƒé•¿ï¼Œæœ‰åŠ©äºäº†è§£ FaaS å’Œ OpenFaaSã€‚ä½œè€…åˆ†åˆ«ä»å¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜çš„è§†è§’æ¥äº†è§£ OpenFaaSï¼Œå¯¹äº†è§£æ–°çš„æŠ€æœ¯æ˜¯ä¸ªå¾ˆå¥½çš„æ–¹å¼ã€‚
æœ¬æ–‡ç¿»è¯‘è‡ª Ivan Velichko çš„ OpenFaaS - Run Containerized Functions On Your Own Termsã€‚
é•¿æœŸä»¥æ¥ï¼Œæ— æœåŠ¡å™¨ï¼ˆserverlessï¼‰ å¯¹æˆ‘æ¥è¯´æ— éå°±æ˜¯ AWS Lambda çš„ä»£åè¯ã€‚Lambda æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„é€”å¾„ï¼Œå¯ä»¥å°†ä»»æ„ä»£ç é™„åŠ åˆ°å¹³å°äº‹ä»¶ï¼ˆäº‘å®ä¾‹çš„çŠ¶æ€å˜æ›´ã€DynamoDB è®°å½•çš„æ›´æ–°æˆ–æ–°çš„ SNS æ¶ˆæ¯ï¼‰ä¸­ã€‚ä½†æ˜¯ï¼Œæˆ‘æ—¶ä¸æ—¶ä¼šæƒ³åˆ°æŸä¸ªé€»è¾‘ï¼Œä½†å…¶åˆæ²¡å¤§åˆ°è¶³ä»¥æœ‰è‡ªå·±çš„æœåŠ¡ï¼ŒåŒæ—¶æœ‰ä¸é€‚åˆä»»ä½•ç°æœ‰æœåŠ¡çš„èŒƒå›´ã€‚å› æ­¤ï¼Œæˆ‘ç»å¸¸å°†å…¶æ”¾å…¥å‡½æ•°ä¸­ï¼Œä»¥ä¾¿æ—¥åä½¿ç”¨ CLI å‘½ä»¤æˆ–è€… HTTP è°ƒç”¨æ¥è°ƒç”¨å®ƒã€‚
å‡ å¹´å‰ï¼Œæˆ‘æ¥å¼€äº† AWSï¼Œè‡ªé‚£ä»¥åï¼Œæˆ‘ä¸€ç›´æ€€å¿µéƒ¨ç½²æ— æœåŠ¡å™¨åŠŸèƒ½çš„ä¾¿åˆ©æ€§ã€‚å› æ­¤ï¼Œå½“æˆ‘å¾—çŸ¥ OpenFaaS é¡¹ç›®æ—¶æƒŠå–œä¸‡åˆ†ã€‚å®ƒå°†åœ¨ Kubernetes é›†ç¾¤ä¸Šéƒ¨ç½²å‡½æ•°å˜å¾—ç®€å•ï¼Œç”šè‡³ä»…éœ€è¦ Containerd å°±å¯ä»¥éƒ¨ç½²åˆ°è™šæ‹Ÿæœºä¸Šã€‚</description></item><item><title>ç­–ç•¥å³ä»£ç ï¼šä¸ºäº† OpenPolicyAgent å­¦ Regoï¼Ÿè¯•è¯• Javascript</title><link>https://atbug.com/articles/policy-as-code-with-pipy/</link><pubDate>Wed, 08 Dec 2021 07:49:37 +0800</pubDate><guid>https://atbug.com/articles/policy-as-code-with-pipy/</guid><description>è·ç¦»ä¸Šä¸ªç‰ˆæœ¬ ç”¨ Pipy å®ç° OPAï¼Œå·²ç»è¿‡å»å¿«åŠå¹´äº†ã€‚å½“åˆä½¿ç”¨Pipy å®ç°äº†å¯ä¿¡é•œåƒä»“åº“çš„æ£€æŸ¥ï¼Œé‚£æ—¶çš„ç‰ˆæœ¬å®ç°èµ·æ¥ä¼šç¨å¾®å¤æ‚ï¼Œä»ç­–ç•¥ä»“åº“åˆ°è¯ä¹¦åˆ›å»ºåˆ°Admission Webhook çš„åˆ›å»ºéƒ½éœ€è¦å¤§é‡çš„äººå·¥æ“ä½œï¼Œé…ç½®å’Œé€»è¾‘ä¹Ÿè¿˜æ˜¯è€¦åˆåœ¨ä¸€èµ·ã€‚
è¿™ä¸ªç‰ˆæœ¬å®‰è£…å’Œä½¿ç”¨èµ·æ¥ä¼šæ›´åŠ ç®€å•ã€‚
å½“åˆæˆ‘ç”¨â€œä¸åŠ¡æ­£ä¸šâ€æ¥å½¢å®¹ Pipy å®ç°å‡†å…¥æ§åˆ¶ï¼Œç­‰çœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œæ¬¢è¿ç•™è¨€è¯´è¯´ä½ çš„çœ‹æ³•ã€‚
æ¶æ„ è¿˜æ˜¯ç»§ç»­ä¸Šæ¬¡çš„åœºæ™¯ï¼Œåœ¨ Pod åˆ›å»ºæ—¶å¯¹ Pod ä½¿ç”¨çš„é•œåƒæ‰€åœ¨ä»“åº“è¿›è¡Œæ£€æŸ¥ï¼Œä»¥åŠæ£€æŸ¥é•œåƒçš„ tag æ˜¯å¦åˆæ³•ã€‚
è¿™é‡Œå€ŸåŠ© Pipy Repo çš„èƒ½åŠ›ï¼Œå°†ä»£è¡¨ç­–ç•¥çš„è„šæœ¬å’Œé…ç½®äº¤ç”± Repo è¿›è¡Œç®¡ç†ï¼›Pipy å®ä¾‹å®æ—¶ä» Pipy Repo åŒæ­¥ç­–ç•¥ï¼Œå¹¶è¿›è¡ŒåŠ¨æ€åŠ è½½ã€‚
åŒæ—¶ Pipy Repo å¯¹å¤–æä¾› REST API æ¥ç®¡ç†ç­–ç•¥ï¼Œå¯¹ç­–ç•¥çš„ä¿®æ”¹æ›´å®¹æ˜“ã€‚ä¹Ÿæ–¹ä¾¿ä¸ä¼ä¸šç°æœ‰ç®¡ç†åå°è¿›è¡Œå¯¹æ¥ã€‚
ä¸‹é¢å°±å¼€å§‹éƒ¨ç½²éªŒè¯ï¼Œè¿™é‡Œæ‰€ä½¿ç”¨çš„æ‰€æœ‰ä»£ç éƒ½å·²æäº¤åˆ°GitHub ä»“åº“ï¼šhttps://github.com/flomesh-io/demo-policy-as-codeã€‚
è¿è¡Œ git clone https://github.</description></item><item><title>Kubernetes Deployment çš„æ•…éšœæ’æŸ¥å¯è§†åŒ–æŒ‡å—ï¼ˆ2021 ä¸­æ–‡ç‰ˆï¼‰</title><link>https://atbug.com/articles/troubleshooting-kubernetes-deployment-zh-v2/</link><pubDate>Sat, 20 Nov 2021 18:29:19 +0800</pubDate><guid>https://atbug.com/articles/troubleshooting-kubernetes-deployment-zh-v2/</guid><description>å°†åº”ç”¨éƒ¨ç½²åˆ° Kubernetes æ—¶é€šå¸¸ä¼šä½¿ç”¨ Deploymentã€Serviceã€Ingressï¼Œæ•´ä¸ªåº”ç”¨ä»éƒ¨ç½²åˆ°æ­£å¸¸è¿è¡Œï¼Œç»å†çš„æµç¨‹å¾ˆé•¿ã€‚ä» kubectl apply YAML æ–‡ä»¶ï¼Œç»è¿‡ apiserverã€controller managerã€schedulerã€kubeletã€ä»¥åŠ CRIã€CNI ç­‰ä¼—å¤šç»„ä»¶çš„ååŒå·¥ä½œã€‚
æ¼«é•¿çš„â€œè¡Œç¨‹â€ï¼ŒPod ä¹Ÿç»å†å„ç§æ­£å¸¸å’Œä¸æ­£å¸¸çš„çŠ¶æ€å˜åŒ–ï¼Œå³ä½¿æ­£å¸¸è¿è¡Œä¹Ÿä¼šå‡ºç°æœåŠ¡æ— æ³•è®¿é—®çš„é—®é¢˜ã€‚å¯¹äºåˆšå¼€å§‹åœ¨ Kubernetes å¹³å°å¼€å±•å·¥ä½œçš„åŒå­¦æ¥è¯´ï¼Œæ•…éšœçš„æ’æŸ¥ç¡®å®æ£˜æ‰‹ã€‚ä¹‹å‰å·¥ä½œçš„æ—¶å€™ï¼Œç»å¸¸è¦ååŠ©æ’æŸ¥å„ç§é—®é¢˜ã€‚å»å¹´åœ¨ Learnk8s ä¸Šçœ‹åˆ°äº†å…³äº Deployment æ•…éšœæ’æŸ¥çš„è§†å›¾ï¼Œæˆ‘è¿˜å‚è€ƒåšäº†å½“æ—¶æ•´ä¸ªå¹³å°çš„æ•…éšœæ’æŸ¥è§†å›¾ï¼ŒåŒ…æ‹¬äº†ä»é¡¹ç›®æºç ã€CICD æµæ°´çº¿ã€éƒ¨ç½²æ•´ä¸ªæµç¨‹çš„æ•…éšœæ’æŸ¥å‚è€ƒã€‚
ç°åœ¨ Learnk8s çš„ Deployment æ’æŸ¥æŒ‡å—æ›´æ–°äº†ï¼Œä¹Ÿæœ‰äº†ä¸­æ–‡ç‰ˆæœ¬ã€‚
å¹´ä¸­ç¿»è¯‘ Learnk8s çš„æ–‡ç« ã€ŠKubernetes çš„è‡ªåŠ¨ä¼¸ç¼©ä½ ç”¨å¯¹äº†å—ï¼Ÿã€‹ æ—¶ï¼Œä¸ Daniele Polencic æ²Ÿé€šæ—¶è¢«é—®åŠæ˜¯å¦èƒ½ç¿»è¯‘æ•…éšœæ’æŸ¥çš„å¯è§†åŒ–æŒ‡å—ã€‚
å¹´ä¸­çš„æ—¶å€™å°±ç¿»è¯‘å®Œäº†ï¼Œä»Šå¤©ç”µæŠ¥ä¸Šè¢«å‘ŠçŸ¥æ–‡ç«  A visual guide on troubleshooting Kubernetes deploymentså·²æ›´æ–°ï¼Œæ’æŸ¥è§†å›¾è¾ƒä¸Šä¸€ç‰ˆæœ‰äº†éƒ¨åˆ†çš„è°ƒæ•´ã€‚</description></item><item><title>Kubernetes ä¸Šè°ƒè¯• distroless å®¹å™¨</title><link>https://atbug.com/articles/debug-distroless-container-on-kubernetes/</link><pubDate>Wed, 03 Nov 2021 07:40:40 +0800</pubDate><guid>https://atbug.com/articles/debug-distroless-container-on-kubernetes/</guid><description>TL;DR æœ¬æ–‡å†…å®¹ï¼š
ä»‹ç» distroless é•œåƒã€ä½œç”¨ä»¥åŠç®€å•çš„ä½¿ç”¨ å¦‚ä½•é’ˆå¯¹ distroless å®¹å™¨çš„è¿›è¡Œè°ƒè¯• ä¸´æ—¶å®¹å™¨(v.1.18+)çš„ä½¿ç”¨ Distroless é•œåƒ Distroless å®¹å™¨ï¼Œé¡¾åæ€ä¹‰ä½¿ç”¨ Distroless é•œåƒä½œä¸ºåŸºç¡€é•œåƒè¿è¡Œçš„å®¹å™¨ã€‚
&amp;ldquo;Distroless&amp;rdquo; é•œåƒåªåŒ…å«äº†ä½ çš„åº”ç”¨ç¨‹åºä»¥åŠå…¶è¿è¡Œæ—¶æ‰€éœ€è¦çš„ä¾èµ–ã€‚ä¸åŒ…å«ä½ èƒ½åœ¨æ ‡å‡† Linxu å‘è¡Œç‰ˆé‡Œçš„å¯ä»¥æ‰¾åˆ°çš„åŒ…ç®¡ç†å™¨ã€shells æˆ–è€…å…¶ä»–ç¨‹åºã€‚
GoogleContainerTools/distroless é’ˆå¯¹ä¸åŒè¯­è¨€æä¾›äº† distroless é•œåƒï¼š
gcr.io/distroless/static-debian11 gcr.io/distroless/base-debian11 gcr.io/distroless/java-debian11 gcr.io/distroless/cc-debian11 gcr.io/distroless/nodejs-debian11 gcr.io/distroless/python3-debian11 Distroless é•œåƒæœ‰ä»€ä¹ˆç”¨ï¼Ÿ é‚£äº›å¯èƒ½æ˜¯æ„å»ºé•œåƒæ—¶éœ€è¦çš„ï¼Œä½†å¤§éƒ¨åˆ†å¹¶ä¸æ˜¯è¿è¡Œæ—¶éœ€è¦çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šç¯‡æ–‡ç« ä»‹ç» Buildpacks æ—¶è¯´çš„ä¸€ä¸ª builder çš„ stack é•œåƒåŒ…å«æ„å»ºæ—¶åŸºç¡€é•œåƒå’Œè¿è¡Œæ—¶åŸºç¡€é•œåƒï¼Œè¿™æ ·å¯ä»¥åšåˆ°é•œåƒçš„æœ€å°åŒ–ã€‚</description></item><item><title>è‡ªåŠ¨æ›¿æ¢ Kubernetes é•œåƒ</title><link>https://atbug.com/articles/kubernetes-images-swapper/</link><pubDate>Wed, 06 Oct 2021 08:01:41 +0800</pubDate><guid>https://atbug.com/articles/kubernetes-images-swapper/</guid><description>å‰å‡ å¤©æœ‰æœ‹å‹åœ¨é—®å¦‚ä½•åœ¨æŸäº‘ä¸Šæ‹‰å– Tekton çš„é•œåƒï¼Œè¿™ç§æƒ…å†µå…¶å®æ¯”è¾ƒæ™®éä¸åªæ˜¯æŸäº‘ã€‚å·¥ä½œä¸­ç»å¸¸è¦ç”¨åˆ°è¿‡æŸäº›é è¿æ°”æ‰èƒ½æ‹‰å–åˆ°çš„é•œåƒï¼Œè¿™å¯¹å·¥ä½œæ¥è¯´çœŸæ˜¯æåº¦çš„ä¸å‹å¥½ã€‚
å› æ­¤ä¹ŸèŒç”Ÿäº†ä¸ªæƒ³æ³•ï¼Œç»´æŠ¤ä¸€ä¸ªåç½‘ç»œå‹å¥½çš„ä»“åº“é•œåƒï¼Œåœ¨ Pod åˆ›å»ºæ—¶å°†é•œåƒä»“åº“åˆ‡æ¢åˆ°è‡ªç»´æŠ¤çš„ä»“åº“ï¼Œä»è‡ªç»´æŠ¤çš„ä»“åº“æ‹‰å–é•œåƒã€‚
å‰å‡ å¤©ä½“éªŒäº†æç‹Gitlab çš„å®¹å™¨é•œåƒåº“ï¼Œä¾¿æ˜¯ä¸ºè¿™ä¸ªæƒ³æ³•åšçš„å‡†å¤‡ã€‚å½“ç„¶å…¶ä»–çš„äº‘å‚å•†ä¹Ÿæœ‰æä¾›é’ˆå¯¹ä¸ªäººç‰ˆçš„å…è´¹é•œåƒä»“åº“å’Œä¼ä¸šç‰ˆä»“åº“ã€‚
æ­£å¥½ Pipy ä½œä¸ºç­–ç•¥å¼•æ“ï¼Œéå¸¸é€‚åˆå®ç°è¿™ç§ç­–ç•¥çš„æ‰§è¡Œã€‚
å®ç°æ€è·¯ Admission Webhook Kubernetes åŠ¨æ€å‡†å¤‡æ§åˆ¶ çš„ MutatingWebhookConfiguration å¯ä»¥ hook Pod çš„åˆ›å»ºæˆ–è€…æ›´æ–°ï¼Œç„¶åè°ƒç”¨ç›®æ ‡æœåŠ¡å¯¹ Pod èµ„æºå¯¹è±¡è¿›è¡Œ patch æ“ä½œã€‚
ç­–ç•¥å¼•æ“ Pipy ä½œä¸ºåº”ç”¨çš„æ ¸å¿ƒï¼Œä¹Ÿå°±æ˜¯ MutatingWebhookConfiguration çš„ç›®æ ‡æœåŠ¡ï¼Œä»¥ç­–ç•¥å¼•æ“çš„è§’è‰²å®Œæˆç­–ç•¥çš„æ‰§è¡Œã€‚
Pipy æ”¯æŒä»æ–‡ä»¶æˆ–è€… HTTP åœ°å€åŠ è½½è„šæœ¬ï¼Œè¿™é‡Œä¸ºäº†ä¾¿äºç­–ç•¥çš„æ›´æ–°ï¼Œä½¿ç”¨äº†åè€…ã€‚
å¯¹äºä» HTTP åœ°å€åŠ è½½è„šæœ¬ï¼ŒHTTP åœ°å€è¿”å›å†…å®¹çš„ç¬¬ä¸€è¡Œä¼šä½œä¸º Pipy çš„ä¸»è„šæœ¬ï¼ŒPipy å¯åŠ¨æ—¶ä¼šåŠ è½½ä¸»è„šæœ¬ï¼Œå…¶ä»–çš„æ–‡ä»¶ä¹Ÿä¼šè¢«ç¼“å­˜åˆ°å†…å­˜ä¸­ã€‚</description></item><item><title>ARM64 å¹³å°åŸºäº openEuler + iSula ç¯å¢ƒéƒ¨ç½² Kubernetes</title><link>https://atbug.com/articles/setup-kubernetes-running-with-isulad-on-openeuler/</link><pubDate>Thu, 02 Sep 2021 20:41:06 +0800</pubDate><guid>https://atbug.com/articles/setup-kubernetes-running-with-isulad-on-openeuler/</guid><description>ä¸ºä»€ä¹ˆè¦åœ¨ arm64 å¹³å°ä¸Šéƒ¨ç½² Kubernetesï¼Œè€Œä¸”è¿˜æ˜¯é²²é¹ 920 çš„æ¶æ„ã€‚è¯´æ¥è¯é•¿ ã€‚ã€‚ã€‚ æ­¤å¤„çœç•¥5000 å­—ã€‚
ä»‹ç»ä¸‹ç³»ç»Ÿä¿¡æ¯ï¼›
æ¶æ„ï¼šé²²é¹ 920(Kunpeng920) OSï¼šopenEuler 20.03 (LTS-SP1) CPUï¼š4c å†…å­˜ï¼š16G ç¡¬ç›˜ï¼šè‹¥å¹² æ•´ä¸ªè¿‡ç¨‹è™½ç„¶å‚è€ƒäº†é²²é¹è®ºå›çš„å¸–å­ï¼Œä¸è¿‡è¿˜æ˜¯é¢‡è´¹å‘¨æŠ˜ã€‚
TL;DR æ•´ä¸ªè¿‡ç¨‹ä¸­è¦æ³¨æ„ arm64 å¹³å°ä¸Šå®‰è£… Kubernetes åŠç½‘ç»œç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨ arm64 ç‰ˆæœ¬çš„é•œåƒã€‚
ç¯å¢ƒé…ç½® 1.å…³é—­ selinux #ä¸´æ—¶å…³é—­ setenforce 0 #æ°¸ä¹…å…³é—­ SELINUX=disabled vim /etc/sysconfig/selinux 2. å…³é—­swapåˆ†åŒº #ä¸´æ—¶å…³é—­ swapoff -a #æ°¸ä¹…å…³é—­ æ³¨é‡Š swap è¡Œ vim /etc/fstab 3.</description></item><item><title>Kubernetes å¿…å¤‡å·¥å…·ï¼š2021</title><link>https://atbug.com/articles/translation-kuberletes-essential-tools-2021/</link><pubDate>Thu, 15 Jul 2021 08:10:22 +0800</pubDate><guid>https://atbug.com/articles/translation-kuberletes-essential-tools-2021/</guid><description>æœ‰åˆ«äºå‰äº›å¤©çš„æ–‡ç«  - å¸¸ç”¨çš„å‡ æ¬¾å·¥å…·è®© Kubernetes é›†ç¾¤ä¸Šçš„å·¥ä½œæ›´å®¹æ˜“ åé‡äºå·¥å…·ç±»æ¥æå‡å·¥ä½œæ•ˆç‡ï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« æ›´åŠ é€‚åˆç”¨æ¥åšé€‰å‹æ—¶çš„å‚è€ƒã€‚
æ–‡æ¡£ç¿»è¯‘è‡ª Kubernetes Essential Tools: 2021ï¼Œç¯‡å¹…è¾ƒé•¿ï¼Œåšäº†éƒ¨åˆ†å¢åˆ ã€‚
ä»‹ç» åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å°è¯•æ€»ç»“æˆ‘æœ€å–œæ¬¢çš„ Kubernetes å·¥å…·ï¼Œå¹¶ç‰¹åˆ«å¼ºè°ƒæœ€æ–°çš„å’Œé²œä¸ºäººçŸ¥ä½†æˆ‘è®¤ä¸ºä¼šéå¸¸æµè¡Œçš„å·¥å…·ã€‚
è¿™åªæ˜¯æˆ‘æ ¹æ®æˆ‘çš„ç»éªŒå¾—å‡ºçš„ä¸ªäººæ¸…å•ï¼Œä½†ä¸ºäº†é¿å…åè§ï¼Œæˆ‘è¿˜å°†å°è¯•æåŠæ¯ç§å·¥å…·çš„æ›¿ä»£æ–¹æ¡ˆï¼Œä»¥ä¾¿ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œæ¯”è¾ƒå’Œå†³å®šã€‚æˆ‘å°†å°½å¯èƒ½ç¼©çŸ­è¿™ç¯‡æ–‡ç« å¹¶æä¾›é“¾æ¥ï¼Œä»¥ä¾¿ä½ å¯ä»¥è‡ªè¡Œæ¢ç´¢æ›´å¤šå†…å®¹ã€‚æˆ‘çš„ç›®æ ‡æ˜¯å›ç­”è¿™ä¸ªé—®é¢˜ï¼šâ€œæˆ‘å¦‚ä½•åœ¨ Kubernetes ä¸­åš Xï¼Ÿâ€ é€šè¿‡æè¿°ä¸åŒè½¯ä»¶å¼€å‘ä»»åŠ¡çš„å·¥å…·ã€‚
K3D K3D æ˜¯æˆ‘æœ€å–œæ¬¢çš„åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿è¡Œ Kubernetes (K8s) é›†ç¾¤çš„æ–¹å¼ã€‚å®ƒéå¸¸è½»å·§ä¸”é€Ÿåº¦éå¸¸å¿«ã€‚å®ƒæ˜¯ä½¿ç”¨ Docker å›´ç»• K3S çš„åŒ…è£…å™¨ã€‚æ‰€ä»¥ï¼Œä½ åªéœ€è¦ Docker æ¥è¿è¡Œå®ƒå¹¶ä¸”èµ„æºä½¿ç”¨ç‡éå¸¸ä½ã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯å®ƒä¸å®Œå…¨ç¬¦åˆ K8s æ ‡å‡†ï¼Œä½†è¿™ä¸åº”è¯¥æ˜¯æœ¬åœ°å¼€å‘çš„é—®é¢˜ã€‚å¯¹äºæµ‹è¯•ç¯å¢ƒï¼Œä½ å¯ä»¥ä½¿ç”¨å…¶ä»–è§£å†³æ–¹æ¡ˆã€‚K3D æ¯” Kind å¿«ï¼Œä½† Kind å®Œå…¨å…¼å®¹ã€‚</description></item><item><title>Rego ä¸å¥½ç”¨ï¼Ÿç”¨ Pipy å®ç° OPA</title><link>https://atbug.com/articles/pipy-implement-kubernetes-admission-control/</link><pubDate>Tue, 13 Jul 2021 08:44:56 +0800</pubDate><guid>https://atbug.com/articles/pipy-implement-kubernetes-admission-control/</guid><description>è¿˜ä¸çŸ¥é“ Pipy æ˜¯ä»€ä¹ˆçš„åŒå­¦å¯ä»¥çœ‹ä¸‹ GitHub ã€‚
Pipy æ˜¯ä¸€ä¸ªè½»é‡çº§ã€é«˜æ€§èƒ½ã€é«˜ç¨³å®šã€å¯ç¼–ç¨‹çš„ç½‘ç»œä»£ç†ã€‚Pipy æ ¸å¿ƒæ¡†æ¶ä½¿ç”¨ C++ å¼€å‘ï¼Œç½‘ç»œ IO é‡‡ç”¨ ASIO åº“ã€‚ Pipy çš„å¯æ‰§è¡Œæ–‡ä»¶ä»…æœ‰ 5M å·¦å³ï¼Œè¿è¡ŒæœŸçš„å†…å­˜å ç”¨ 10M å·¦å³ï¼Œå› æ­¤ Pipy éå¸¸é€‚åˆåš Sidecar proxyã€‚
Pipy å†…ç½®äº†è‡ªç ”çš„ pjs ä½œä¸ºè„šæœ¬æ‰©å±•ï¼Œä½¿å¾—Pipy å¯ä»¥ç”¨ JS è„šæœ¬æ ¹æ®ç‰¹å®šéœ€æ±‚å¿«é€Ÿå®šåˆ¶é€»è¾‘ä¸åŠŸèƒ½ã€‚
Pipy é‡‡ç”¨äº†æ¨¡å—åŒ–ã€é“¾å¼çš„å¤„ç†æ¶æ„ï¼Œç”¨é¡ºåºæ‰§è¡Œçš„æ¨¡å—æ¥å¯¹ç½‘ç»œæ•°æ®å—è¿›è¡Œå¤„ç†ã€‚è¿™ç§ç®€å•çš„æ¶æ„ä½¿å¾— Pipy åº•å±‚ç®€å•å¯é ï¼ŒåŒæ—¶å…·å¤‡äº†åŠ¨æ€ç¼–æ’æµé‡çš„èƒ½åŠ›ï¼Œå…¼é¡¾äº†ç®€å•å’Œçµæ´»ã€‚é€šè¿‡ä½¿ç”¨ REUSE_PORT çš„æœºåˆ¶ï¼ˆä¸»æµ Linux å’Œ BSD ç‰ˆæœ¬éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼‰ï¼ŒPipy å¯ä»¥ä»¥å¤šè¿›ç¨‹æ¨¡å¼è¿è¡Œï¼Œä½¿å¾— Pipy ä¸ä»…é€‚ç”¨äº Sidecar æ¨¡å¼ï¼Œä¹Ÿé€‚ç”¨äºå¤§è§„æ¨¡çš„æµé‡å¤„ç†åœºæ™¯ã€‚ åœ¨å®è·µä¸­ï¼ŒPipy ç‹¬ç«‹éƒ¨ç½²çš„æ—¶å€™ç”¨ä½œâ€œè½¯è´Ÿè½½â€ï¼Œå¯ä»¥åœ¨ä½å»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼Œå®ç°åª²ç¾ç¡¬ä»¶çš„è´Ÿè½½å‡è¡¡ååèƒ½åŠ›ï¼ŒåŒæ—¶å…·æœ‰çµæ´»çš„æ‰©å±•æ€§ã€‚</description></item><item><title>Kubernetes çš„é­”åŠ›åœ¨äºä¼ä¸šæ ‡å‡†åŒ–ï¼Œè€Œä¸æ˜¯åº”ç”¨ç¨‹åºçš„å¯ç§»æ¤æ€§</title><link>https://atbug.com/articles/translation-kubernetes-magic-is-in-enterprise-standardization-not-app-portability/</link><pubDate>Sun, 11 Jul 2021 08:05:42 +0800</pubDate><guid>https://atbug.com/articles/translation-kubernetes-magic-is-in-enterprise-standardization-not-app-portability/</guid><description>ç¬”è€…ï¼šKubernetes æŠ½è±¡äº†èµ„æºå’Œå·¥ä½œè´Ÿè½½çš„æ“ä½œæ¨¡å¼ï¼Œç»Ÿä¸€äº†å·¥å…·é›†ï¼Œå®ç°äººæœºæ¥å£çš„æ ‡å‡†åŒ–ã€‚æ­£å¦‚ç±» Docker å·¥å…·æä¾›äº†åº”ç”¨è¿è¡Œæ—¶çš„æ“ä½œæ¨¡å¼ï¼›Spring Framework æä¾›äº† Java åº”ç”¨çš„å¼€å‘æ¨¡å¼ã€‚
Kubernetes æ˜¯å…³äºè·¨äº‘çš„æŠ€èƒ½ã€å·¥å…·å’Œå®è·µçš„å¯ç§»æ¤æ€§ã€‚ä¸æ˜¯å·¥ä½œè´Ÿè½½çš„å¯ç§»æ¤æ€§ã€‚ &amp;ndash; Bilgin Lbryam @bibryam
æœ¬æ–‡ç¿»è¯‘è‡ª Kubernetes magic is in enterprise standardization, not app portability
Kubernetes ä¸ä¼šç¥å¥‡åœ°ä½¿ä½ çš„åº”ç”¨ç¨‹åºå…·æœ‰å¯ç§»æ¤æ€§ï¼Œä½†å®ƒå¯èƒ½ä¼šç»™ä½ å¸¦æ¥æ›´å¥½çš„ä¸œè¥¿ã€‚
äº‘ä¸ºä¼ä¸šæä¾›äº†çœ‹ä¼¼æ— é™çš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œæ ¹æ® Canonical-sponsored çš„ä¸€é¡¹è°ƒæŸ¥ï¼Œè¿™å¹¶ä¸æ˜¯å¤§å¤šæ•°ä¼ä¸šé‡‡ç”¨ Kubernetes ç­‰äº‘å‹å¥½æŠ€æœ¯çš„åŸå› ã€‚ç›¸åï¼ŒKubernetes çš„ä¸»è¦ç›®æ ‡æ˜¯æ ‡å‡†åŒ–â€”â€”å¤–è§‚å’Œæ“ä½œä¸å…¶ä»–äººä¸€æ ·ã€‚
å¯ç§»æ¤æ€§ä¸æ˜¯ç›®æ ‡ æˆ‘ä¹‹å‰å·²ç»è®¨è®ºè¿‡è¿™ä¸ªé—®é¢˜ï¼Œå‚è€ƒäº† Gartner å…³äº Kubernetes å’Œå¯ç§»æ¤æ€§çš„æŒ‡å—ã€‚è®¸å¤šäººè®¤ä¸º Kubernetesï¼ˆå’Œå®¹å™¨ï¼‰å¯ä»¥è®©ä»–ä»¬åœ¨äº‘ä¹‹é—´è½»æ¾ç§»æ¤ï¼Œä½†äº‹å®è¯æ˜å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚æ­£å¦‚ Gartner åˆ†æå¸ˆ Marco Meinardi æ‰€å†™ï¼Œå½“è¢«é—®åŠå…¬å¸æ˜¯å¦åº”è¯¥é‡‡ç”¨â€œKubernetes ä½¿ä»–ä»¬çš„åº”ç”¨ç¨‹åºå¯ç§»æ¤&amp;hellip;&amp;hellip;ç­”æ¡ˆæ˜¯ï¼šä¸ã€‚â€ å†è¯´ä¸€æ¬¡ï¼Ÿ</description></item><item><title>Kubernetes CKA è¯ä¹¦å¤‡è€ƒç¬”è®°</title><link>https://atbug.com/articles/notes-for-cka-preparation/</link><pubDate>Fri, 02 Jul 2021 08:02:15 +0800</pubDate><guid>https://atbug.com/articles/notes-for-cka-preparation/</guid><description>Kubernetes ä½¿ç”¨æœ‰å¥½å‡ å¹´äº†ï¼Œä½†åœ¨ä»Šå¹´ 5 æœˆæ‰å®Œæˆ CKA çš„è€ƒè¯•ã€‚è™½è¯´ç”¨äº†å‡ å¹´ï¼Œè¿˜æ˜¯æå‰åˆ·äº†éƒ¨åˆ†é¢˜ç†Ÿæ‚‰ä¸‹ã€‚
ç»å¤§éƒ¨åˆ†é¢˜éƒ½æ˜¯æœ‰åœ¨ minikube çš„ç¯å¢ƒä¸Šæ“ä½œè¿‡ï¼Œåªæœ‰éƒ¨åˆ†æ¯”å¦‚å‡çº§é›†ç¾¤å—é™äºç¯å¢ƒé—®é¢˜æ²¡æœ‰å®åœ°æ“ä½œã€‚
å†™åœ¨æœ€å‰ ä¿å­˜å¸¸ç”¨æ–‡æ¡£è¿›ä¹¦ç­¾ï¼Œå¦‚æœæœ‰ Alfred å¯ç”¨æµè§ˆå™¨ä¹¦ç­¾ workflowã€‚æ•ˆæœè§ä¸‹å›¾ kubectl è‡ªåŠ¨è¡¥å…¨ echo &amp;quot;source &amp;lt;(kubectl completion bash)&amp;quot; &amp;gt;&amp;gt; ~/.bashrc; source ~/.bashrc æ¯é“é¢˜å¼€å§‹å‰è¦åˆ‡æ¢ context å’Œ namespaceï¼Œç›´æ¥å¤åˆ¶é¢˜ç›®é‡Œçš„å‘½ä»¤å³å¯ å¿…è¦çš„ alias å–„ç”¨ --dry-run=client -o yaml é¿å…æ‰‹åŠ¨æ•²å¤ªå¤š å–„ç”¨ kubectl explain [resource[.</description></item><item><title>å¸¸ç”¨çš„å‡ æ¬¾å·¥å…·è®© Kubernetes é›†ç¾¤ä¸Šçš„å·¥ä½œæ›´å®¹æ˜“</title><link>https://atbug.com/articles/tools-accelerate-work-on-kubernetes-cluster/</link><pubDate>Sat, 26 Jun 2021 12:16:28 +0800</pubDate><guid>https://atbug.com/articles/tools-accelerate-work-on-kubernetes-cluster/</guid><description>ä¹‹å‰å†™è¿‡ä¸€ç¯‡ ä»‹ç»äº†å·¥å…·åŠ é€Ÿäº‘åŸç”Ÿ Java å¼€å‘ã€‚
å…¶å®æ—¥å¸¸å·¥ä½œä¸­åœ¨é›†ç¾¤ä¸Šçš„æ“ä½œä¹Ÿéå¸¸å¤šï¼Œä»Šå¤©å°±æ¥ä»‹ç»æˆ‘æ‰€ä½¿ç”¨çš„å·¥å…·ã€‚
kubectl-alias ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„å·¥å…·ï¼Œæˆ‘è‡ªå·±ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹ï¼ŒåŠ å…¥äº† StatefulSet çš„æ”¯æŒã€‚
è¿™ä¸ªæ˜¯æˆ‘çš„ https://github.com/addozhang/kubectl-aliasesï¼ŒåŸºäº https://github.com/ahmetb/kubectl-aliasesã€‚
æ¯”å¦‚è¾“å‡ºæŸä¸ª pod çš„ jsonï¼Œkgpoojson xxx ç­‰åŒäº kubectl get pod xxx -o jsonã€‚
ç»“åˆ jq ä½¿ç”¨æ•ˆæœæ›´å¥½ ğŸ˜‚ã€‚
è¯­æ³•è§£è¯» k=kubectl sys=--namespace kube-system commands: g=get d=describe rm=delete a:apply -f ak:apply -k k:kustomize ex:Â exec -i -t lo:Â logs -f resources: po=pod,Â dep=deployment,Â ing=ingress,Â svc=service,Â cm=configmap,Â sec=secret,ns=namespace,Â no=node flags: output format:Â oyaml,Â ojson,Â owide all:Â --allÂ orÂ --all-namespacesÂ depending on the command sl:Â --show-labels w=-w/--watch value flags (should be at the end): n=-n/--namespace f=-f/--filename l=-l/--selector kubectx + kubens å®‰è£…çœ‹è¿™é‡Œ</description></item><item><title>Jenkins å¦‚ä½•ä¸ Kubernetes é›†ç¾¤çš„ Tekton Pipeline äº¤äº’ï¼Ÿ</title><link>https://atbug.com/articles/jenkins-interact-with-tekton-pipelines-via-plugin/</link><pubDate>Wed, 23 Jun 2021 07:58:45 +0800</pubDate><guid>https://atbug.com/articles/jenkins-interact-with-tekton-pipelines-via-plugin/</guid><description>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† Jenkins å¦‚ä½•é€šè¿‡ tekton-client-plugin å®ç°ä¸ Kubernetes ä¸Šçš„ Tekton Pipeline äº¤äº’ï¼ŒåŒ…æ‹¬ Kubernetes ä¸Šå®‰è£… Jenkinsã€Tekton Pipelines ç­‰ã€‚
å…³äºå¦‚ä½•ä½¿ç”¨ Tekton Pipeline å®ç° CICD å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç«  äº‘åŸç”Ÿ CICD: Tekton Pipeline å®æˆ˜
æœ¬æ–‡ç”¨äºæ„å»ºçš„é¡¹ç›®ä»¥åŠæ‰€æœ‰ manifest yaml éƒ½åœ¨å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ã€‚
TL;DR æƒ¯ä¾‹ï¼Œå…ˆä¸Šæ€»ç»“ã€‚tekton-client-plugin è™½ç„¶è¿˜æ˜¯å¤„äºåˆæœŸé˜¶æ®µï¼Œä½†æ˜¯ å…¶ä»·å€¼éå¸¸æ˜æ˜¾ï¼Œå°¤å…¶æ˜¯å¯¹å…ˆç”¨ä½¿ç”¨ Jenkins ä½œä¸º CICD å®ç°çš„ç”¨æˆ·æ¥è¯´ã€‚ä» Jenkins è¿ç§»åˆ°äº‘åŸç”Ÿçš„ Tekton æ—¶ï¼Œå¯ä»¥çœæ‰ç”¨æˆ·ç•Œé¢çš„å¼€å‘æˆæœ¬ï¼Œè€Œä¸”å°½å¯èƒ½å°‘çš„æ”¹å˜ç”¨æˆ·ä¹ æƒ¯ ï¼Œä¾é ç‰ˆæœ¬ç®¡ç†å¯ä»¥æ§åˆ¶è¿ç§»çš„èŠ‚å¥ã€‚</description></item><item><title>äº‘åŸç”Ÿ CICD: Tekton Pipeline å®æˆ˜</title><link>https://atbug.com/articles/tekton-pipeline-practice/</link><pubDate>Tue, 22 Jun 2021 07:19:33 +0800</pubDate><guid>https://atbug.com/articles/tekton-pipeline-practice/</guid><description>æ›´æ–°å†å²ï¼š
v1ï¼š2020.1.21 åŸºäº Tekton Pipline v0.9.0 v2ï¼ˆå½“å‰ï¼‰ï¼š2021.6.22 åŸºäº Tekton Pipeline v0.25.0 Tekton æ˜¯ Google å¼€æºçš„ Kubernetes åŸç”ŸCI/CD ç³»ç»Ÿ, åŠŸèƒ½å¼ºå¤§æ‰©å±•æ€§å¼º. å‰èº«æ˜¯ Knavite é‡Œçš„ build-pipeline é¡¹ç›®, åæœŸå­µåŒ–æˆç‹¬ç«‹çš„é¡¹ç›®. å¹¶æˆä¸º CDF ä¸‹çš„å››ä¸ªé¡¹ç›®ä¹‹ä¸€, å…¶ä»–ä¸‰ä¸ªåˆ†åˆ«æ˜¯ Jenkins, Jenkins X, Spinnaker.
ä¸ºä»€ä¹ˆè¯´ Tekton æ˜¯ Kubernetes åŸç”Ÿçš„, ä»¥å†…å…¶åŸºäº Kubernetes çš„ CRD å®šä¹‰äº† Pipeline æµæ°´çº¿.</description></item><item><title>æºç è§£æï¼šä¸€æ–‡è¯»æ‡‚ Kubelet</title><link>https://atbug.com/articles/kubelet-source-code-analysis/</link><pubDate>Tue, 15 Jun 2021 08:25:25 +0800</pubDate><guid>https://atbug.com/articles/kubelet-source-code-analysis/</guid><description>æœ¬æ–‡ä¸»è¦ä»‹ç» kubelet åŠŸèƒ½ã€æ ¸å¿ƒç»„ä»¶ï¼Œä»¥åŠå¯åŠ¨æµç¨‹çš„æºç åˆ†æï¼Œæ€»ç»“äº† kubelet çš„å·¥ä½œåŸç†ã€‚
kubelet ç®€ä»‹ ä»å®˜æ–¹çš„æ¶æ„å›¾ä¸­å¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ° kubelet
æ‰§è¡Œ kubelet -h çœ‹åˆ° kubelet çš„åŠŸèƒ½ä»‹ç»ï¼š
kubelet æ˜¯æ¯ä¸ª Node èŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œçš„ä¸»è¦â€œèŠ‚ç‚¹ä»£ç†â€ã€‚ä½¿ç”¨å¦‚ä¸‹çš„ä¸€ä¸ªå‘ apiserver æ³¨å†Œ Node èŠ‚ç‚¹ï¼šä¸»æœºçš„ hostnameï¼›è¦†ç›– host çš„å‚æ•°ï¼›æˆ–è€…äº‘æä¾›å•†æŒ‡å®šçš„é€»è¾‘ã€‚ kubelet åŸºäº PodSpec å·¥ä½œã€‚PodSpec æ˜¯ç”¨ YAML æˆ–è€… JSON å¯¹è±¡æ¥æè¿° Podã€‚Kubelet æ¥å—é€šè¿‡å„ç§æœºåˆ¶ï¼ˆä¸»è¦æ˜¯ apiserverï¼‰æä¾›çš„ä¸€ç»„ PodSpecï¼Œå¹¶ç¡®ä¿é‡Œé¢æè¿°çš„å®¹å™¨è‰¯å¥½è¿è¡Œã€‚ é™¤äº†ç”± apiserver æä¾› PodSpecï¼Œè¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æä¾›ï¼š</description></item><item><title>Kubernetes ä¸Šå¦‚ä½•æ§åˆ¶å®¹å™¨çš„å¯åŠ¨é¡ºåºï¼Ÿ</title><link>https://atbug.com/articles/k8s-1.18-container-start-sequence-control/</link><pubDate>Fri, 30 Apr 2021 07:43:54 +0800</pubDate><guid>https://atbug.com/articles/k8s-1.18-container-start-sequence-control/</guid><description>å»å¹´å†™è¿‡ä¸€ç¯‡åšå®¢ï¼šæ§åˆ¶ Pod å†…å®¹å™¨çš„å¯åŠ¨é¡ºåºï¼Œåˆ†æäº† TektonCD çš„å®¹å™¨å¯åŠ¨æ§åˆ¶çš„åŸç†ã€‚
ä¸ºä»€ä¹ˆè¦åšå®¹å™¨å¯åŠ¨é¡ºåºæ§åˆ¶ï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“ Pod ä¸­é™¤äº† init-container ä¹‹å¤–ï¼Œæ˜¯å…è®¸æ·»åŠ å¤šä¸ªå®¹å™¨çš„ã€‚ç±»ä¼¼ TektonCD ä¸­ task å’Œ step çš„æ¦‚å¿µå°±åˆ†åˆ«ä¸ pod å’Œ container å¯¹åº”ï¼Œè€Œ step æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ã€‚æ­¤å¤–è¿˜æœ‰æœåŠ¡ç½‘æ ¼çš„åœºæ™¯ï¼Œsidecar å®¹å™¨éœ€è¦åœ¨æœåŠ¡å®¹å™¨å¯åŠ¨ä¹‹å‰å®Œæˆé…ç½®çš„åŠ è½½ï¼Œä¹Ÿéœ€è¦å¯¹å®¹å™¨çš„å¯åŠ¨é¡ºåºåŠ ä»¥æ§åˆ¶ã€‚å¦åˆ™ï¼ŒæœåŠ¡å®¹å™¨å…ˆå¯åŠ¨ï¼Œè€Œ sidecar è¿˜æ— æ³•æä¾›ç½‘ç»œä¸Šçš„æ”¯æŒã€‚
ç°å® æœŸæœ› åˆ°äº†è¿™é‡Œè‚¯å®šæœ‰åŒå­¦ä¼šé—®ï¼Œspec.containers[] æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„æ˜¯æœ‰é¡ºåºçš„ã€‚Kubernetes ä¹Ÿç¡®å®æ˜¯æŒ‰ç…§é¡ºåºæ¥åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨ï¼Œä½†æ˜¯ å®¹å™¨å¯åŠ¨æˆåŠŸï¼Œå¹¶ä¸è¡¨ç¤ºå®¹å™¨å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚
åœ¨ Kubernetes 1.18 éæ­£å¼ç‰ˆä¸­æ›¾åœ¨ Lifecycle å±‚é¢æä¾›äº†å¯¹ sidecar ç±»å‹å®¹å™¨çš„ æ”¯æŒï¼Œä½†æ˜¯æœ€ç»ˆè¯¥åŠŸèƒ½å¹¶æ²¡æœ‰è½åœ°ã€‚</description></item><item><title>æœåŠ¡ç½‘æ ¼å¹³ç¨³è½åœ°ï¼šIstio ä¸­ç²¾å‡†æ§åˆ¶ Sidecar çš„æ³¨å…¥</title><link>https://atbug.com/articles/how-to-control-istio-sidecar-injection/</link><pubDate>Wed, 21 Apr 2021 08:13:04 +0800</pubDate><guid>https://atbug.com/articles/how-to-control-istio-sidecar-injection/</guid><description>ä¸ºä»€ä¹ˆ è¯´èµ·æœåŠ¡ç½‘æ ¼ï¼Œè¿™å¹…å›¾å¤§å®¶è‚¯å®šä¸ä¼šé™Œç”Ÿã€‚è¿™å°±æ˜¯æœåŠ¡ç½‘æ ¼çš„ç½‘ç»œï¼Œä¹Ÿæ˜¯ç½‘æ ¼æ¶æ„çš„ç»ˆæå½¢æ€ã€‚
é‚£åœ¨è¿ç§»åˆ°ç½‘æ ¼æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
æˆ‘ä»¬çš„ç³»ç»Ÿåœ¨æ¼”è¿›çš„è¿‡ç¨‹ä¸­ï¼Œä¸å¯é¿å…çš„ä¼šé‡åˆ°å„ç§ 0 åˆ° 1 è¿‡ç¨‹ä¸­çš„ä¸­é—´æ€ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§ï¼Œå¯ä»¥æ¯”è¾ƒç›´è§‚çš„çœ‹å‡º Istio æˆ–è€…ç½‘æ ¼æ˜¯éƒ¨åˆ†è¦†ç›–çš„ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¹³æ»‘ã€å¯æ§çš„æ¨è¿›ï¼Œæ‰èƒ½åœ¨ä¿éšœç³»ç»Ÿå¯ç”¨æ€§çš„å‰æä¸‹è¿›è¡Œæ¶æ„çš„æ¼”è¿›ã€‚
æ€ä¹ˆåš Sidecar çš„æ³¨å…¥åˆ†ä¸¤ç§ï¼šæ‰‹åŠ¨å’Œè‡ªåŠ¨ã€‚
æ‰‹åŠ¨ æ‰‹åŠ¨å°±æ˜¯åˆ©ç”¨ Istio çš„ cli å·¥å…· istioctl kube-inject å¯¹èµ„æº yaml è¿›è¡Œä¿®æ”¹ï¼š
$ istioctl kube-inject -f samples/sleep/sleep.yaml | kubectl apply -f - serviceaccount/sleep created service/sleep created deployment.apps/sleep created æ‰‹åŠ¨çš„æ–¹å¼æ¯”è¾ƒé€‚åˆå¼€å‘é˜¶æ®µä½¿ç”¨ã€‚</description></item><item><title>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨ Kubernetes ä¸Šçš„è¿›åŒ–</title><link>https://atbug.com/articles/translation-distributed-systems-kubernetes/</link><pubDate>Mon, 29 Mar 2021 23:11:25 +0800</pubDate><guid>https://atbug.com/articles/translation-distributed-systems-kubernetes/</guid><description>æœ¬æ–‡è¯‘è‡ª The Evolution of Distributed Systems on Kubernetes
åœ¨ 3 æœˆä»½çš„ QCon ä¸Šï¼Œæˆ‘åšäº†ä¸€ä¸ªå…³äº Kubernetes çš„åˆ†å¸ƒå¼ç³»ç»Ÿè¿›åŒ–çš„æ¼”è®²ã€‚é¦–å…ˆï¼Œæˆ‘æƒ³å…ˆé—®ä¸€ä¸ªé—®é¢˜ï¼Œå¾®æœåŠ¡ä¹‹åæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½æœ‰å„è‡ªçš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿæœ‰æˆ‘çš„ç­”æ¡ˆã€‚ä½ ä¼šåœ¨æœ€åå‘ç°æˆ‘çš„æƒ³æ³•æ˜¯ä»€ä¹ˆã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘å»ºè®®å¤§å®¶çœ‹çœ‹åˆ†å¸ƒå¼ç³»ç»Ÿçš„éœ€æ±‚æ˜¯ä»€ä¹ˆï¼Ÿä»¥åŠè¿™äº›éœ€æ±‚åœ¨è¿‡å»æ˜¯å¦‚ä½•å‘å±•çš„ï¼Œä»å•ä½“åº”ç”¨å¼€å§‹åˆ° Kubernetesï¼Œå†åˆ°æœ€è¿‘çš„ Daprã€Istioã€Knative ç­‰é¡¹ç›®ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•æ”¹å˜æˆ‘ä»¬åšåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ–¹å¼ã€‚æˆ‘ä»¬å°†å°è¯•å¯¹æœªæ¥åšä¸€äº›é¢„æµ‹ã€‚
ç°ä»£åˆ†å¸ƒå¼åº”ç”¨ ä¸ºäº†ç»™è¿™ä¸ªè¯é¢˜æä¾›æ›´å¤šçš„èƒŒæ™¯ä¿¡æ¯ï¼Œæˆ‘è®¤ä¸ºçš„åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±æ•°ç™¾ä¸ªç»„ä»¶ç»„æˆçš„ç³»ç»Ÿã€‚è¿™äº›ç»„ä»¶å¯ä»¥æ˜¯æœ‰çŠ¶æ€çš„ã€æ— çŠ¶æ€çš„æˆ–è€…æ— æœåŠ¡å™¨çš„ã€‚æ­¤å¤–ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ç”¨ä¸åŒçš„è¯­è¨€åˆ›å»ºï¼Œè¿è¡Œåœ¨æ··åˆç¯å¢ƒä¸Šï¼Œå¹¶å¼€å‘å¼€æºæŠ€æœ¯ã€å¼€æ”¾æ ‡å‡†å’Œäº’æ“ä½œæ€§ã€‚æˆ‘ç›¸ä¿¡ä½ å¯ä»¥ä½¿ç”¨é—­æºè½¯ä»¶æ¥æ„å»ºè¿™æ ·çš„ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥åœ¨ AWS å’Œå…¶ä»–åœ°æ–¹æ„å»ºã€‚å…·ä½“åˆ°è¿™æ¬¡æ¼”è®²ï¼Œæˆ‘å°†å…³æ³¨ Kubernetes ç”Ÿæ€ç³»ç»Ÿï¼Œä»¥åŠä½ å¦‚ä½•åœ¨ Kubernetes å¹³å°ä¸Šæ„å»ºè¿™æ ·ä¸€ä¸ªç³»ç»Ÿã€‚
æˆ‘ä»¬ä»åˆ†å¸ƒå¼ç³»ç»Ÿçš„éœ€æ±‚è®²èµ·ã€‚æˆ‘è®¤ä¸ºæ˜¯æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåº”ç”¨æˆ–è€…æœåŠ¡ï¼Œå¹¶å†™ä¸€äº›ä¸šåŠ¡é€»è¾‘ã€‚é‚£ä»è¿è¡Œæ—¶çš„å¹³å°åˆ°æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä»€ä¹ˆå‘¢ï¼Ÿåœ¨åº•å±‚ï¼Œæœ€å¼€å§‹æ˜¯æˆ‘ä»¬è¦ä¸€äº›ç”Ÿå‘½å‘¨æœŸçš„èƒ½åŠ›ã€‚å½“ä½ ç”¨ä»»ä¸€è¯­è¨€å¼€å‘ä½ çš„åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰èƒ½åŠ›æŠŠè¿™ä¸ªåº”ç”¨å¯é åœ°æ‰“åŒ…å’Œéƒ¨ç½²ã€å›æ»šã€å¥åº·æ£€æŸ¥ã€‚å¹¶ä¸”èƒ½å¤ŸæŠŠåº”ç”¨éƒ¨ç½²åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œå¹¶å®ç°èµ„æºéš”ç¦»ã€æ‰©å±•ã€é…ç½®ç®¡ç†ï¼Œä»¥åŠæ‰€æœ‰è¿™äº›ã€‚è¿™äº›éƒ½æ˜¯ä½ åˆ›å»ºåˆ†å¸ƒå¼åº”ç”¨æ‰€éœ€è¦çš„ç¬¬ä¸€ç‚¹ã€‚
ç¬¬äºŒç‚¹æ˜¯å›´ç»•ç½‘ç»œã€‚æˆ‘ä»¬æœ‰äº†åº”ç”¨ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿå¯é åœ°è¿æ¥åˆ°å…¶ä»–æœåŠ¡ï¼Œæ— è®ºè¯¥æœåŠ¡æ˜¯åœ¨é›†ç¾¤å†…éƒ¨è¿˜æ˜¯åœ¨å¤–éƒ¨ã€‚æˆ‘ä»¬å¸Œæœ›å…¶å…·æœ‰æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ã€‚ä¸ºäº†ä¸åŒçš„å‘å¸ƒç­–ç•¥æˆ–æ˜¯å…¶ä»–çš„ä¸€äº›åŸå› çš„æˆ‘ä»¬å¸Œæœ›æœ‰æµé‡è½¬ç§»çš„èƒ½åŠ›ã€‚ç„¶åæˆ‘ä»¬è¿˜å¸Œæœ›å…¶å…·æœ‰ä¸å…¶ä»–ç³»ç»Ÿè¿›è¡Œå¼¹æ€§é€šä¿¡çš„èƒ½åŠ›ï¼Œæ— è®ºæ˜¯é€šè¿‡é‡è¯•ã€è¶…æ—¶è¿˜æ˜¯æ–­è·¯å™¨ã€‚è¦æœ‰é€‚å½“çš„å®‰å…¨ä¿éšœï¼Œå¹¶ä¸”è¦æœ‰è¶³å¤Ÿçš„ç›‘æ§ã€è¿½è¸ªã€å¯è§‚å¯Ÿæ€§ç­‰ç­‰ã€‚
æˆ‘ä»¬æœ‰äº†ç½‘ç»œä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬å¸Œæœ›æœ‰èƒ½åŠ›ä¸ä¸åŒçš„ API å’Œç«¯ç‚¹äº¤äº’ï¼Œå³èµ„æºç»‘å®š&amp;ndash;ä¸å…¶ä»–åè®®å’Œä¸åŒçš„æ•°æ®æ ¼å¼äº¤äº’ã€‚ç”šè‡³èƒ½å¤Ÿä»ä¸€ç§æ•°æ®æ ¼å¼è½¬æ¢æˆå¦ä¸€ç§æ•°æ®æ ¼å¼ã€‚æˆ‘è¿˜ä¼šåœ¨è¿™é‡ŒåŠ å…¥è¯¸å¦‚æ»¤å…‰çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬è®¢é˜…ä¸€ä¸ªä¸»é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè®¸åªå¯¹æŸäº›äº‹ä»¶æ„Ÿå…´è¶£ã€‚
ä½ è®¤ä¸ºæœ€åä¸€ç±»æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯çŠ¶æ€ã€‚å½“æˆ‘åœ¨è¯´çŠ¶æ€å’Œæœ‰çŠ¶æ€çš„æŠ½è±¡æ—¶ï¼Œæˆ‘å¹¶ä¸æ˜¯åœ¨è°ˆè®ºå®é™…çš„çŠ¶æ€ç®¡ç†ï¼Œæ¯”å¦‚æ•°æ®åº“æˆ–è€…æ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½ã€‚æˆ‘è¦è¯´çš„æ›´å¤šæ˜¯æœ‰å…³å¹•åä¾èµ–çŠ¶æ€çš„å¼€å‘äººå‘˜æŠ½è±¡ã€‚å¯èƒ½ï¼Œä½ éœ€è¦å…·æœ‰å·¥ä½œæµç®¡ç†çš„èƒ½åŠ›ã€‚ä¹Ÿè®¸ä½ æƒ³ç®¡ç†è¿è¡Œæ—¶é—´é•¿çš„è¿›ç¨‹æˆ–è€…åšä¸´æ—¶è°ƒåº¦æˆ–è€…æŸäº›å®šæ—¶ä»»åŠ¡æ¥å®šæœŸè¿è¡ŒæœåŠ¡ã€‚ä¹Ÿè®¸ä½ è¿˜æƒ³è¿›è¡Œåˆ†å¸ƒå¼ç¼“å­˜ï¼Œå…·æœ‰å¹‚ç­‰æ€§æˆ–è€…æ”¯æŒå›æ»šã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯å¼€å‘äººå‘˜çº§çš„åŸè¯­ï¼Œä½†åœ¨å¹•åï¼Œå®ƒä»¬ä¾èµ–äºå…·æœ‰æŸç§çŠ¶æ€ã€‚ä½ æƒ³éšæ„ä½¿ç”¨è¿™äº›æŠ½è±¡ä¿©åˆ›å»ºå®Œå–„çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚
æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªåˆ†å¸ƒå¼ç³»ç»ŸåŸè¯­çš„æ¡†æ¶æ¥è¯„ä¼°å®ƒä»¬åœ¨ Kubernetes å’Œå…¶ä»–é¡¹ç›®ä¸Šçš„å˜åŒ–æƒ…å†µã€‚
å•ä½“æ¶æ„ &amp;ndash; ä¼ ç»Ÿä¸­é—´ä»¶åŠŸèƒ½ å‡è®¾æˆ‘ä»¬ä»å•ä½“æ¶æ„ä»¥åŠå¦‚ä½•è·å¾—è¿™äº›èƒ½åŠ›å¼€å§‹ã€‚åœ¨é‚£ç§æƒ…å†µä¸‹ï¼Œé¦–å…ˆæ˜¯å½“æˆ‘è¯´å•ä½“çš„æ—¶å€™ï¼Œåœ¨åˆ†å¸ƒå¼åº”ç”¨çš„æƒ…å†µä¸‹æˆ‘æƒ³åˆ°çš„æ˜¯ ESBã€‚ESB æ˜¯ç›¸å½“å¼ºå¤§çš„ï¼Œå½“æˆ‘ä»¬æ£€æŸ¥æˆ‘ä»¬çš„éœ€æ±‚åˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬ä¼šè¯´ ESB å¯¹æ‰€æœ‰æœ‰çŠ¶æ€çš„æŠ½è±¡æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚</description></item><item><title>Kubernetes æºç è§£æ - Informer</title><link>https://atbug.com/articles/kubernetes-source-code-how-informer-work/</link><pubDate>Sun, 16 Aug 2020 23:32:38 +0800</pubDate><guid>https://atbug.com/articles/kubernetes-source-code-how-informer-work/</guid><description>ä¸Šç¯‡æ‰’äº† HPA çš„æºç ï¼Œä½†æ˜¯æ²¡æ·±å…¥ç»†èŠ‚ï¼Œä»Šå¤©å¾€ç»†èŠ‚æ·±å…¥ã€‚
å¼€å±€å…ˆç¥­å‡ºä¸€å¼ å›¾ï¼š
ä¸ºä»€ä¹ˆè¦æœ‰ Informerï¼Ÿ Kubernetes ä¸­çš„æŒä¹…åŒ–æ•°æ®ä¿å­˜åœ¨ etcdä¸­ï¼Œå„ä¸ªç»„ä»¶å¹¶ä¸ä¼šç›´æ¥è®¿é—® etcdï¼Œè€Œæ˜¯é€šè¿‡ api-serveræš´éœ²çš„ RESTful æ¥å£å¯¹é›†ç¾¤è¿›è¡Œè®¿é—®å’Œæ§åˆ¶ã€‚
èµ„æºçš„æ§åˆ¶å™¨ï¼ˆå›¾ä¸­å³ä¾§ç°è‰²çš„éƒ¨åˆ†ï¼‰è¯»å–æ•°æ®ä¹Ÿå¹¶ä¸ä¼šç›´æ¥ä» api-server ä¸­è·å–èµ„æºä¿¡æ¯ï¼ˆè¿™æ ·ä¼šå¢åŠ  api-server çš„å‹åŠ›ï¼‰ï¼Œè€Œæ˜¯ä»å…¶â€œæœ¬åœ°ç¼“å­˜â€ä¸­è¯»å–ã€‚è¿™ä¸ªâ€œæœ¬åœ°ç¼“å­˜â€åªæ˜¯è¡¨è±¡çš„å­˜åœ¨ï¼ŒåŠ ä¸Šç¼“å­˜çš„åŒæ­¥é€»è¾‘å°±æ˜¯ä»Šå¤©è¦æ˜¯è¯´çš„Informerï¼ˆç°è‰²åŒºåŸŸä¸­çš„ç¬¬ä¸€ä¸ªè“è‰²å—ï¼‰æ‰€æä¾›çš„åŠŸèƒ½ã€‚
ä»å›¾ä¸­å¯ä»¥çœ‹åˆ° Informer çš„å‡ ä¸ªç»„ä»¶ï¼š
Reflectorï¼šä¸ api-serveräº¤äº’ï¼Œç›‘å¬èµ„æºçš„å˜æ›´ã€‚ Delta FIFO Queueï¼šå¢é‡çš„ FIFO é˜Ÿåˆ—ï¼Œä¿å­˜ Reflector ç›‘å¬åˆ°çš„èµ„æºå˜æ›´ï¼ˆç®€å•çš„å°è£…ï¼‰ã€‚ Indexerï¼šInformer çš„æœ¬åœ°ç¼“å­˜ï¼ŒFIFO é˜Ÿåˆ—ä¸­çš„æ•°æ®æ ¹æ®ä¸åŒçš„å˜æ›´ç±»å‹ï¼Œåœ¨è¯¥ç¼“å­˜ä¸­è¿›è¡Œæ“ä½œã€‚ Local Storeï¼š ä¸Šç¯‡ æåˆ°äº†æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©çš„æ§åˆ¶å™¨HorizontalControllerï¼Œå…¶æ„é€ æ–¹æ³•å°±éœ€è¦æä¾› Informerã€‚</description></item><item><title>Kubernetes æºç è§£æ - HPA æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©å¦‚ä½•å·¥ä½œ</title><link>https://atbug.com/articles/kubernetes-source-code-how-hpa-work/</link><pubDate>Sat, 15 Aug 2020 02:09:37 +0800</pubDate><guid>https://atbug.com/articles/kubernetes-source-code-how-hpa-work/</guid><description>HPA - Horizontal Pod Autoscaler çš„ç¼©å†™ï¼ŒPod æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©ã€‚é€šè¿‡å¯¹ Pod è´Ÿè½½çš„ç›‘æ§ï¼Œæ¥è‡ªåŠ¨å¢åŠ æˆ–è€…å‡å°‘ Pod çš„å‰¯æœ¬æ•°é‡ã€‚
ä»å­—é¢æ„æ€æ¥çœ‹ï¼Œå…¶ä¸»è¦åŒ…å«äº†ä¸¤éƒ¨åˆ†ï¼š
ç›‘æ§ Pod çš„è´Ÿè½½ æ§åˆ¶ Pod çš„å‰¯æœ¬æ•°é‡ é‚£å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿä»¥ä¸‹åŸºäº1.17 æºç ï¼Œæ¥åˆ†æä¸‹ HPA å¦‚ä½•å·¥ä½œã€‚
æ³¨æ„ï¼šæ–‡ç« ä¸­çš„ä»£ç åœ¨æºç çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ç²¾ç®€ï¼šåˆ æ‰äº†æ³¨é‡Šã€åºåˆ—åŒ–ç­‰ä¿¡æ¯ï¼Œæˆ–ä¿ç•™äº†éƒ¨åˆ†æ ¸å¿ƒä»£ç ï¼ŒåŠ ä¸Šæ–°çš„æ³¨é‡Šã€‚
èµ„æº HPA çš„èµ„æºæ˜¯HorizontalPodAutoscalerï¼Œåœ¨v1ç‰ˆæœ¬ä¸­ï¼Œåªæ”¯æŒåŸºäº CPU æŒ‡æ ‡çš„è®¡ç®—ï¼›åœ¨v2beta2ç‰ˆæœ¬ä¸­åŠ å…¥äº†åŸºäºå†…å­˜å’Œè‡ªå®šä¹‰æŒ‡æ ‡çš„è®¡ç®—ã€‚
v1 //staging/src/k8s.io/api/autoscaling/v1/types.go type HorizontalPodAutoscaler struct { metav1.TypeMeta metav1.ObjectMeta Spec HorizontalPodAutoscalerSpec Status HorizontalPodAutoscalerStatus } type HorizontalPodAutoscalerSpec struct { ScaleTargetRef CrossVersionObjectReference //ç›‘æ§çš„ç›®æ ‡èµ„æº MinReplicas *int32 //æœ€å°å‰¯æœ¬æ•° MaxReplicas int32 //æœ€å¤§å‰¯æœ¬æ•° TargetCPUUtilizationPercentage *int32 //è§¦å‘è°ƒæ•´çš„CPU ä½¿ç”¨ç‡ } v2 //staging/src/k8s.</description></item><item><title>Tekton çš„å·¥ä½œåŸç†</title><link>https://atbug.com/articles/how-tekton-works/</link><pubDate>Sat, 23 May 2020 22:47:14 +0800</pubDate><guid>https://atbug.com/articles/how-tekton-works/</guid><description>è¿™ç¯‡æ–‡ç« æ˜¯åŸºäº Tekton Pipeline çš„æœ€æ–°ç‰ˆæœ¬v0.12.1ç‰ˆæœ¬ã€‚
å¿«é€Ÿå…¥é—¨è¯·å‚è€ƒï¼šäº‘åŸç”Ÿ CICD: Tekton Pipeline å®æˆ˜ ï¼Œå®æˆ˜æ˜¯åŸºäºç‰ˆæœ¬ v0.10.xã€‚
Pipeline CRD ä¸æ ¸å¿ƒèµ„æºçš„å…³ç³» $ k api-resources --api-group=tekton.dev NAME SHORTNAMES APIGROUP NAMESPACED KIND clustertasks tekton.dev false ClusterTask conditions tekton.dev true Condition pipelineresources tekton.dev true PipelineResource pipelineruns pr,prs tekton.dev true PipelineRun pipelines tekton.</description></item><item><title>æ§åˆ¶ Pod å†…å®¹å™¨çš„å¯åŠ¨é¡ºåº</title><link>https://atbug.com/articles/control-process-order-of-pod-containers/</link><pubDate>Thu, 12 Mar 2020 22:05:16 +0800</pubDate><guid>https://atbug.com/articles/control-process-order-of-pod-containers/</guid><description>2021.4.30 æ›´æ–°ï¼š
æœ€æ–°çš„æ–¹æ¡ˆï¼Œè¯·è·³è½¬æ–°ç¯‡ Kubernetes ä¸Šå¦‚ä½•æ§åˆ¶å®¹å™¨çš„å¯åŠ¨é¡ºåºã€‚
èƒŒæ™¯ ä¼—æ‰€å‘¨çŸ¥, Kubernetes Pod å†…æœ‰ä¸¤ç§å®¹å™¨: åˆå§‹åŒ–å®¹å™¨(init container)å’Œåº”ç”¨å®¹å™¨(app container). å…¶ä¸­åˆå§‹åŒ–å®¹å™¨çš„æ‰§è¡Œå…ˆäºåº”ç”¨å®¹å™¨, å¹¶ä¸”åˆå§‹åŒ–å®¹å™¨å’Œåº”ç”¨å®¹å™¨çš„ä¸ªæ•°åˆ†åˆ«ä¸º 0~n å’Œ 1~n.
åˆå§‹åŒ–å®¹å™¨ä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œ, é¡ºåºæ‰§è¡Œçš„å‰ææ˜¯åˆå§‹åŒ–å®¹å™¨å§‹ç»ˆä¼šè¿è¡Œåˆ°å®Œæˆ(completed)çŠ¶æ€. è€Œåº”ç”¨å®¹å™¨æ°å¥½ç›¸å: å¯åŠ¨é¡ºåºéšæœº, å¹¶å§‹ç»ˆä¿æŒè¿è¡Œ(running)çŠ¶æ€.
é—®é¢˜ å·¥ä½œä¸­æœ‰ä¸ªæ¶æ„çš„æ–¹æ¡ˆä½¿ç”¨åˆ°äº† sidecar å®¹å™¨: å°†åŸºç¡€ç»„ä»¶åŠŸèƒ½ä»å®¹å™¨è½¬ç§»åˆ° sidecar å®¹å™¨ä¸­, å…¶ä¸­æœ‰ä¸ªåŠŸèƒ½æ˜¯ä»è¿œç¨‹é…ç½®ä¸­å¿ƒè·å–é…ç½®å¹¶ä¿æŒå®æ—¶æ›´æ–°. ä¿è¯å®æ—¶æ›´æ–°æ²¡æœ‰é—®é¢˜, ä½†æ˜¯é…ç½®æ–‡ä»¶éœ€è¦åœ¨ app å¯åŠ¨ä¹‹å‰å®Œæˆåˆå§‹åŒ–.
å¯¹äºåŒä¸º&amp;quot;åº”ç”¨å®¹å™¨&amp;quot;ç±»å‹çš„ sidecar å®¹å™¨æ¥è¯´, ç”±äºå®¹å™¨å¯åŠ¨é¡ºåºéšæœºè€Œæ— æ³•åšåˆ°è¿™ä¸€ç‚¹.</description></item><item><title>Tekton Trigger ä»‹ç»</title><link>https://atbug.com/articles/tekton-trigger-glance/</link><pubDate>Wed, 05 Feb 2020 18:03:15 +0800</pubDate><guid>https://atbug.com/articles/tekton-trigger-glance/</guid><description>èƒŒæ™¯ Tekton çš„ä»‹ç»è¯·å‚è€ƒTekton Pipeline å®æˆ˜.
é€šå¸¸, CI/CD äº‹ä»¶åº”è¯¥åŒ…å«å¦‚ä¸‹ä¿¡æ¯:
ç¡®å®šäº‹ä»¶çš„ç±»å‹(æ¯”å¦‚ GitHub Push, GitLab Issue, Docker Hub Webhook ç­‰) å¯ä»ç‰¹å®šç®¡é“è®¿é—®å¹¶æ˜ å°„åˆ°ç‰¹å®šç®¡é“ (ä»äº‹ä»¶è´Ÿè½½ä¸­è·å– SHA ä¿¡æ¯, ç„¶ååœ¨ç®¡é“ä¸­ä½¿ç”¨) å‡†ç¡®åœ°è§¦å‘ç®¡é“ (åŸºäºæœ‰æ•ˆè´Ÿè½½å€¼è§¦å‘ç®¡é“) Tekton API çš„è®¾è®¡åˆ†ç¦»äº†é…ç½®(æ¯”å¦‚ PipelineRun VS Pipeline), ä¿è¯äº† step å¯ä»¥è¢«é‡ç”¨. ä½†æ˜¯æ²¡æœ‰æä¾›åŠ¨æ€å°è£…é…ç½®çš„æœºåˆ¶æ¥ç”Ÿæˆèµ„æº(å°¤å…¶æ˜¯ PipelineRun å’Œ PipelineResource). Triggers é€šè¿‡ä¸‹é¢çš„ CRDs åœ¨æ¶æ„ä¸Šå¯¹ Tekton è¿›è¡Œäº†æ‰©å±•:</description></item><item><title>Tekton Dashboard å®‰è£…</title><link>https://atbug.com/articles/tekton-dashboard-installation/</link><pubDate>Sat, 01 Feb 2020 12:39:28 +0800</pubDate><guid>https://atbug.com/articles/tekton-dashboard-installation/</guid><description>Tekton æä¾›äº†dashboardæ–¹ä¾¿ç”¨æˆ·ç®¡ç†å’ŒæŸ¥çœ‹ Tekton PipelineRun å’Œ TaskRun ä»¥åŠåˆ›å»º, æ‰§è¡Œå’Œå®Œæˆè¿‡ç¨‹ä¸­æ¶‰åŠçš„èµ„æº. å®ƒè¿˜å…è®¸æŒ‰æ ‡ç­¾è¿‡æ»¤ PipelineRun å’Œ TaskRun.
å®‰è£…æ–¹æ³• kubectl apply --filename https://github.com/tektoncd/dashboard/releases/download/v0.4.1/dashboard_latest_release.yaml æ£€æŸ¥dashboardçš„è¿è¡Œæƒ…å†µ, STATUSä¸ºRunningçš„è¯åˆ™è¯´æ˜è¿è¡ŒæˆåŠŸ.
kubectl get pods --namespace tekton-pipelines è®¿é—® è®¿é—®Tektonçš„Dashboardæœ‰ä¸¤ç§æ–¹å¼, ä¸€ç§æ˜¯é€šè¿‡port-forward, å¦ä¸€ç§æ˜¯é€šè¿‡ingressæ¥è®¿é—®.
port-forward kubectl port-forward svc/tekton-dashboard 9097 ingress å…ˆæ£€æŸ¥ingressæ˜¯å¦å¼€å¯.
minikube addon list ... - ingress: enabled .</description></item><item><title>Tektonå®‰è£…åŠHello world</title><link>https://atbug.com/articles/tekton-installation-and-sample/</link><pubDate>Fri, 17 Jan 2020 19:17:14 +0800</pubDate><guid>https://atbug.com/articles/tekton-installation-and-sample/</guid><description>å®‰è£… kubectl apply --filename https://storage.googleapis.com/tekton-releases/pipeline/latest/release.yaml æ£€æŸ¥å®‰è£…çš„tektonç›¸å…³çš„CRD:
kubectl api-resources | grep tekton clustertasks tekton.dev false ClusterTask conditions tekton.dev true Condition pipelineresources tekton.dev true PipelineResource pipelineruns pr,prs tekton.dev true PipelineRun pipelines tekton.dev true Pipeline taskruns tr,trs tekton.dev true TaskRun tasks tekton.dev true Task tektonçš„ä¸¤ä¸ªpod:</description></item><item><title>Minikubeå®‰è£…istio</title><link>https://atbug.com/articles/install-istio-on-minikube/</link><pubDate>Fri, 17 Jan 2020 08:02:42 +0800</pubDate><guid>https://atbug.com/articles/install-istio-on-minikube/</guid><description>å‡†å¤‡ æ³¨æ„: istioctlçš„å®‰è£…è¦ä½¿ç”¨å®‰è£…é‡Œçš„, ä¸è¦æ˜¯ç”¨homebrewé‡Œçš„. github issue
curl -L https://istio.io/downloadIstio | sh - cd istio-1.4.2 cp bin/istioctl /usr/local/bin/istioctl å®‰è£…å‰æ£€æŸ¥ istioctl verify-install å¦‚æœæ£€æŸ¥æ²¡é—®é¢˜, ä¼šçœ‹åˆ°Install Pre-Check passed! The cluster is ready for Istio installation.
å®‰è£… istioæœ‰5ç§å†…å»ºçš„å®‰è£…é…ç½®1: remote, sds, default, demo, minimal
istioctl profile list minimal: ä½¿ç”¨istioçš„æµé‡ç®¡ç†æ‰€éœ€ç»„ä»¶çš„æœ€å°åŒ–å®‰è£… default: æ ¹æ®IstioControlPlane APIçš„é»˜è®¤è®¾ç½®(å»ºè®®ç”¨äºç”Ÿäº§éƒ¨ç½²)å¯ç”¨ç»„ä»¶.</description></item><item><title>åŠ é€Ÿäº‘åŸç”Ÿçš„ Java å¼€å‘</title><link>https://atbug.com/articles/speed-up-java-development-on-kubernetes/</link><pubDate>Sat, 21 Dec 2019 20:45:22 +0800</pubDate><guid>https://atbug.com/articles/speed-up-java-development-on-kubernetes/</guid><description>ä»Šå¤©æ¥è¯´è¯´æ—¥å¸¸åœ¨Kuberneteså¼€å‘Javaé¡¹ç›®é‡åˆ°çš„é—®é¢˜.
å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™, æ€»æ˜¯é¢ä¸´éœ€è¦æ–°å»ºmanifest, å¹³æ—¶éƒ½æ˜¯copy+paste+modify. èƒ½å¦ä»¥å˜æˆçš„æ–¹å¼æ¥ç”Ÿæˆ?
å¼€å‘æ—¶çš„æ­¥éª¤ä¹Ÿæ¯”è¾ƒç¹ç: docker build, docker push, kubectl apple, kubectl delete pod. å¯¹äºä¸€ä¸ªJavaåº”ç”¨æ¥è¯´è¿˜å¤šäº†ä¸€æ­¥ç¼–è¯‘. æ“ä½œä¸€æ¬¡è¿˜ok, ä½†æ˜¯ä¸€å¤©åå‡ æ¬¡æ€»ä¼šæœ‰æƒ³åçš„æ„Ÿè§‰. è¿™äº›æ­¥éª¤èƒ½å¦ç®€åŒ–æˆä¸€ä¸ªå‘½ä»¤, ç”šè‡³ä¿®æ”¹äº†ä»£ç è‡ªåŠ¨å°±å®Œæˆä¸Šé¢ä¸€ç³»åˆ—çš„æ“ä½œ?
å®ç°è¿™äº›æˆ‘ä»¬éœ€è¦å‡ ä¸ªå·¥å…·: dekorate, Jib, Skaffold. å…¶ä¸­Jibä¹Ÿåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä½¿ç”¨Jibä¸ºJavaåº”ç”¨æ„å»ºé•œåƒä¸­ä»‹ç»è¿‡.
dekorate Dekorate is a collection of Java compile-time generators and decorators for Kubernetes/OpenShift manifests. Dekorateæ˜¯Javaç¼–è¯‘æ—¶ç”Ÿæˆå’Œè£…é¥°Kubernetes/OpenShiftçš„manifestsçš„å·¥å…·</description></item><item><title>Kubernetesä¸­çš„NginxåŠ¨æ€è§£æ</title><link>https://atbug.com/articles/nginx-dynamic-domain-parse-in-kubernetes/</link><pubDate>Wed, 30 May 2018 12:10:32 +0000</pubDate><guid>https://atbug.com/articles/nginx-dynamic-domain-parse-in-kubernetes/</guid><description>èƒŒæ™¯ Nginxè¿è¡Œåœ¨kubernetsä¸­, åå‘ä»£ç†serviceæä¾›æœåŠ¡.
kubernetesç‰ˆæœ¬v1.9.1+a0ce1bc657.
é—®é¢˜: é…ç½®å¦‚ä¸‹:
location ^~/info { proxy_pass: http://serviceName:port; } åˆ é™¤å¹¶é‡å»ºServiceçš„æ—¶å€™, nginxä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜:
connect() failed (113: No route to host) &amp;hellip; upstream: &amp;ldquo;xxxxx&amp;rdquo;
åˆ†æ é€šè¿‡googleå‘ç°, æ˜¯nginxçš„dnsè§£ææ–¹æ¡ˆçš„é—®é¢˜.
nginxå®˜æ–¹çš„è¯´æ˜:
If the domain name canâ€™t be resolved, NGINX fails to start or reload its configuration.</description></item><item><title>Kubernetes â€” æŒä¹…å·</title><link>https://atbug.com/articles/kubernetes-persistent-volumes/</link><pubDate>Sun, 20 Aug 2017 22:25:40 +0000</pubDate><guid>https://atbug.com/articles/kubernetes-persistent-volumes/</guid><description>Persistent Volume è¯‘è‡ªPersistent Volumes
ä»‹ç» ç®¡ç†å­˜å‚¨æ˜¯ç®¡ç†è®¡ç®—çš„ç‹¬ç‰¹é—®é¢˜ã€‚ PersistentVolumeå­ç³»ç»Ÿä¸ºç”¨æˆ·å’Œç®¡ç†å‘˜æä¾›äº†ä¸€ä¸ªAPIï¼Œå…¶ä¸­æä¾›äº†å¦‚ä½•ä»å¦‚ä½•ä½¿ç”¨å­˜å‚¨æä¾›å­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä»‹ç»ä¸¤ç§æ–°çš„APIèµ„æºï¼šPersistentVolumeå’ŒPersistentVolumeClaimã€‚
PersistentVolumeï¼ˆPVï¼‰æ˜¯ç”±ç®¡ç†å‘˜é…ç½®çš„é›†ç¾¤ä¸­çš„ä¸€æ®µå­˜å‚¨ã€‚å®ƒæ˜¯é›†ç¾¤ä¸­çš„ä¸€ç§èµ„æºå°±åƒä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªé›†ç¾¤çš„èµ„æºã€‚ PVæ˜¯ç±»ä¼¼Volumesçš„å·æ’ä»¶ï¼Œä½†æ˜¯å…·æœ‰ç‹¬ç«‹äºä½¿ç”¨PVçš„ä»»ä½•å•ä¸ªpodçš„ç”Ÿå‘½å‘¨æœŸã€‚è¯¥APIå¯¹è±¡æ•è·å­˜å‚¨çš„å®ç°ç»†èŠ‚ï¼Œå³NFSï¼ŒiSCSIæˆ–äº‘æä¾›å•†ç‰¹å®šçš„å­˜å‚¨ç³»ç»Ÿã€‚
PersistentVolumeClaimï¼ˆPVCï¼‰æ˜¯ç”¨æˆ·å­˜å‚¨çš„è¯·æ±‚ã€‚å®ƒç±»ä¼¼äºpodã€‚ Podæ¶ˆè€—èŠ‚ç‚¹èµ„æºï¼ŒPVCæ¶ˆè€—PVèµ„æºã€‚Podså¯ä»¥è¯·æ±‚ç‰¹å®šçº§åˆ«çš„èµ„æºï¼ˆCPUå’Œå†…å­˜ï¼‰ã€‚å£°æ˜å¯ä»¥è¯·æ±‚ç‰¹å®šçš„å¤§å°å’Œè®¿é—®æ¨¡å¼ï¼ˆä¾‹å¦‚ï¼Œä¸€æ¬¡è¯»å†™æˆ–è€…å¤šæ¬¡åªè¯»ï¼‰ã€‚
è™½ç„¶PersistentVolumeClaimså…è®¸ç”¨æˆ·ä½¿ç”¨æŠ½è±¡å­˜å‚¨èµ„æºï¼Œä½†æ˜¯å¸¸è§çš„æ˜¯ï¼Œç”¨æˆ·éœ€è¦å…·æœ‰ä¸åŒå±æ€§ï¼ˆå¦‚æ€§èƒ½ï¼‰çš„PersistentVolumesï¼Œç”¨äºä¸åŒçš„é—®é¢˜ã€‚ é›†ç¾¤ç®¡ç†å‘˜éœ€è¦èƒ½å¤Ÿæä¾›å¤šç§å½¼æ­¤ä¸åŒçš„PersistentVolumesï¼Œè€Œä¸ä»…ä»…æ˜¯å¤§å°å’Œè®¿é—®æ¨¡å¼ï¼Œè€Œä¸ä¼šä½¿ç”¨æˆ·äº†è§£è¿™äº›å·çš„å®ç°ç»†èŠ‚ã€‚ å¯¹äºè¿™äº›éœ€æ±‚ï¼Œæœ‰ä¸€ä¸ªStorageClassèµ„æºã€‚
StorageClassä¸ºç®¡ç†å‘˜æä¾›äº†ä¸€ç§æè¿°ä»–ä»¬æä¾›çš„å­˜å‚¨çš„â€œç±»â€çš„æ–¹æ³•ã€‚ ä¸åŒçš„ç±»å¯èƒ½æ˜ å°„åˆ°æœåŠ¡è´¨é‡çº§åˆ«ï¼Œæˆ–å¤‡ä»½ç­–ç•¥ï¼Œæˆ–è€…ç”±ç¾¤é›†ç®¡ç†å‘˜ç¡®å®šçš„ä»»æ„ç­–ç•¥ã€‚ Kubernetesæœ¬èº«å¯¹äºä»€ä¹ˆç±»åˆ«ä»£è¡¨æ˜¯ä¸è¨€è€Œå–»çš„ã€‚ è¿™ä¸ªæ¦‚å¿µæœ‰æ—¶åœ¨å…¶ä»–å­˜å‚¨ç³»ç»Ÿä¸­ç§°ä¸ºâ€œé…ç½®æ–‡ä»¶â€ã€‚
è¯·å‚é˜…è¯¦ç»†æ¼”ç»ƒä¸å·¥ä½œç¤ºä¾‹ã€‚
å­˜å‚¨å’Œå£°æ˜çš„ç”Ÿå‘½å‘¨æœŸ PVsæ˜¯é›†ç¾¤ä¸­çš„èµ„æºï¼›PVCsæ˜¯å¯¹è¿™ç§èµ„æºçš„å£°æ˜ï¼ŒåŒæ—¶ä¹Ÿæ‰®æ¼”è€…å¯¹èµ„æºå£°æ˜çš„æ£€æŸ¥ã€‚PVså’ŒPVCsä¹‹å‰çš„äº¤äº’éµå¾ªç”Ÿå‘½å‘¨æœŸï¼šä¾›åº”ã€ç»‘å®šã€ä½¿ç”¨ä¸­ã€é‡æ–°ç”³è¯·ã€‚
é›†ç¾¤ç®¡ç†å‘˜åˆ›å»ºå¤šä¸ªPVã€‚å®ƒä»¬æºå¸¦å¯ä¾›é›†ç¾¤ç”¨æˆ·ä½¿ç”¨çš„çœŸå®å­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ã€‚å®ƒä»¬å­˜åœ¨äºKubernetes APIä¸­ï¼Œå¯ç”¨äºæ¶ˆè´¹ã€‚
ä¾›åº”(Provisioning) PVsä¼šä»¥ä¸¤ç§æ–¹å¼ä¾›åº”ï¼šé™æ€å’ŒåŠ¨æ€ã€‚
é™æ€ é›†ç¾¤ç®¡ç†å‘˜åˆ›å»ºå¤šä¸ªPVã€‚ å®ƒä»¬æºå¸¦å¯ä¾›é›†ç¾¤ç”¨æˆ·ä½¿ç”¨çš„çœŸå®å­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ã€‚ å®ƒä»¬å­˜åœ¨äºKubernetes APIä¸­ï¼Œå¯è¢«ä½¿ç”¨ã€‚
åŠ¨æ€ å½“ç®¡ç†å‘˜åˆ›å»ºçš„é™æ€PVéƒ½ä¸åŒ¹é…ç”¨æˆ·çš„PersistentVolumeClaimæ—¶ï¼Œé›†ç¾¤å¯èƒ½ä¼šå°è¯•ä¸ºPVCæŒ‡å®šåŠ¨æ€é…ç½®å·ã€‚ æ­¤é…ç½®åŸºäºStorageClassesï¼šPVCå¿…é¡»æŒ‡å®šä¸€ä¸ªç±»ï¼Œå¹¶ä¸”ç®¡ç†å‘˜å¿…é¡»å·²åˆ›å»ºå¹¶é…ç½®è¯¥ç±»æ‰èƒ½è¿›è¡ŒåŠ¨æ€é…ç½®ã€‚ è¦æ±‚è¯¥ç±»çš„å£°æ˜æœ‰æ•ˆåœ°ä¸ºè‡ªå·±ç¦ç”¨åŠ¨æ€é…ç½®ã€‚
ç»‘å®š(Binding) å½“ç”¨æˆ·åˆ›å»ºã€æˆ–å·²ç»åˆ›å»ºäº†ä¸€ä¸ªPersistenVolumenClaimå¹¶æŒ‡å®šå¤§å°å’Œè®¿é—®ç±»å‹ã€‚Masterä¸­çš„æ§åˆ¶å¾ªç¯ä¼šæ£€æµ‹æ–°çš„PVCï¼Œæ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„PVï¼ˆå¦‚æœå¯èƒ½çš„è¯ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ç»‘å®šåœ¨ä¸€èµ·ã€‚å¦‚æœä¸€ä¸ªPVè¢«åŠ¨æ€åœ°ä¾›åº”æŸä¸ªPVCï¼Œå¾ªç¯å°†æ€»æ˜¯æŠŠè¿™ä¸ªPVå’Œè¯¥PVCç»‘å®šã€‚å¦åˆ™ï¼Œç”¨æˆ·æ€»æ˜¯è‡³å°‘å¾—åˆ°ä»–ä»¬è¦æ±‚çš„å†…å®¹ï¼Œä½†æ˜¯å·å¯èƒ½è¶…å‡ºäº†è¦æ±‚ã€‚ä¸€æ—¦ç»‘å®šï¼ŒPersistentVolumeClaimç»‘å®šæ˜¯æ’ä»–çš„ï¼Œä¸ç®¡ç”¨äºç»‘å®šå®ƒä»¬çš„æ¨¡å¼ã€‚
å¦‚æœåŒ¹é…çš„å·ä¸å­˜åœ¨ï¼Œè¯·æ±‚å°†æ— é™æœŸåœ°ä¿æŒã€‚ éšç€åŒ¹é…å·å˜å¾—å¯ç”¨ï¼Œè¯·æ±‚å°†è¢«ç»‘å®šã€‚ ä¾‹å¦‚ï¼Œæä¾›è®¸å¤š50Gi PVçš„é›†ç¾¤å°†ä¸åŒ¹é…è¦æ±‚100Giçš„PVCã€‚ å½“é›†ç¾¤ä¸­æ·»åŠ 100Gi PVæ—¶ï¼Œå¯ä»¥ç»‘å®šPVCã€‚</description></item><item><title>Kuberneteså­¦ä¹  â€” Macoså®‰è£…Kubernetes</title><link>https://atbug.com/articles/install-kubernetes-on-macos/</link><pubDate>Thu, 17 Aug 2017 09:44:17 +0000</pubDate><guid>https://atbug.com/articles/install-kubernetes-on-macos/</guid><description>Kubernetes å®‰è£… macos æ£€æŸ¥ç¯å¢ƒ sysctl -a | grep machdep.cpu.features | grep VMX å®‰è£…VirtualBox http://download.virtualbox.org/virtualbox/5.1.26/Oracle_VM_VirtualBox_Extension_Pack-5.1.26-117224.vbox-extpack å®‰è£…minikube curl -Lo minikube https://storage.googleapis.com/minikube/releases/v0.21.0/minikube-darwin-amd64 &amp;amp;&amp;amp; chmod +x minikube &amp;amp;&amp;amp; sudo mv minikube /usr/local/bin/ åˆ›å»ºé›†ç¾¤ é»˜è®¤ä½¿ç”¨virtualboxã€‚
ä¸»æœºçš„ipæ˜¯192.168.31.186ï¼Œ 1087æ˜¯proxyçš„ç«¯å£ã€‚éœ€è¦å°†ssçš„httpä»£ç†ç›‘å¬åœ°å€ä»127.0.0.1æ”¹ä¸ºä¸»æœºçš„ipã€‚
#å¯åŠ¨ minikube start #ä½¿ç”¨ç§æœ‰åº“ minikube start --insecure-registry=&amp;#34;192.168.31.34&amp;#34; #ä½¿ç”¨proxyï¼Œç”¨äºè·å–é•œåƒ minikube start --docker-env HTTP_PROXY=&amp;#34;192.</description></item></channel></rss>