<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>k3s on 乱世浮生</title><link>https://atbug.com/tags/k3s/</link><description>Recent content in k3s on 乱世浮生</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 27 Oct 2023 04:55:13 +0800</lastBuildDate><atom:link href="https://atbug.com/tags/k3s/index.xml" rel="self" type="application/rss+xml"/><item><title>使用 k3sup 一分钟快速搭建 K3s 集群</title><link>https://atbug.com/setup-k3s-cluster-with-k3sup-in-one-minute/</link><pubDate>Fri, 27 Oct 2023 04:55:13 +0800</pubDate><guid>https://atbug.com/setup-k3s-cluster-with-k3sup-in-one-minute/</guid><description>背景 在平时的工作中，为了方便在纯净的环境中进行测试，我经常需要在本地或者公有云环境中频繁地搭建和销毁集群。有时是在 我的 HomeLab 环境中，虽然 CPU 不强但胜在内存够大；后来有了微软 MVP 赠送的 Azure 额度之后，我也会经常在 Azure 虚拟机 中搭建，因为没有拉取镜像的网络问题。
在两个环境中我通过 Terraform 实现了虚拟机的快速创建和销毁，然后在虚拟机上创建 K3s 集群。K3s 集群足够轻量级，并支持对组件的定制。结合 Alfred Snippets，我只需要 ssh 到虚拟机上并键入 k3si 就可以快速输入定制好的命令，然后再获取虚拟机上的 kubeconfig 文件并替换其中的 api-server 地址（这些也通过 snippet）解决：
export MASTER_IP=${MASTER_IP:-$(ip addr show eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39; | cut -d/ -f1)} export INSTALL_K3S_VERSION=v1.</description></item></channel></rss>