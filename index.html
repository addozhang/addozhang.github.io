<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.57.2" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>乱世浮生</title>
  <meta name="description" content="知我者谓我何忧 不知我者谓我何求." />

  
  <link type="text/css" rel="stylesheet" href="https://atbug.com/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://atbug.com/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://atbug.com/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://atbug.com/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="./favicon.png">

  
  <link href="https://atbug.com/index.xml" rel="alternate" type="application/rss+xml" title="乱世浮生" />
  
</head>

  <body class="theme-base-08 ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://atbug.com/"><h1>乱世浮生</h1></a>
      <p class="lead">
       知我者谓我何忧 不知我者谓我何求. 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://atbug.com/">Home</a> </li>
        <li><a href="./post/"> Archives </a></li><li><a href="./tags/"> Tags </a></li><li><a href="./categories/"> Categories </a></li><li><a href="./about/"> About </a></li>
      </ul>
    </nav>

    <p>&copy; 2019. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/bose-qc35-downgrade/">Bose QC35 固件降级</a>
  </h1>
  <time datetime="2019-11-10T19:50:27&#43;0800" class="post-date">Sun, Nov 10, 2019</time>
  为什么要降级? 既然已经搜到了这里, 相信个中原因也都清楚. 我的QC35一代, 之前升级到了3.0.3固件. 目前已成功降级到了1.0.6, 下面的操
  
  <div class="read-more-link">
    <a href="./bose-qc35-downgrade/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/docker-engine-api-on-mac-osx/">Docker Engine API on Mac Osx</a>
  </h1>
  <time datetime="2019-11-06T20:19:50&#43;0800" class="post-date">Wed, Nov 6, 2019</time>
  根据官方的文档Docker Desktop on Mac vs. Docker Toolbox, Docker Desktop on Mac只提供了UNIX socket/var/run/docker.sock, 并未提供tcp的监听(默认2375端口). 如果使用linux的配置方式在
  
  <div class="read-more-link">
    <a href="./docker-engine-api-on-mac-osx/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-boot-2-2-0-release/">Spring Boot 2.2.0 发布</a>
  </h1>
  <time datetime="2019-10-22T09:27:03&#43;0800" class="post-date">Tue, Oct 22, 2019</time>
  译自: https://spring.io/blog/2019/10/16/spring-boot-2-2-0 组件升级 Spring AMQP 2.2 Spring Batch 4.2 Spring Data Moore Spring Framework 5.2 Spring HATEOAS 1.0 Spring Integration 5.2 Spring Kafka 2.3 Spring Security 5.2 Spring Session Corn 第三方库升级 Elasticsearch 6.7 Flyway 6.0 Jackson 2.10 JUnit 5.5 Micrometer 1.3 Reactor Dysprosium Solr 8.0 性能提升 延迟初始化(Lazy initialization)
  
  <div class="read-more-link">
    <a href="./spring-boot-2-2-0-release/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/zipkin-dependencies-bug-two-timeout-and-oom/">Zipkin dependencies的坑之二: 心跳超时和Executor OOM</a>
  </h1>
  <time datetime="2019-09-22T18:27:37&#43;0800" class="post-date">Sun, Sep 22, 2019</time>
  上回说为了解决吞吐问题, 将zipkin-dependencies的版本升级到了2.3.0. 好景不长, 从某一天开始作业运行报错: 1 2 3 4 5 6 7
  
  <div class="read-more-link">
    <a href="./zipkin-dependencies-bug-two-timeout-and-oom/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/zipkin-dependencies-bug-one/">Zipkin dependencies的坑之一: 耗时越来越长</a>
  </h1>
  <time datetime="2019-09-22T17:59:56&#43;0800" class="post-date">Sun, Sep 22, 2019</time>
  zipkin-dependencies是zipkin调用链的依赖分析工具. 系统上线时使用了当时的最新版本2.0.1, 运行一年之后随着服务的增
  
  <div class="read-more-link">
    <a href="./zipkin-dependencies-bug-one/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/how-to-choose-topic-partition-count-number-kafka/">如何选择Kafka Topic的分区数</a>
  </h1>
  <time datetime="2019-08-30T11:10:46&#43;0800" class="post-date">Fri, Aug 30, 2019</time>
  在kafka中, topic的分区是并行计算的单元. 在producer端和broker端, 可以同时并发的写数据到不同的分区中. 在consume
  
  <div class="read-more-link">
    <a href="./how-to-choose-topic-partition-count-number-kafka/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/no-output-in-past-half-year/">博客最近半年没什么产出</a>
  </h1>
  <time datetime="2019-08-27T14:29:12Z" class="post-date">Tue, Aug 27, 2019</time>
  上一篇日志更新还是在去年的12月, 至今有差不多10个月没有更新了. 不是说没有东西可写, 而且想写的东西很多. 工作太忙, 不忙的时候又太懒, 归根结
  
  <div class="read-more-link">
    <a href="./no-output-in-past-half-year/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-boot-configuration-annotation/">Spring Boot源码分析 - Configuration注解</a>
  </h1>
  <time datetime="2018-12-10T16:24:33Z" class="post-date">Mon, Dec 10, 2018</time>
  @Configuration注解 @Configuration注解指示一个类声明一个或多个@Bean方法, 并且可以由Spring容器处理, 以在
  
  <div class="read-more-link">
    <a href="./spring-boot-configuration-annotation/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/elasticsearch-http-basic-authentication-via-nginx/">Nginx实现Elasticsearch的HTTP基本认证</a>
  </h1>
  <time datetime="2018-11-06T09:24:24Z" class="post-date">Tue, Nov 6, 2018</time>
  Elasticssearch的HTTP基本认证实现有两种方案: x-pack和nginx反向代理. 前者收费, 后者不太适合生产使用. 如果仅仅是开
  
  <div class="read-more-link">
    <a href="./elasticsearch-http-basic-authentication-via-nginx/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-docker-and-openshift-client-tools-in-alpine-container/">Alpine容器安装Docker和OpenShift Client Tools</a>
  </h1>
  <time datetime="2018-08-28T09:14:12Z" class="post-date">Tue, Aug 28, 2018</time>
  安装Docker 1 2 3 4 5 6 7 8 9 10 11 12 13 echo &#34;http://dl-2.alpinelinux.org/alpine/edge/main&#34; &gt; /etc/apk/repositories echo &#34;http://dl-2.alpinelinux.org/alpine/edge/community&#34; &gt;&gt; /etc/apk/repositories echo &#34;http://dl-2.alpinelinux.org/alpine/edge/testing&#34; &gt;&gt; /etc/apk/repositories apk -U --no-cache \ --allow-untrusted add \ shadow \ docker \ py-pip \ openrc \ &amp;&amp; pip install docker-compose rc-update add docker boot 安装OpenShift Client Tools 需
  
  <div class="read-more-link">
    <a href="./install-docker-and-openshift-client-tools-in-alpine-container/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/ribbon-retry-in-zuul/">Zuul网关Ribbon重试</a>
  </h1>
  <time datetime="2018-08-02T08:55:43Z" class="post-date">Thu, Aug 2, 2018</time>
  相关配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #如果路由转发请求发生超时(连接超时或处理超时), 只要超时时间的设置小于Hystrix的命令
  
  <div class="read-more-link">
    <a href="./ribbon-retry-in-zuul/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/hystrix-exception-handling/">Hystrix工作原理三</a>
  </h1>
  <time datetime="2018-06-24T16:20:16Z" class="post-date">Sun, Jun 24, 2018</time>
  异常处理 Hystrix异常类型 HystrixRuntimeException HystrixBadRequestException HystrixTimeoutException RejectedExecutionException HystrixRuntimeException HystrixCommand失败时抛出, 不会触发fallback. HystrixBadRequestException 用提供的参数或状态表示错误的异常
  
  <div class="read-more-link">
    <a href="./hystrix-exception-handling/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/hystrix-isolation/">Hystrix工作原理二</a>
  </h1>
  <time datetime="2018-06-24T16:18:52Z" class="post-date">Sun, Jun 24, 2018</time>
  隔离策略 线程和线程池 客户端(库, 网络调用等)在各自的线程上运行. 这种做法将他们与调用线程隔开, 因此调用者可以从一个耗时的依赖调用&rdquo
  
  <div class="read-more-link">
    <a href="./hystrix-isolation/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/how-hystrix-works/">Hystrix工作原理一</a>
  </h1>
  <time datetime="2018-06-04T08:47:40Z" class="post-date">Mon, Jun 4, 2018</time>
  运行时的流程图 构建HystrixCommand或者HystrixObservableCommand对象 第一步是构建一个HystrixComm
  
  <div class="read-more-link">
    <a href="./how-hystrix-works/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/rsyslogd-high-cpu-trouble-shooting/">解决rsyslogd资源占用率高问题</a>
  </h1>
  <time datetime="2018-06-01T09:32:28Z" class="post-date">Fri, Jun 1, 2018</time>
  rsyslogd资源占用高问题记录 问题: openshift集群安装在esxi的虚拟机上. 各个节点出现问题, 集群响应很慢. kswapd0进程c
  
  <div class="read-more-link">
    <a href="./rsyslogd-high-cpu-trouble-shooting/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/nginx-dynamic-domain-parse-in-kubernetes/">Kubernetes中的Nginx动态解析</a>
  </h1>
  <time datetime="2018-05-30T12:10:32Z" class="post-date">Wed, May 30, 2018</time>
  背景 Nginx运行在kubernets中, 反向代理service提供服务. kubernetes版本v1.9.1+a0ce1bc657. 问题:
  
  <div class="read-more-link">
    <a href="./nginx-dynamic-domain-parse-in-kubernetes/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-cloud-ribbon-breakdown-1/">Spring Cloud Ribbon 详解</a>
  </h1>
  <time datetime="2018-05-05T11:18:05Z" class="post-date">Sat, May 5, 2018</time>
  <p>客户端负载均衡, Ribbon的核心概念是命名的客户端.</p>

<h2 id="使用">使用</h2>

<h3 id="引入ribbon依赖和配置">引入Ribbon依赖和配置</h3>

<p>加入<code>spring-cloud-starter-netflix-ribbon</code>依赖</p>

<h3 id="代码中使用ribbonclient注解">代码中使用RibbonClient注解</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span> 
<span class="nd">@RibbonClient</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;foo&#34;</span><span class="p">,</span> <span class="n">configuration</span> <span class="o">=</span> <span class="n">FooConfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="kd">public</span> <span class="nf">class</span> <span class="n">TestConfiguration</span> <span class="p">{}</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span> <span class="kd">protected</span> <span class="nf">static</span> <span class="kd">class</span> <span class="nf">FooConfiguration</span> <span class="p">{</span>

    <span class="nd">@Bean</span> 
    <span class="kd">public</span> <span class="nf">ZonePreferenceServerListFilter</span> <span class="n">serverListFilter</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">ZonePreferenceServerListFilter</span> <span class="nf">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ZonePreferenceServerListFilter</span><span class="p">();</span>
        <span class="n">filter</span><span class="p">.</span><span class="na">setZone</span><span class="p">(</span><span class="s">&#34;myTestZone&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">filter</span><span class="p">;</span> 
    <span class="p">}</span>

    <span class="nd">@Bean</span> 
    <span class="kd">public</span> <span class="nf">IPing</span> <span class="n">ribbonPing</span><span class="p">()</span> <span class="p">{</span> 
        <span class="k">return</span> <span class="k">new</span> <span class="n">PingUrl</span><span class="p">();</span> 
    <span class="p">}</span>

<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>Ribbon客户端的配置, 如果不指定会使用默认的实现:</p>

<ul>
<li>IClientConfig 客户端相关配置</li>
<li>IRule 定义负载均衡策略</li>
<li>IPing 定义如何ping目标服务实例来判断是否存活, ribbon使用单独的线程每隔一段时间(默认10s)对本地缓存的ServerList做一次检查</li>
<li>ServerList<Server>    定义如何获取服务实例列表. 两种实现基于配置的<code>ConfigurationBasedServerList</code>和基于Eureka服务发现的<code>DiscoveryEnabledNIWSServerList</code></li>
<li>ServerListFilter<Server>  用来使用期望的特征过滤静态配置动态获得的候选服务实例列表. 若未提供, 默认使用<code>ZoneAffinityServerListFilter</code></li>
<li>ILoadBalancer 定义了软负载均衡器的操作的接口. 一个典型的负载均衡器至少需要一组用来做负载均衡的服务实例, 一个标记某个服务实例不在旋转中的方法, 和对应的方法调用从实例列表中选出某一个服务实例.</li>
<li>ServerListUpdater DynamicServerListLoadBalancer用来更新实例列表的策略(推<code>EurekaNotificationServerListUpdater</code>/拉<code>PollingServerListUpdater</code>, 默认是拉)</li>
</ul>
  
  <div class="read-more-link">
    <a href="./spring-cloud-ribbon-breakdown-1/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/using-role-based-authorization-strategy-in-jenkins/">Jenkins CI/CD (一) 基于角色的授权策略</a>
  </h1>
  <time datetime="2018-04-20T12:18:46Z" class="post-date">Fri, Apr 20, 2018</time>
  <p>最近开始客串运维做CI/CD的规划设计, 主要是基于&rsquo;Pipeline as Code in Jenkins&rsquo;. 整理了下思路和技术点, 慢慢的写.</p>

<p>这一篇是关于基于角色的授权策略, 用的是<code>Role-Based Authorization Strategy Plugin</code>.</p>

<p>授权在CI/CD流程中比较常见, 比如我们只让某些特定用户才可以构建Pre-Release的Job. 而更高级的Release发布, 又会需要某些用户的审批才可以进行. 需要授权时, 可能还需要发邮件提醒用户.</p>

<p>UI上如何使用就不提了, 这里只说Pipeline as Code. 后面的几篇也会是这个背景.</p>

<p>参考的这篇<a href="https://www.avioconsulting.com/blog/using-role-based-authorization-strategy-jenkins">文章</a>, 文章里的代码运行失败, 做了修复.</p>

<h2 id="配置">配置</h2>

<p>安装完插件, 需要开始<code>基于角色的授权策略</code>. 同时添加角色和为用户分配角色.</p>

<h3 id="使用-role-based-strategy-作为验证方式">使用<code>Role-Based Strategy</code>作为验证方式</h3>

<p><code>Manage Jenkins / Configure Global Security / Configure Global Security</code></p>

<p><img src="http://7xvxng.com1.z0.glb.clouddn.com/15241955282214.jpg" alt="" /></p>
  
  <div class="read-more-link">
    <a href="./using-role-based-authorization-strategy-in-jenkins/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kvm-installation-note/">KVM安装手册</a>
  </h1>
  <time datetime="2018-04-12T12:45:15Z" class="post-date">Thu, Apr 12, 2018</time>
  <h2 id="添加虚拟机流程">添加虚拟机流程：</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">1. 配置网络
2. 配置存储池
3. 上传镜像
4. 安装虚拟机，指定配置</pre></td></tr></table>
</div>
</div>
<h3 id="安装kvm虚拟机">安装KVM虚拟机</h3>

<h4 id="1-关闭防火墙-selinux">1. 关闭防火墙，selinux</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># service iptables stop</span>
<span class="c1"># setenforce 0 临时关闭</span>
<span class="c1"># chkconfig NetworkManager off</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="2-安装kvm虚拟机">2. 安装kvm虚拟机</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># yum install kvm libvirt libvirt-devel python-virtinst python-virtinst qemu-kvm virt-viewer bridge-utils virt-top libguestfs-tools ca-certificates audit-libs-python device-mapper-libs virt-install</span>
<span class="c1"># 启动服务</span>
<span class="c1"># service libvirtd restart</span>
下载virtio-win-1.5.2-1.el6.noarch.rpm 如果不安装window虚拟机或者使用带virtio驱动的镜像可以不用安装
<span class="c1"># rpm -ivh virtio-win-1.5.2-1.el6.noarch.rpm</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="3-libvirt在管理本地或远程hypervisor时的表现形式如下">3. Libvirt在管理本地或远程Hypervisor时的表现形式如下。</h4>

<p>在libvirt内部管理了五部分：</p>

<ul>
<li>节点：所谓的节点就是我们的物理服务器，一个服务器代表一个节点，上边存放着Hyper和Domain</li>
<li>Hypervisor：即VMM，指虚拟机的监控程序，在KVM中是一个加载了kvm.ko的标准Linux系统。</li>
<li>域（Domain）：指虚拟机，一个域代表一个虚拟机（估计思路来源于Xen的Domain0）</li>
<li>存储池（Storage Pool）：存储空间，支持多种协议和网络存储。作为虚拟机磁盘的存储源。</li>
<li>卷组（Volume）：虚拟机磁盘在Host上的表现形式。
上边的五部分，我们必须使用的是前三个，因为很多时候根据业务规则或应用的灵活性并没有使用卷组（其实就是有了编制的虚拟磁盘文件），也就没有必要使用存储池。</li>
</ul>
  
  <div class="read-more-link">
    <a href="./kvm-installation-note/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/jenkins-cli-enable/">启用Jenkins CLI</a>
  </h1>
  <time datetime="2018-04-09T11:16:38Z" class="post-date">Mon, Apr 9, 2018</time>
  Jenkins CLI提供了SSH和Client模式. Docker运行Jenkins 1 2 3 4 5 6 7 8 9 10 version:&#39;3&#39;services:jenkins:image:jenkins/jenkins:alpineports:-8080:8080-50000:50000-46059:46059volumes:-&#34;/Users/addo/DevApps/Docker/data/jenkins:/var/jenkins_home&#34; note: 以为是docker运行, ssh端口设置选用了固
  
  <div class="read-more-link">
    <a href="./jenkins-cli-enable/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/resolve-process-be-killed-after-jenkins-job-done/">Jenkins - 解决execute shell中启动的进程被在Job退出时被杀死问题</a>
  </h1>
  <time datetime="2018-03-15T17:00:25Z" class="post-date">Thu, Mar 15, 2018</time>
  因为ProcessTreeKiller的存在, 构建过程中使用shell启动的进程在Job完成时都会被kill掉. 各种搜索以及ProcessT
  
  <div class="read-more-link">
    <a href="./resolve-process-be-killed-after-jenkins-job-done/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-minishift-on-mac/">MacOS安装minishift</a>
  </h1>
  <time datetime="2018-02-23T15:32:26Z" class="post-date">Fri, Feb 23, 2018</time>
  MacOS环境安装minishift 安装minishift cli 1 brew cask install minishift 使用virtualbox安装 安装的时候可以指定HTTP代理, 拉取墙外镜
  
  <div class="read-more-link">
    <a href="./install-minishift-on-mac/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-cloud-zuul-breakdown/">Spring Cloud Zuul详解</a>
  </h1>
  <time datetime="2018-02-22T17:02:26Z" class="post-date">Thu, Feb 22, 2018</time>
  <p>Spring Cloud对Netflix Zuul做了封装集成, 使得在Spring Cloud环境中使用Zuul更方便. Netflix Zuul相关分析请看<a href="http://atbug.com/learn-netflix-zuul/">上一篇</a>.</p>

<h2 id="实现">实现</h2>

<p>@EnableZuulProxy 与 @EnableZuulServer
二者的区别在于前者使用了服务发现作为路由寻址, 并使用Ribbon做客户端的负载均衡; 后者没有使用.
Zuul server的路由都通过<code>ZuulProperties</code>进行配置.</p>

<h3 id="具体实现">具体实现:</h3>

<ol>
<li>使用<code>ZuulController</code>(<code>ServletWrappingController</code>的子类)封装<code>ZuulServlet</code>实例, 处理从<code>DispatcherServlet</code>进来的请求.</li>
<li><code>ZuulHandlerMapping</code>负责注册handler mapping, 将<code>Route</code>的<code>fullPath</code>的请求交由<code>ZuulController</code>处理.</li>
<li>同时使用<code>ServletRegistrationBean</code>注册<code>ZuulServlet</code>, 默认使用<code>/zuul</code>作为urlMapping. 所有来自以<code>/zuul</code>开头的path的请求都会直接进入<code>ZuulServlet</code>, 不会进入<code>DispatcherServlet</code>.</li>
</ol>

<h4 id="使用注解">使用注解</h4>

<ul>
<li><p><code>@EnableZuulProxy</code>引入了<code>ZuulProxyMarkerConfiguration</code>, <code>ZuulProxyMarkerConfiguration</code>只做了一件事, 实例化了内部类<code>Marker</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="nf">class</span> <span class="n">ZuulProxyMarkerConfiguration</span> <span class="p">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nf">Marker</span> <span class="n">zuulProxyMarkerBean</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Marker</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nf">Marker</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div></li>

<li><p><code>@EnableZuulServer</code>引入了<code>ZuulServerMarkerConfiguration</code>, <code>ZuulServerMarkerConfiguration</code>也只做了一件事: 实例化了内部类<code>Marker</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="nf">class</span> <span class="n">ZuulServerMarkerConfiguration</span> <span class="p">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nf">Marker</span> <span class="n">zuulServerMarkerBean</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Marker</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nf">Marker</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
  
  <div class="read-more-link">
    <a href="./spring-cloud-zuul-breakdown/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-cloud-service-registry-via-eureka/">Spring Cloud - Eureka服务注册</a>
  </h1>
  <time datetime="2018-02-14T07:32:43Z" class="post-date">Wed, Feb 14, 2018</time>
  <p>之前分析过<a href="http://atbug.com/spring-cloud-eureka-client-source-code-analysis/">Spring Cloud的Eureka服务发现</a>, 今天分析一下服务注册.</p>

<h2 id="配置">配置</h2>

<h3 id="bootstrapconfiguration">BootstrapConfiguration</h3>

<h4 id="eurekadiscoveryclientconfigservicebootstrapconfiguration">EurekaDiscoveryClientConfigServiceBootstrapConfiguration</h4>

<p>spring-cloud-config环境中使用的配置</p>

<p>引入<code>EurekaDiscoveryClientConfiguration</code>和<code>EurekaClientAutoConfiguration</code></p>

<h5 id="eurekadiscoveryclientconfiguration">EurekaDiscoveryClientConfiguration</h5>

<ol>
<li>在spring-cloud中(通过是否存在RefreshScopeRefreshedEvent.class判断), 添加<code>RefreshScopeRefreshedEvent</code>的listener. 收到事件后重新注册实例.</li>
<li>在<code>eureka.client.healthcheck.enabled</code>设置为true时, 注册<code>EurekaHealthCheckHandler</code>bean. <code>EurekaHealthCheckHandler</code>负责将应用状态映射为实例状态<code>InstanceStatus</code>.</li>
</ol>

<h5 id="eurekaclientautoconfiguration">EurekaClientAutoConfiguration</h5>

<p>支持spring-cloud和非spring-cloud环境, 在spring-cloud环境中, 下面两个bean要使用<code>@RefreshScope</code>标注</p>

<ol>
<li>实例化<code>EurekaClient</code>bean, 在spring-cloud中使用实现类<code>CloudEurekaClient</code>.</li>
<li>使用<code>EurekaInstanceConfig</code>实例, 实例化<code>ApplicationInfoManager</code>bean</li>
</ol>
  
  <div class="read-more-link">
    <a href="./spring-cloud-service-registry-via-eureka/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/learn-netflix-zuul/">初识Netflix Zuul</a>
  </h1>
  <time datetime="2018-02-11T10:07:18Z" class="post-date">Sun, Feb 11, 2018</time>
  <p>嵌入式的zuul代理</p>

<p>使用了Netfilx OSS的其他组件:
- Hystrix   熔断
- Ribbon    负责发送外出请求的客户端, 提供软件负载均衡功能
- Trubine   实时地聚合细粒度的metrics数据
- Archaius  动态配置</p>

<h2 id="介绍">介绍</h2>

<p>由于2.0停止开发且会有bug, 故下面的分析基于1.x版本.</p>

<h3 id="特性">特性</h3>

<ul>
<li>Authentication 认证</li>
<li>Insights 洞察</li>
<li>Stress Testing 压力测试</li>
<li>Canary Testing 金丝雀测试</li>
<li>Dynamic Routing 动态路由</li>
<li>Multi-Region Resiliency 多区域弹性</li>
<li>Load Shedding 负载脱落</li>
<li>Security 安全</li>
<li>Static Response handling 静态响应处理</li>
<li>Multi-Region Resiliency 主动/主动流量管理</li>
</ul>
  
  <div class="read-more-link">
    <a href="./learn-netflix-zuul/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/configurationproperties-requires-getter-or-not/">ConfigurationProperties到底需不需要getter</a>
  </h1>
  <time datetime="2018-02-07T15:53:21Z" class="post-date">Wed, Feb 7, 2018</time>
  为什么要讨论这个问题, 工作中一个同事写的类使用了ConfigurationProperties, 只提供了标准的setter方法. 属性的访问,
  
  <div class="read-more-link">
    <a href="./configurationproperties-requires-getter-or-not/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/go-in-action-four/">Go In Action 读书笔记 四</a>
  </h1>
  <time datetime="2018-01-01T12:30:55Z" class="post-date">Mon, Jan 1, 2018</time>
  <p><img src="https://talks.golang.org/2013/go4python/img/fib-go.png" alt="" /></p>

<h2 id="并发模式">并发模式</h2>

<h3 id="runner">runner</h3>

<p>runner展示了如何使用通道来监视程序的执行时间, 如果程序执行时间太长, 也可以用终止程序.
这个程序可用作corn作业执行</p>
  
  <div class="read-more-link">
    <a href="./go-in-action-four/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/go-in-action-three/">Go In Action 读书笔记 三</a>
  </h1>
  <time datetime="2018-01-01T12:30:31Z" class="post-date">Mon, Jan 1, 2018</time>
  <h2 id="并发">并发</h2>

<p>Go语言里的并发是指让某个函数可以独立于其他函数运行的能力. 当一个函数创建为goroutine时, Go会将其视为一个独立的工作单元. 这个工作单元会被调度到可用的<strong>逻辑处理器</strong>上执行.</p>

<p>Go的运行时调度器可以管理所有创建的goroutine, 并为其分配执行时间.
这个调度器在操作系统之上, 将操作系统的线程与逻辑处理器绑定, 并在逻辑处理器执行goroutine. <strong>调度器可以在任何给定的时间, 全面控制哪个goroutine在哪个逻辑处理器上运行</strong>.</p>

<p>Go的并发同步模型来自一个叫做通信顺序进程(Communicating Sequential Processes, <a href="http://www.usingcsp.com">CSP</a>). CSP是一个消息传递模型, 通过在goroutine之前传递数据来传递消息, 不需要通过加锁实现同步访问. 用于在goroutine间传递消息的数据结构叫做通道(channel).</p>

<h3 id="并发与并行">并发与并行</h3>

<p>操作系统的线程(thread)和进程(process).</p>

<p>进程类似应用程序在运行中需要用到和维护的各种资源的容器.
资源包括但不限于: 内存(来自文件系统的代码和数据), 句柄(文件, 设备, 操作系统), 线程.</p>
  
  <div class="read-more-link">
    <a href="./go-in-action-three/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/go-in-action-two/">Go In Action 读书笔记 二</a>
  </h1>
  <time datetime="2018-01-01T12:28:04Z" class="post-date">Mon, Jan 1, 2018</time>
  <h2 id="go语言的类型系统">Go语言的类型系统</h2>

<p>Go语言是静态类型的变成语言. 编译的时候需要确定类型.</p>

<h3 id="用户定义的类型">用户定义的类型</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">user</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">name</span>    <span class="kt">string</span>
    <span class="nx">email</span>   <span class="kt">string</span>
    <span class="nx">ext</span>     <span class="kt">int</span>
    <span class="nx">privileged</span>  <span class="kt">bool</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><strong>使用</strong>
零值和<strong>结构字面量</strong>初始化</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">//引用类型, 各个字段初始化为对应的零值
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">bill</span> <span class="nx">user</span> <span class="err">#</span><span class="p">{</span>  <span class="mi">0</span> <span class="kc">false</span><span class="p">}</span>
<span class="c1">//创建并初始化, 使用结构字面量
</span><span class="c1"></span><span class="nx">lisa</span> <span class="o">:=</span> <span class="nx">user</span><span class="p">{</span> <span class="c1">//{Lisa lisa@email.com 123 true}
</span><span class="c1"></span>    <span class="nx">name</span><span class="p">:</span> <span class="s">&#34;Lisa&#34;</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="s">&#34;lisa@email.com&#34;</span><span class="p">,</span>
    <span class="nx">ext</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
    <span class="nx">privileged</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><strong>结构字面量的赋值方式:</strong>
- 不同行声明每一个字段和对应的值, 字段名和字段以<code>:</code>分隔, 末尾以<code>,</code>结尾
- 不适用字段名, 只声明对应的值. 写在一行里, 以<code>,</code>分隔, 结尾不需要<code>,</code>. <strong>要保证顺序</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">lisa</span> <span class="o">:=</span> <span class="p">{</span><span class="s">&#34;Lisa&#34;</span><span class="p">,</span> <span class="s">&#34;lisa@email.com&#34;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="kc">true</span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
  
  <div class="read-more-link">
    <a href="./go-in-action-two/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/go-in-action-one/">Go In Action 读书笔记 一</a>
  </h1>
  <time datetime="2018-01-01T12:27:10Z" class="post-date">Mon, Jan 1, 2018</time>
  <p><img src="http://7xvxng.com1.z0.glb.clouddn.com/15142714785285.jpg" alt="架构流程图" /></p>

<h2 id="关键字">关键字</h2>

<h3 id="var">var</h3>

<p>变量使用<code>var</code>声明, 如果变量不是定义在任何一个函数作用域内, 这个变量就是包级变量.
&gt; Go语言中, 所有变量都被初始化为其<strong>零值</strong>. 对于数值类型, 其零值是<strong>0</strong>;  对于字符串类型, 其零值是<strong>空字符串&rdquo;&rdquo;</strong>; 对于布尔类型, 其零值是<strong>false</strong>. 对于引用类型来说, 底层数据结构会被初始化对应的零值. 但是被生命被起零值的引用类型的变量, 会返回<strong>nil</strong>作为其值.</p>

<h3 id="const">const</h3>

<p>定义常量</p>

<h3 id="interface">interface</h3>

<p>声明接口</p>

<h3 id="func">func</h3>

<p>声明函数</p>

<h3 id="defer">defer</h3>

<p>安排后面的函数调用在当前函数返回时才执行.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">file</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s">&#34;filePath&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span>
    <span class="k">return</span>
<span class="k">defer</span> <span class="nx">file</span><span class="p">.</span><span class="nb">close</span><span class="p">()</span>
<span class="err">#</span> <span class="nx">more</span> <span class="nx">file</span> <span class="nx">operation</span></code></pre></td></tr></table>
</div>
</div>
  
  <div class="read-more-link">
    <a href="./go-in-action-one/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-godep-issue-in-custom-gopath/">自定义GOPATH下安装godep失败</a>
  </h1>
  <time datetime="2017-12-22T13:02:38Z" class="post-date">Fri, Dec 22, 2017</time>
  我的环境变量是这样的: 1 2 3 4 export GOROOT=/usr/local/go export GOPATH=/Users/addo/Workspaces/go_w export GOBIN=$GOROOT/bin export PATH=$PATH:$GOBIN 使用下面的命令安装报错: go get -v github.com/tools/godep github.com/tools/godep (download) github.com/tools/godep/vendor/github.com/pmezard/go-difflib/difflib github.com/tools/godep/vendor/github.com/kr/fs github.com/tools/godep/vendor/github.com/kr/text github.com/tools/godep/vendor/golang.org/x/tools/go/vcs github.com/tools/godep/vendor/github.com/kr/pretty github.com/tools/godep go install github.com/tools/godep: open /usr/local/go/bin/godep: permission denied 默认是安装到$GOBIN目录下,
  
  <div class="read-more-link">
    <a href="./install-godep-issue-in-custom-gopath/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/glance-over-spring-boot-source/">SpringBoot源码 - 启动</a>
  </h1>
  <time datetime="2017-12-08T17:48:43Z" class="post-date">Fri, Dec 8, 2017</time>
  SpringBoot Application启动部分的源码阅读. SpringApplication 常用的SpringApplication.run(Class, Args)启动Spring应用,
  
  <div class="read-more-link">
    <a href="./glance-over-spring-boot-source/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/java-serval-serializer-benchmark/">Java序列化工具性能对比</a>
  </h1>
  <time datetime="2017-12-02T07:35:43Z" class="post-date">Sat, Dec 2, 2017</time>
  最近在调整系统的性能, 系统中正使用Jackson作为序列化工具. 做了下与fastJson, Avro, ProtoStuff的序列化吞吐对比. 由于只是做
  
  <div class="read-more-link">
    <a href="./java-serval-serializer-benchmark/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-reliable-data-delivery/">Kafka的消息可靠传递</a>
  </h1>
  <time datetime="2017-11-18T14:01:46Z" class="post-date">Sat, Nov 18, 2017</time>
  Kafka提供的基础保障可以用来构建可靠的系统, 却无法保证完全可靠. 需要在可靠性和吞吐之间做取舍. Kafka在分区上提供了消息的顺序保证. 生
  
  <div class="read-more-link">
    <a href="./kafka-reliable-data-delivery/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/spring-cloud-eureka-client-source-code-analysis/">Spring Cloud - Eureka Client源码分析</a>
  </h1>
  <time datetime="2017-10-14T22:04:59Z" class="post-date">Sat, Oct 14, 2017</time>
  准备做个Spring Cloud源码分析系列, 作为Spring Cloud的源码分析笔记. 这一篇是Eureka的客户端. 客户端 两种方式, 最终的实
  
  <div class="read-more-link">
    <a href="./spring-cloud-eureka-client-source-code-analysis/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/learning-raft/">Raft算法学习</a>
  </h1>
  <time datetime="2017-10-14T05:57:34Z" class="post-date">Sat, Oct 14, 2017</time>
  Raft 强一致性算法 名词 复制状态机 复制状态机是通过复制日志来实现的, 按照日志中的命令的顺序来执行这些命令. 相同的状态机执行相同的日志命令, 获得相同
  
  <div class="read-more-link">
    <a href="./learning-raft/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-producer-acknowledge-benchmark/">Kafka发送不同确认方式的性能差异</a>
  </h1>
  <time datetime="2017-10-10T11:49:58Z" class="post-date">Tue, Oct 10, 2017</time>
  背景 Kafka的性能众所周知，Producer支持acknowledge模式。即Kafka会想Producer返回消息发送的结果。但是在Ja
  
  <div class="read-more-link">
    <a href="./kafka-producer-acknowledge-benchmark/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-consumer-consistency/">Kafka消息消费一致性</a>
  </h1>
  <time datetime="2017-09-26T19:13:48Z" class="post-date">Tue, Sep 26, 2017</time>
  Kafka消费端的offset主要由consumer来控制, Kafka降每个consumer所监听的tocpic的partition的off
  
  <div class="read-more-link">
    <a href="./kafka-consumer-consistency/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-exactly-once-delivery-and-transactional-messaging-example/">Kafka 恰好一次发送和事务消费示例</a>
  </h1>
  <time datetime="2017-09-22T18:03:43Z" class="post-date">Fri, Sep 22, 2017</time>
  核心思想 生产端一致性: 开启幂等和事务, 包含重试, 发送确认, 同一个连接的最大未确认请求数. 消费端一致性: 通过设置读已提交的数据和同时处理完成每
  
  <div class="read-more-link">
    <a href="./kafka-exactly-once-delivery-and-transactional-messaging-example/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-exactly-once-delivery-and-transactional-messaging/">恰好一次发送和事务消息(译)</a>
  </h1>
  <time datetime="2017-09-19T19:13:26Z" class="post-date">Tue, Sep 19, 2017</time>
  Kafka提供“至少一次”交付语义, 这意味着发送的消息可以传送一次或多次. 人们真正想要的是“一次”语义,因为重复的消息没有被传递。 普遍地发声
  
  <div class="read-more-link">
    <a href="./kafka-exactly-once-delivery-and-transactional-messaging/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-producer-config/">Kafka Producer配置解读</a>
  </h1>
  <time datetime="2017-09-19T15:38:03Z" class="post-date">Tue, Sep 19, 2017</time>
  按照重要性分类, 基于版本0.11.0.0 高 bootstrap.servers 一组host和port用于初始化连接. 不管这里配置了多少台server, 都只是用作发现整个集群全
  
  <div class="read-more-link">
    <a href="./kafka-producer-config/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/json-patch/">JSON Patch</a>
  </h1>
  <time datetime="2017-08-27T14:41:44Z" class="post-date">Sun, Aug 27, 2017</time>
  JSON Path是在使用Kubernetes API的过程中首次使用的. 使用API做扩缩容的时候, 发送整个Deployment的全文不是个明智的做法
  
  <div class="read-more-link">
    <a href="./json-patch/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/how-to-use-hostpath-in-openshift/">如何在Openshift中使用hostPath</a>
  </h1>
  <time datetime="2017-08-23T19:29:51Z" class="post-date">Wed, Aug 23, 2017</time>
  使用openshift搭建的k8s的api创建Deployment，在启动的时候报下面的错误： Invalid value: &ldquo;hostPath&rdquo;: hostPath volumes are not allowed to be used] 解决方案： 一个方案是将u
  
  <div class="read-more-link">
    <a href="./how-to-use-hostpath-in-openshift/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kubernetes-persistent-volumes/">Kubernetes — 持久卷</a>
  </h1>
  <time datetime="2017-08-20T22:25:40Z" class="post-date">Sun, Aug 20, 2017</time>
  Persistent Volume 译自Persistent Volumes 介绍 管理存储是管理计算的独特问题。 PersistentVolume子系统为用户和管理员提供了一个API，其中提
  
  <div class="read-more-link">
    <a href="./kubernetes-persistent-volumes/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-kubernetes-on-macos/">Kubernetes学习 — Macos安装Kubernetes</a>
  </h1>
  <time datetime="2017-08-17T09:44:17Z" class="post-date">Thu, Aug 17, 2017</time>
  Kubernetes 安装 macos 检查环境 1 sysctl -a | grep machdep.cpu.features | grep VMX 安装VirtualBox 1 http://download.virtualbox.org/virtualbox/5.1.26/Oracle_VM_VirtualBox_Extension_Pack-5.1.26-117224.vbox-extpack 安装minikube 1 curl -Lo minikube https://storage.googleapis.com/minikube/releases/v0.21.0/minikube-darwin-amd64 &amp;&amp; chmod +x minikube &amp;&amp; sudo mv minikube /usr/local/bin/ 创建集群 默认使用virtual
  
  <div class="read-more-link">
    <a href="./install-kubernetes-on-macos/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/stop-a-thread-of-executor-service/">暴力停止ExecutorService的线程</a>
  </h1>
  <time datetime="2017-07-19T22:25:19Z" class="post-date">Wed, Jul 19, 2017</time>
  停止，stop，这里说的是真的停止。如何优雅的结束，这里就不提了。 这里要用Thread.stop()。众所周知，stop()方法在JDK中是
  
  <div class="read-more-link">
    <a href="./stop-a-thread-of-executor-service/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/private-constructor-capture-idiom/">私有构造函数捕获模式</a>
  </h1>
  <time datetime="2017-05-24T06:50:44Z" class="post-date">Wed, May 24, 2017</time>
  《Java并发编程实践》的注解中有提到这一概念。 The private constructor exists to avoid the race condition that would occur if the copy constructor were implemented as this (p.x, p.y); this is an example of the private constructor capture idiom (Bloch and Gafter, 2005). 结合原文代码： 1 2 3
  
  <div class="read-more-link">
    <a href="./private-constructor-capture-idiom/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/java-operate-cassandra-deployed-in-docker/">Docker快速构建Cassandra和Java操作</a>
  </h1>
  <time datetime="2017-05-18T23:33:24Z" class="post-date">Thu, May 18, 2017</time>
  搭建Cassandra 使用docker创建Cassandra，方便快捷 1 2 3 docker pull cassandra:latest docker run -d --name cassandra -p 9042:9042 cassandra docker exec -it cassandra bash 创建keyspace、table
  
  <div class="read-more-link">
    <a href="./java-operate-cassandra-deployed-in-docker/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/run-spring-boot-app-in-docker/">从零开始用docker运行spring boot应用</a>
  </h1>
  <time datetime="2017-04-20T21:58:42Z" class="post-date">Thu, Apr 20, 2017</time>
  假设已经安装好Docker Springboot应用 pom添加依赖和构建插件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;1.5.3.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt;
  
  <div class="read-more-link">
    <a href="./run-spring-boot-app-in-docker/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/jasig-cas-web-and-proxy-flow/">Jasig CAS Web and Proxy flow</a>
  </h1>
  <time datetime="2017-04-18T10:36:16Z" class="post-date">Tue, Apr 18, 2017</time>
  最近因为需求在看CAS相关的只是，由于需要后端调用，用到proxy（代理）模式。整理了下web flow和proxy web flow的流程。 Web Flow Proxy Web
  
  <div class="read-more-link">
    <a href="./jasig-cas-web-and-proxy-flow/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/java8-metaspace-size-issue/">MetaspaceSize的坑</a>
  </h1>
  <time datetime="2017-04-13T11:55:14Z" class="post-date">Thu, Apr 13, 2017</time>
  这几天生产上有台机器的Metaspace一直在告警，Metaspace使用达到了97%。使用-XX:MetaspaceSize=512m，告
  
  <div class="read-more-link">
    <a href="./java8-metaspace-size-issue/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/one-tomcat-class-load-issue/">一个Tomcat类加载问题</a>
  </h1>
  <time datetime="2017-04-12T10:40:01Z" class="post-date">Wed, Apr 12, 2017</time>
  背景 一个Tomcat实例中运行了三个应用，其中一个对接了Apereo的CAS系统。现在要求另外两个系统也对接CAS系统，问题就出现了： 应用启
  
  <div class="read-more-link">
    <a href="./one-tomcat-class-load-issue/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/call-high-order-function-in-function-literal/">Scala笔记：用函数字面量块调用高阶函数</a>
  </h1>
  <time datetime="2017-04-11T10:15:15Z" class="post-date">Tue, Apr 11, 2017</time>
  这里会用到几个概念高阶函数、函数字面量、参数组 高阶函数 high-order function 函数的一种，简单来说它包含了一个函数类型的参数或者返回值。 所谓的高阶是跟一阶函数相
  
  <div class="read-more-link">
    <a href="./call-high-order-function-in-function-literal/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/greenplum-jdbc-and-c3p0-datasource/">GreenPlum JDBC和C3P0数据源</a>
  </h1>
  <time datetime="2017-04-10T08:29:00Z" class="post-date">Mon, Apr 10, 2017</time>
  在网上搜索GreenPlum（GPDB）的数据源配置的时候，发现搜索结果都是用postgresql的配置。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17
  
  <div class="read-more-link">
    <a href="./greenplum-jdbc-and-c3p0-datasource/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/def-vs-val-in-scala/">Scala笔记：def VS val</a>
  </h1>
  <time datetime="2017-04-09T08:24:40Z" class="post-date">Sun, Apr 9, 2017</time>
  先说原理： val修饰的在定义的时候执行 def修饰的在调用的时候执行 直观的例子： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 //注释
  
  <div class="read-more-link">
    <a href="./def-vs-val-in-scala/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-redis-on-centos/">Centos编译安装Redis</a>
  </h1>
  <time datetime="2017-04-07T16:48:46Z" class="post-date">Fri, Apr 7, 2017</time>
  版本 Centos7 Redis3.2.8 编译安装 1 2 3 4 5 wget http://download.redis.io/releases/redis-3.2.8.tar.gz tar -zxvf redis-3.2.8.tar.gz cd redis-3.2.8 sudo make test sudo make install 启动 1 redis-server 问题 /bin/sh: cc: command not found 原因：Centos安装时选择的类型是Infrastructure，
  
  <div class="read-more-link">
    <a href="./install-redis-on-centos/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/install-postgresql-on-centos/">Centos上安装Postgresql</a>
  </h1>
  <time datetime="2017-04-06T22:54:17Z" class="post-date">Thu, Apr 6, 2017</time>
  版本 Centos7 Postgresql9.2 Enable ssh service sshd start Open firewall for 22 firewall-cmd —state firewall-cmd —list-all firewall-cmd —permanent —zone=public —add-port=22/tcp firewall-cmd
  
  <div class="read-more-link">
    <a href="./install-postgresql-on-centos/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/redis-performance-key-length/">Key长度对Redis性能影响</a>
  </h1>
  <time datetime="2017-03-16T10:37:03Z" class="post-date">Thu, Mar 16, 2017</time>
  最近Redis的使用中用的到key可能比较长，但是Redis的官方文档没提到key长度对性能的影响，故简单做了个测试。 环境 Redis和测试程
  
  <div class="read-more-link">
    <a href="./redis-performance-key-length/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/remove-element-while-looping-collection/">遍历Collection时删除元素</a>
  </h1>
  <time datetime="2017-03-05T22:04:58Z" class="post-date">Sun, Mar 5, 2017</time>
  其实标题我想用《为什么foreach边循环边移除元素要用Iterator？》可是太长。 不用Iterator，用Collection.remo
  
  <div class="read-more-link">
    <a href="./remove-element-while-looping-collection/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/deep-in-java-volatile-keywork/">Java Volatile关键字</a>
  </h1>
  <time datetime="2017-03-02T08:30:29Z" class="post-date">Thu, Mar 2, 2017</time>
  volatile通过保证对变量的读或写都是直接从内存中读取或直接写入内存中，保证了可见性；但是volatile并不足以保证线程安全，因为无法
  
  <div class="read-more-link">
    <a href="./deep-in-java-volatile-keywork/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/haproxy-multi-host-with-ssl/">Haproxy虚拟主机SSL</a>
  </h1>
  <time datetime="2017-02-27T19:31:53Z" class="post-date">Mon, Feb 27, 2017</time>
  Haproxy为多个域名配置SSL 生成自签名证书 1 2 3 4 5 6 sudo mkdir /etc/ssl/atbug.com sudo openssl genrsa -out /etc/ssl/atbug.com/atbug.com.key 1024 sudo openssl req -new -key /etc/ssl/atbug.com/atbug.com.key -out /etc/ssl/atbug.com/atbug.com.csr sudo openssl x509 -req -days 365 -in /etc/ssl/atbug.com/atbug.com.csr -singkey /etc/ssl/atbug.com/atbug.com.key -out /etc/ssl/atbug.com/atbug.com.crt sudo openssl x509 -req -days 365 -in /etc/ssl/atbug.com/atbug.com.csr -signkey /etc/ssl/atbug.com/atbug.com.key -out
  
  <div class="read-more-link">
    <a href="./haproxy-multi-host-with-ssl/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/duplicate-resultmap-in-mybatis-mapper/">mybatis报错“Result Maps collection already contains value for ***”</a>
  </h1>
  <time datetime="2017-02-22T14:12:18Z" class="post-date">Wed, Feb 22, 2017</time>
  这是工作中遇到的一个问题：测试环境部署出错，报了下面的问题。 1 2 3 4 5 6 7 8 9 10 Caused by: java.lang.IllegalArgumentException: Result Maps collection already contains value for xxx.xxx.xxxRepository.BaseResultMap at org.apache.ibatis.session.Configuration$StrictMap.put(Configuration.java:802) at org.apache.ibatis.session.Configuration$StrictMap.put(Configuration.java:774) at org.apache.ibatis.session.Configuration.addResultMap(Configuration.java:556) at org.apache.ibatis.builder.MapperBuilderAssistant.addResultMap(MapperBuilderAssistant.java:217) at org.apache.ibatis.builder.ResultMapResolver.resolve(ResultMapResolver.java:47) at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:285) at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:252) at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElements(XMLMapperBuilder.java:244) at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:116) 检
  
  <div class="read-more-link">
    <a href="./duplicate-resultmap-in-mybatis-mapper/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/offset-be-reset-when-consuming/">消费时offset被重置导致重复消费</a>
  </h1>
  <time datetime="2017-02-20T13:23:49Z" class="post-date">Mon, Feb 20, 2017</time>
  这是实际使用时遇到的问题：kafka api的版本是0.10，发现有重复消费问题；检查log后发现在commit offset的时候发生超时。 1
  
  <div class="read-more-link">
    <a href="./offset-be-reset-when-consuming/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/threadpoolexecutor-sourcecode-analysis/">TheadPoolExecutor源码分析</a>
  </h1>
  <time datetime="2017-02-20T09:56:07Z" class="post-date">Mon, Feb 20, 2017</time>
  TheadPoolExecutor源码分析 ThreadPoolExecutor是多线程中经常用到的类，其使用一个线程池执行提交的任务。 实现 没
  
  <div class="read-more-link">
    <a href="./threadpoolexecutor-sourcecode-analysis/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/kafka-java-producer-model/">Kafka Java生产者模型</a>
  </h1>
  <time datetime="2017-01-04T16:33:02Z" class="post-date">Wed, Jan 4, 2017</time>
  Producer初始化 初始化KafkaProducer实例，同时通过Config数据初始化MetaData、NetWorkClient、Ac
  
  <div class="read-more-link">
    <a href="./kafka-java-producer-model/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/clean-speicified-keys-in-redis/">Redis清理缓存</a>
  </h1>
  <time datetime="2016-12-13T16:54:41Z" class="post-date">Tue, Dec 13, 2016</time>
  最近有个需求需要主动的去清理部分缓存，考虑的原子性的问题，用Lua脚本进行实现。 Lua脚本 1 2 3 4 5 6 7 local count = 0 for _,k in ipairs(redis.call(&#39;KEYS&#39;, ARGV[1])) do redis.call(&#39;DEL&#39;, k) count = count + 1 end
  
  <div class="read-more-link">
    <a href="./clean-speicified-keys-in-redis/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/flume-filechannel-overview/">Flume - FileChannel （一）</a>
  </h1>
  <time datetime="2016-11-23T09:23:57Z" class="post-date">Wed, Nov 23, 2016</time>
  概述 当使用Flume的时候，每个流程都包含了输入源、通道和输出。一个典型的例子是一个web服务器将事件通过RPC（搬入AvroSource）
  
  <div class="read-more-link">
    <a href="./flume-filechannel-overview/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/deep-in-rabbitmq-java-client/">探索Rabbitmq的Java客户端</a>
  </h1>
  <time datetime="2016-10-09T09:20:07Z" class="post-date">Sun, Oct 9, 2016</time>
  AMQPConnection 实例初始化 创建Connection时会通过FrameHandlerFacotry创建一个SocketFrameHandler，Socket
  
  <div class="read-more-link">
    <a href="./deep-in-rabbitmq-java-client/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/crlf-in-git/">Git回车换行</a>
  </h1>
  <time datetime="2016-09-14T09:16:10Z" class="post-date">Wed, Sep 14, 2016</time>
  最近又个项目，checkout之后，没做任何改动前git status发现已经有modified了，通过git diff发现有两种改动： - warning: CRLF will
  
  <div class="read-more-link">
    <a href="./crlf-in-git/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/deep-in-implementation-of-hashset/">深入剖析HashSet和HashMap实现</a>
  </h1>
  <time datetime="2016-07-11T14:57:16Z" class="post-date">Mon, Jul 11, 2016</time>
  HashSet是一个包含非重复元素的集合，如何实现的，要从底层实现代码看起。 背景 首先非重复元素如何定义，看Set的描述： More formally, sets contain no pair of elements e1 and
  
  <div class="read-more-link">
    <a href="./deep-in-implementation-of-hashset/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/singleton-in-multi-threads-programming/">多线程下的单例模式&#43;反汇编</a>
  </h1>
  <time datetime="2016-07-06T16:57:09Z" class="post-date">Wed, Jul 6, 2016</time>
  多线程下的单例模式的实现，顺便做了反汇编。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public class MySingleton { private static MySingleton INSTANCE; private MySingleton() { } public static MySingleton getInstance() { if (INSTANCE == null) { synchronized (MySingleton.class) { INSTANCE = new MySingleton(); } } return INSTANCE; }
  
  <div class="read-more-link">
    <a href="./singleton-in-multi-threads-programming/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/use-kryo-in-spring-amqp-serialization/">使用Kryo替换spring amqp的Java序列化</a>
  </h1>
  <time datetime="2016-06-29T05:29:14Z" class="post-date">Wed, Jun 29, 2016</time>
  spring amqp的原生并没有对Kryo加以支持，Kryo的优点就不多说了。 git地址：https://github.com/addozhang/s
  
  <div class="read-more-link">
    <a href="./use-kryo-in-spring-amqp-serialization/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/rabbitmq-delay-queue-implementation/">Rabbitmq延迟队列实现</a>
  </h1>
  <time datetime="2016-03-30T14:27:02Z" class="post-date">Wed, Mar 30, 2016</time>
  工作中很多场景需要用到定时任务、延迟任务，常用的方法用crontab job、Spring的Quartz，然后扫描整张数据库表，判断哪些数据需
  
  <div class="read-more-link">
    <a href="./rabbitmq-delay-queue-implementation/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/about-slf4j/">关于SLF4J</a>
  </h1>
  <time datetime="2015-04-18T11:16:26Z" class="post-date">Sat, Apr 18, 2015</time>
  Spring的功能越来越强大，同时也越来越臃肿。比如想快速搭建一个基于Spring的项目，解决依赖问题非常耗时。Spring的项目模板的出现
  
  <div class="read-more-link">
    <a href="./about-slf4j/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://atbug.com/chrome-extensions-for-daily-work/">日常工作中使用的chrome插件</a>
  </h1>
  <time datetime="2014-02-09T09:26:50Z" class="post-date">Sun, Feb 9, 2014</time>
  先说下背景，Java程序猿一枚，兼做hybrid app。所以日常工作中免不了要跟浏览器打交道，一般就只用chrome了，看中它的调试功能和庞
  
  <div class="read-more-link">
    <a href="./chrome-extensions-for-daily-work/">Read More…</a>
  </div>
  
</article>
</div>
    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-47966140-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </body>
</html>
