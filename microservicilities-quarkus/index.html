<!doctype html><html lang=zh-cn data-figures class=page data-mode=dim><head><title>使用 Quarkus 和 MicroProfile 实现微服务特性 | 乱世浮生</title><meta charset=utf-8><meta name=generator content="Hugo 0.81.0"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=x-ua-compatible content="IE=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-47966140-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-47966140-1')</script><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta name=description content="Quarkus 的文章之前写过三篇了，讲过了 Quarkus 的小而快。 Hello, Quarkus 应&#34;云&#34;而生的 Java 框架 Quarkus：构建本机可执行文件 谁说 Java 不能用来跑 Serverless？ 一直在酝酿写一篇 Quarkus 生态相关的，因为最近一直在忙 Meetup …"><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta name=twitter:title content="使用 Quarkus 和 MicroProfile 实现微服务特性"><meta property="og:url" content="https://atbug.com/microservicilities-quarkus/"><meta property="og:title" content="使用 Quarkus 和 MicroProfile 实现微服务特性"><meta property="og:description" content="Quarkus 的文章之前写过三篇了，讲过了 Quarkus 的小而快。 Hello, Quarkus 应&#34;云&#34;而生的 Java 框架 Quarkus：构建本机可执行文件 谁说 Java 不能用来跑 Serverless？ 一直在酝酿写一篇 Quarkus 生态相关的，因为最近一直在忙 Meetup …"><meta property="og:image" content="https://atbug.com/images/quarkus.png"><link rel=apple-touch-icon sizes=180x180 href=https://atbug.com/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://atbug.com/icons/favicon-32x32.png><link rel=manifest href=https://atbug.com/icons/site.webmanifest><link rel=canonical href=https://atbug.com/microservicilities-quarkus/><link rel=preload href=https://atbug.com/css/styles.f447efe4c4b72136d91de28493ae7ef4ecc0c35f80359801224320ede7871c488414b1dfba5913dffd7a1ed5f70440802a87e8795f124086b949e35e6579b5d9.css integrity="sha512-9Efv5MS3ITbZHeKEk65+9OzAw1+ANZgBIkMg7eeHHEiEFLHfulkT3/16HtX3BECAKofoeV8SQIa5SeNeZXm12Q==" as=style crossorigin=anonymous><link rel=preload href=https://atbug.com/js/bundle.min.90cbe84f27859868a1c2f20af76ac2cc69c32540555dbbdae845870af41ba688e06385e7e720680cc34e65b9fdd5381585b444e33c735f35d05e6c5dc7d7bdc0.js as=script integrity="sha512-kMvoTyeFmGihwvIK92rCzGnDJUBVXbva6EWHCvQbpojgY4Xn5yBoDMNOZbn91TgVhbRE4zxzXzXQXmxdx9e9wA==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://atbug.com/css/styles.f447efe4c4b72136d91de28493ae7ef4ecc0c35f80359801224320ede7871c488414b1dfba5913dffd7a1ed5f70440802a87e8795f124086b949e35e6579b5d9.css integrity="sha512-9Efv5MS3ITbZHeKEk65+9OzAw1+ANZgBIkMg7eeHHEiEFLHfulkT3/16HtX3BECAKofoeV8SQIa5SeNeZXm12Q==" crossorigin=anonymous></head><body data-code=100 data-lines=true id=documentTop><header class=nav_header><nav class=nav><a href=https://atbug.com/ class="nav_brand nav_item" title=乱世浮生><img src=https://atbug.com/logo.png class=logo alt=乱世浮生><div class=nav_close><div><svg class="icon"><use xlink:href="#open-menu"/></svg><svg class="icon"><use xlink:href="#closeme"/></svg></div></div></a><div class="nav_body nav_body_left"><div class=nav_parent><a href=https://atbug.com/ class=nav_item title=Home>Home</a></div><div class=nav_parent><a href=https://atbug.com/post/ class=nav_item title=Archives>Archives</a></div><div class=nav_parent><a href=https://atbug.com/about/ class=nav_item title=About>About</a></div><div class=follow><a href=https://github.com/addozhang><svg class="icon"><use xlink:href="#github"/></svg></a><a href=https://twitter.com/duwasai><svg class="icon"><use xlink:href="#twitter"/></svg></a><a href=https://atbug.com/index.xml><svg class="icon"><use xlink:href="#rss"/></svg></a><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title>使用 Quarkus 和 MicroProfile 实现微服务特性</h1><div class=post_meta><span><svg class="icon"><use xlink:href="#calendar"/></svg></span><span class=post_date>May 26, 2021</span>
<span class=post_time>· 14 min read&nbsp;</span>
<span>·
<a href=https://atbug.com/tags/quarkus title=Quarkus class="post_tag button button_translucent">Quarkus</a> ·
<a href=https://atbug.com/tags/%E6%9E%B6%E6%9E%84 title=架构 class="post_tag button button_translucent">架构</a> ·
<a href=https://atbug.com/tags/%E7%BF%BB%E8%AF%91 title=翻译 class="post_tag button button_translucent">翻译</a></span>
<span class=page_only>·</span></div><p>Quarkus 的文章之前写过三篇了，讲过了 Quarkus 的小而快。</p><ul><li><a href=https://mp.weixin.qq.com/s/YcEqFm3oxlsEvJ3ckRbQyA>Hello, Quarkus</a></li><li><a href=https://mp.weixin.qq.com/s/Dq3hQrXE4XWH-MyjBAGMEw>应"云"而生的 Java 框架 Quarkus：构建本机可执行文件</a></li><li><a href=https://mp.weixin.qq.com/s/1eqjYC36O3qm1XDw84aAPA>谁说 Java 不能用来跑 Serverless？</a></li></ul><p>一直在酝酿写一篇 Quarkus 生态相关的，因为最近一直在忙 Meetup 的事情而搁浅。正好看到了这篇文章，就拿来翻译一下，补全云原生中的“微服务”这一块。</p><p>本文译自<a href=https://www.infoq.com/articles/microservicilities-quarkus>《Implementing Microservicilities with Quarkus and MicroProfile》</a> 。</p><hr><h2 id=为什么要使用微服务特性>为什么要使用微服务特性？</h2><p>在微服务架构中，一个应用程序是由几个相互连接的服务组成的，这些服务一起工作来实现所需的业务功能。</p><p>因此，典型的企业微服务架构如下所示：</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855266680.jpg alt></p><p>刚开始，使用微服务架构实现应用程序看起来很容易。</p><p>但是，因为有了单体架构没有一些新的挑战，因此做起来并不容器</p><p>举几个例子，比如容错、服务发现、扩展性、日志记录和跟踪。</p><p>为了解决这些挑战，每个微服务都应实现我们在 Red Hat 所说的“微服务特性”。</p><ul><li><input disabled type=checkbox> 该术语是指除业务逻辑以外，服务还必须实现来解决的跨领域关注点清单，如下图所示：</li></ul><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855419604.jpg alt></p><p>可以用任何语言（Java、Go、JavaScript）或任何框架（Spring Boot、Quarkus）实现业务逻辑，但是围绕业务逻辑，应实现以下关注点：</p><p><strong>API</strong>：可通过一组定义的 API 操作来访问该服务。例如，对于 RESTful Web API，HTTP 用作协议。此外，可以使用诸如 Swagger 之类的工具来记录 API 。
<strong>服务发现（Discovery）</strong>：服务需要发现其他服务。</p><p><strong>调用服务（Invocation）</strong>：发现服务后，需要使用一组参数对其进行调用，并选择性地返回响应。</p><p><strong>弹性（Elasticity）</strong>：微服务架构的重要特征之一是每个服务都是弹性的，这意味着可以根据系统的关键程度或当前的工作量等参数独立地进行缩放。（译者注：这里的弹性只是资源的弹性）</p><p><strong>弹性（Resiliency）</strong>：在微服务架构中，我们在开发时应牢记失败，尤其是在与其他服务进行通信时。在单体应用中，整个应用程序处于启动或关闭状态。但是，当此应用程序分解为微服务体系结构时，该应用程序由多个服务组成，并且所有这些服务都通过网络互连，这意味着该应用程序的某些部分可能正在运行，而其他部分可能会失败。遏制故障对避免通过其他服务传播错误很重要。弹性（或应用程序弹性）是应用程序/服务对问题做出反应并仍然提供最佳结果的能力。（译者注：这里的弹性与容错相关，对失败处理的弹性）</p><p><strong>管道（Pipeline）</strong>：服务应独立部署，而无需进行任何形式的编排。因此，每个服务应具有自己的部署管道。</p><p><strong>身份验证（Authentication）</strong>：关于微服务体系结构中的安全性的关键方面之一是如何对内部服务之间的调用进行身份验证/授权。Web 令牌（通常是令牌）是在内部服务中安全地表示声明的首选方式。</p><p><strong>日志记录（Logging）</strong>：在单体应用程序中，日志记录很简单，因为该应用程序的所有组件都在同一节点上运行。然后现在组件以服务的形式分布在多个节点上，因此，要拥有完整的日志记录视图，需要一个统一的日志记录系统/数据收集器。</p><p><strong>监控（Monitoring）</strong>：衡量系统的性能、了解应用程序的整体运行状况，以及在出现问题时发出警报是保持基于微服务的应用程序正确运行的关键方面。监控是控制应用程序的关键方面。</p><p><strong>跟踪（Tracing）</strong>：跟踪用于可视化程序的流程和数据进度。作为开发人员/运维人员，当我们需要检查用户在整个应用程序中的行程时，这特别有用。</p><p>Kubernetes正在成为部署微服务的实际工具。这是一个用于自动化、编排、扩展和管理容器的开源系统。</p><p>使用 Kubernetes 时，十个微服务特性中只有三个被涵盖。</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855537970.jpg alt></p><p>**服务发现 **是通过 <em>Kubernetes 服务</em>的概念实现的。它提供了一种使用稳定的虚拟 IP 和 DNS 名称将 Kubernetes Pod 分组（作为一个整体）的方法。发现服务只是使用 Kubernetes 的服务名作为 hostname 进行请求。</p><p>使用 Kubernetes 可以很容易地<strong>调用服务</strong>，因为平台本身提供了调用任何服务所需的网络。</p><p>从一开始，Kubernetes 就一直在考虑<strong>弹性</strong>（或可伸缩性），例如运行时<code>kubectl scale deployment myservice --replicas=5 command</code>，myservice deployment 可伸缩至五个副本或实例。Kubernetes 平台负责寻找合适的节点，部署服务并始终保持所需数量的副本并正常运行。</p><p>但是其余的微服务特性又如何呢？Kubernetes 仅涵盖其中的三个，那么我们如何实现剩下的呢？</p><p>根据所使用的语言或框架，可以遵循的策略很多。但是在本文中，我们将了解如何使用 <a href=https://quarkus.io/>Quarkus</a> 实现其中的一些<a href=https://quarkus.io/>策略</a>。</p><h2 id=什么是-quarkus>什么是 Quarkus？</h2><p><a href=https://quarkus.io/>Quarkus</a> 是针对 Java 虚拟机（JVM）和本机编译的全栈 Kubernetes 本地 Java 框架，专门针对容器优化 Java，使其成为无服务器（Serverless）、云和 Kubernetes 环境的高效平台。</p><p>Instead of reinventing the wheel, Quarkus uses well-known enterprise-grade frameworks backed by standards/specifications and makes them compilable to a binary using <a href=https://www.graalvm.org/>GraalVM</a>.
Quarkus不用重新发明轮子，而是使用以标准/规范为后盾的知名企业级框架，并使用 <a href=https://www.graalvm.org/>GraalVM</a> 将其编译为二进制<a href=https://www.graalvm.org/>文件</a>。</p><h2 id=什么是-microprofile>什么是 MicroProfile？</h2><p>Quarkus 与 <a href=https://microprofile.io/>MicroProfile</a> 规范集成，从而将企业 Java 生态系统迁移到微服务体系结构中。</p><p>在下图中，我们看到了构成 MicroProfile 规范的所有 API。某些 API（例如 CDI、JSON-P 和 JAX-RS）基于 <a href=https://jakarta.ee/>Jakarta EE</a>（以前的 Java EE）规范。其余的由 Java 社区开发。</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855657899.jpg alt></p><p>Let’s implement API, invocation, resilience, authentication, logging, monitoring, and tracing microservicilities using Quarkus.
让我们使用Quarkus实现API、调用、弹性、身份验证、日志记录、监视和跟踪微服务特性。</p><h2 id=如何使用-quarkus-实现微服务特性>如何使用 Quarkus 实现微服务特性</h2><h3 id=入门>入门</h3><p>开始使用 Quarkus 的最快方法是通过在<a href=https://code.quarkus.io/>开始页面</a>中选择所需的依赖。对于当前示例，选择如下依赖关系以满足微服务需求：</p><p>API：RESTEasy JAX-RS、RESTEasy JSON-B、OpenAPI
调用：REST Client JSON-B
弹性：Fault Tolerance
认证：JWT
记录：GELF
监控：Micrometer metrics
跟踪：OpenTracing</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855795760.jpg alt></p><p>我们可以手动选择各自的依赖关系，或浏览以下链接 <a href="https://code.quarkus.io/?a=microservicilities-quarkus&e=resteasy&e=resteasy-jsonb&e=rest-client-jsonb&e=smallrye-jwt&e=smallrye-openapi&e=logging-gelf&e=smallrye-fault-tolerance&e=micrometer&e=smallrye-opentracing">Quarkus 微服务特性生成器</a>，所有这些都会被选中。然后按“生成应用程序”按钮以下载包含支架应用程序的zip文件。</p><h3 id=服务>服务</h3><p>对于当前示例，仅使用两个服务生成了一个非常简单的应用程序。一个名为“<em>评级服务 rating service</em>”的服务返回给定书籍的评级，而另一个名为“<em>书籍服务 book service</em>”的服务则返回一本书的信息及其评级。服务之间的所有调用都必须经过身份验证。</p><p>在下图中，我们看到了整个系统的概述：</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219855936882.jpg alt></p><p><em>评级服务</em>已经开发并作为 Linux 容器提供。通过运行以下命令，在端口 9090 上启动服务：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>docker run --rm -ti -p 9090:8080 
quay.io/lordofthejars/rating-service:1.0.0
</code></pre></div><p>要验证服务，请向 http://localhost:9090/rate/1 发出请求</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl localhost:8080/rate/1 -vv

&gt; GET /rate/1 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 <span class=m>401</span> Unauthorized
&lt; www-authenticate: Bearer <span class=o>{</span>token<span class=o>}</span>
&lt; Content-Length: <span class=m>0</span>
</code></pre></div><p>返回的状态码是 <code>401 Unauthorized</code> 因为没有在请求中携带令牌（JWT）提供授权信息。只有带有 <em>group <code>Echoer</code></em> 有效令牌才能访问评级服务。</p><h3 id=api>API</h3><p>Quarkus 使用众所周知的 JAX-RS 规范来定义 RESTful Web API。在幕后，Quarkus 使用 RESTEasy 实现直接与 Vert.X 框架一起使用，而无需使用 Servlet 技术。</p><p>让我们为实现最常见操作的图书服务定义一个 API：</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>javax.ws.rs.Consumes</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.DELETE</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.GET</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.POST</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.Path</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.PathParam</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.Produces</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.QueryParam</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.core.MediaType</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.core.Response</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.core.UriBuilder</span><span class=o>;</span>

<span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/book&#34;</span><span class=o>)</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>BookResource</span> <span class=o>{</span>

   <span class=nd>@GET</span>
   <span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
   <span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
   <span class=kd>public</span> <span class=n>Book</span> <span class=nf>book</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>)</span> <span class=o>{</span>
    <span class=c1>// logic
</span><span class=c1></span>   <span class=o>}</span>

   <span class=nd>@POST</span>
   <span class=nd>@Consumes</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
   <span class=kd>public</span> <span class=n>Response</span> <span class=nf>getBook</span><span class=o>(</span><span class=n>Book</span> <span class=n>book</span><span class=o>)</span> <span class=o>{</span>
       <span class=c1>// logic
</span><span class=c1></span>
       <span class=k>return</span> <span class=n>Response</span><span class=o>.</span><span class=na>created</span><span class=o>(</span>
                   <span class=n>UriBuilder</span><span class=o>.</span><span class=na>fromResource</span><span class=o>(</span><span class=n>BookResource</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
                     <span class=o>.</span><span class=na>path</span><span class=o>(</span><span class=n>Long</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>book</span><span class=o>.</span><span class=na>bookId</span><span class=o>))</span>
                     <span class=o>.</span><span class=na>build</span><span class=o>())</span>
               <span class=o>.</span><span class=na>build</span><span class=o>();</span>
   <span class=o>}</span>

   <span class=nd>@DELETE</span>
   <span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
   <span class=kd>public</span> <span class=n>Response</span> <span class=nf>delete</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>)</span> <span class=o>{</span>
       <span class=c1>// logic
</span><span class=c1></span>
       <span class=k>return</span> <span class=n>Response</span><span class=o>.</span><span class=na>noContent</span><span class=o>().</span><span class=na>build</span><span class=o>();</span>
   <span class=o>}</span>

   <span class=nd>@GET</span>
   <span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
   <span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;search&#34;</span><span class=o>)</span>
   <span class=kd>public</span> <span class=n>Response</span> <span class=nf>searchBook</span><span class=o>(</span><span class=nd>@QueryParam</span><span class=o>(</span><span class=s>&#34;description&#34;</span><span class=o>)</span> <span class=n>String</span> <span class=n>description</span><span class=o>)</span> <span class=o>{</span>       
       <span class=c1>// logic
</span><span class=c1></span>
       <span class=k>return</span> <span class=n>Response</span><span class=o>.</span><span class=na>ok</span><span class=o>(</span><span class=n>books</span><span class=o>).</span><span class=na>build</span><span class=o>();</span>
   <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>首先要注意的是，定义了四个不同的端点：</p><ul><li><code>GET /book/{bookId}</code> 使用 GET HTTP 方法返回带有其评级的图书信息。return 元素会自动解编为 JSON。</li><li><code>POST /book</code> 使用 POST HTTP 方法插入一本书作为正文内容。正文内容会自动从 JSON 编组到 Java 对象。</li><li><code>DELETE /book/{bookId}</code> 使用 DELETE HTTP 方法通过书的 ID 删除书。</li><li><code>GET /book/search?description={description}</code> 按书名搜索书籍。</li></ul><p>注意的第二件事是返回类型，有时是 Java 对象，有时是 Java 实例 <code>javax.ws.rs.core.Response</code>。使用 Java 对象时，会将其从 Java 对象序列化为 <code>@Produces</code> 注解中设置的媒体类型。在此特定服务中，输出为 JSON 文档。通过该 <code>Response</code> 对象，我们可以对返回给调用方的内容进行细粒度的控制。可以设置 HTTP 状态代码、标头或返回给调用方的内容。取决于使用场景，是偏爱一种方法而不是另一种方法。</p><h3 id=调用>调用</h3><p>在定义了用于访问<em>图书服务</em>的 API 之后，是时候开发一段代码来调用<em>评级服务</em>以检索图书的评级了。</p><p>Quarkus 使用 <a href=https://github.com/eclipse/microprofile-rest-client>MicroProfile Rest Client</a> 规范来访问外部（HTTP）服务。它提供了一种类型安全的方法，以通过某些 JAX-RS 2.0 API 通过 HTTP 调用 RESTful 服务，以实现一致性和更易于重用。</p><p>要创建的第一个元素是一个使用 JAX-RS 批注表示远程服务的接口。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>javax.ws.rs.GET</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.Path</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.PathParam</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.Produces</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>javax.ws.rs.core.MediaType</span><span class=o>;</span>

<span class=kn>import</span> <span class=nn>org.eclipse.microprofile.rest.client.inject.RegisterRestClient</span><span class=o>;</span>

<span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/rate&#34;</span><span class=o>)</span>
<span class=nd>@RegisterRestClient</span>
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>RatingService</span> <span class=o>{</span>
 
   <span class=nd>@GET</span>
   <span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
   <span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
   <span class=n>Rate</span> <span class=nf>getRate</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>);</span>

<span class=o>}</span>
</code></pre></div><p>When the getRate() method is called, a remote HTTP call is invoked at /rate/{bookId} replacing the bookId with the value set in the method parameter. It is important to annotate the interface with the @RegisterRestClient annotation.
Then the RatingService interface needs to be injected into BookResource to execute the remote calls.
当 <code>getRate() </code>方法被调用时，远程 HTTP 请求在调用 <code>/rate/{bookId}</code> 替换 <code>bookId</code> 用在该方法中的参数值集合。用 <code>@RegisterRestClient</code> 注解对接口进行注解很重要。</p><p>然后 <code>RatingService</code> 需要将接口注入 <code>BookResource</code> 以执行远程调用。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>org.eclipse.microprofile.rest.client.inject.RestClient</span><span class=o>;</span>

<span class=nd>@RestClient</span>
<span class=n>RatingService</span> <span class=n>ratingService</span><span class=o>;</span>

<span class=nd>@GET</span>
<span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
<span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
<span class=kd>public</span> <span class=n>Book</span> <span class=nf>book</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>)</span> <span class=o>{</span>
    <span class=kd>final</span> <span class=n>Rate</span> <span class=n>rate</span> <span class=o>=</span> <span class=n>ratingService</span><span class=o>.</span><span class=na>getRate</span><span class=o>(</span><span class=n>bookId</span><span class=o>);</span>

    <span class=n>Book</span> <span class=n>book</span> <span class=o>=</span> <span class=n>findBook</span><span class=o>(</span><span class=n>bookId</span><span class=o>);</span>
    <span class=k>return</span> <span class=n>book</span><span class=o>;</span>
<span class=o>}</span>
</code></pre></div><p>The @RestClient annotation injects a proxied instance of the interface, providing the implementation of the client.
The last thing is to configure the service location (the hostname part). In Quarkus, the configuration properties are set in src/main/resources/application.properties file. To configure the location of the service, we need to use the fully qualified name of the Rest Client interface with URL as key, and the location as a value:
该 <code>@RestClient</code> 注解注入界面的代理实例，提供客户端的实现。</p><p>最后一件事是配置服务位置（<em>hostname</em> 部分）。在 Quarkus 中，配置属性在 <code>src/main/resources/application.properties</code> 文件中设置。要配置服务的位置，我们需要使用 Rest Client 接口的标准名称，其中 URL 作为键，而 location 作为值：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>org.acme.RatingService/mp-rest/url=http://localhost:9090
</code></pre></div><p>在正确访问<em>评估服务</em>而没有 <code>401 Unauthorized</code> 问题之前，必须解决相互认证问题。</p><h3 id=身份验证>身份验证</h3><p>基于令牌的身份验证机制允许系统基于安全令牌对身份进行身份验证、授权和验证。Quarkus 与 <a href=https://github.com/eclipse/microprofile-jwt-auth>MicroProfile JWT RBAC 安全</a>规范集成在一起，以使用 JWT 令牌保护服务。</p><p>要使用 MicroProfile JWT RBAC 安全性保护端点，我们只需要使用批注对方法进行 <code>@RolesAllowed</code> 注解。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@GET</span>
<span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
<span class=nd>@RolesAllowed</span><span class=o>(</span><span class=s>&#34;Echoer&#34;</span><span class=o>)</span>
<span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
<span class=kd>public</span> <span class=n>Book</span> <span class=nf>book</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>)</span>
</code></pre></div><p>然后，我们配置令牌的发行方和公钥的位置，以验证令牌在 <code>application.properties</code> 文件中的签名：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>mp.jwt.verify.publickey.location=https://raw.githubusercontent.com/redhat-developer-demos/quarkus-tutorial/master/jwt-token/quarkus.jwt.pub
mp.jwt.verify.issuer=https://quarkus.io/using-jwt-rbac
</code></pre></div><p>此扩展名自动验证：令牌有效；发行方是正确的；令牌尚未修改；签名有效；没有过期。</p><p>这两种<em>图书服务</em>和<em>评级服务</em>现在是由同一 JWT 发行方和密钥保护，因此服务之间的通信要求验证提供在令牌的有效承载用户 <code>Authentication</code> 头部。</p><p><em>评级服务</em>启动和运行，让我们开始用下面的命令<em>图书服务</em>：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>./mvnw compile quarkus:dev
</code></pre></div><p>Finally, we can make a request to get book information providing a valid JSON Web Token as a bearer token.
The generation of the token is out of the scope of this article, and a token has been already generated:
最后，我们可以请求获取提供有效 JSON Web 令牌作为承载令牌的图书信息。</p><p>令牌的生成不在本文的讨论范围之内，并且已经生成了令牌：</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219856429022.jpg alt></p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>curl -H &#34;Authorization: Bearer eyJraWQiOiJcL3ByaXZhdGVLZXkucGVtIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJqZG9lLXVzaW5nLWp3dC1yYmFjIiwiYXVkIjoidXNpbmctand0LXJiYWMiLCJ1cG4iOiJqZG9lQHF1YXJrdXMuaW8iLCJiaXJ0aGRhdGUiOiIyMDAxLTA3LTEzIiwiYXV0aF90aW1lIjoxNTcwMDk0MTcxLCJpc3MiOiJodHRwczpcL1wvcXVhcmt1cy5pb1wvdXNpbmctand0LXJiYWMiLCJyb2xlTWFwcGluZ3MiOnsiZ3JvdXAyIjoiR3JvdXAyTWFwcGVkUm9sZSIsImdyb3VwMSI6Ikdyb3VwMU1hcHBlZFJvbGUifSwiZ3JvdXBzIjpbIkVjaG9lciIsIlRlc3RlciIsIlN1YnNjcmliZXIiLCJncm91cDIiXSwicHJlZmVycmVkX3VzZXJuYW1lIjoiamRvZSIsImV4cCI6MjIwMDgxNDE3MSwiaWF0IjoxNTcwMDk0MTcxLCJqdGkiOiJhLTEyMyJ9.Hzr41h3_uewy-g2B-sonOiBObtcpkgzqmF4bT3cO58v45AIOiegl7HIx7QgEZHRO4PdUtR34x9W23VJY7NJ545ucpCuKnEV1uRlspJyQevfI-mSRg1bHlMmdDt661-V3KmQES8WX2B2uqirykO5fCeCp3womboilzCq4VtxbmM2qgf6ag8rUNnTCLuCgEoulGwTn0F5lCrom-7dJOTryW1KI0qUWHMMwl4TX5cLmqJLgBzJapzc5_yEfgQZ9qXzvsT8zeOWSKKPLm7LFVt2YihkXa80lWcjewwt61rfQkpmqSzAHL0QIs7CsM9GfnoYc0j9po83-P3GJiBMMFmn-vg&#34; localhost:8080/book/1 -v
</code></pre></div><p>响应又是 forbidden 错误：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>&lt; HTTP/1.1 401 Unauthorized
&lt; Content-Length: 0
</code></pre></div><p>你可能想知道为什么在提供有效令牌后仍然出现此错误。如果我们检查图书服务的控制台，就会发现抛出了以下异常：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>org.jboss.resteasy.client.exception.ResteasyWebApplicationException: Unknown error, status code 401
    at org.jboss.resteasy.client.exception.WebApplicationExceptionWrapper.wrap(WebApplicationExceptionWrapper.java:107)
    at org.jboss.resteasy.microprofile.client.DefaultResponseExceptionMapper.toThrowable(DefaultResponseExceptionMapper.java:21)
</code></pre></div><p>发生此异常的原因是，我们已获得身份验证并有权访问<em>图书服务</em>，但承载令牌尚未传播到<em>评级服务</em>。</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219856618998.jpg alt></p><p>为了自动将 <code>Authorization</code> 标头从传入请求传播到其余客户端请求，需要进行两次修改。</p><p>第一个修改是修改 Rest Client 界面，并使用对其进行注解 <code>org.eclipse.microprofile.rest.client.inject.RegisterClientHeaders</code>。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/rate&#34;</span><span class=o>)</span>
<span class=nd>@RegisterRestClient</span>
<span class=nd>@RegisterClientHeaders</span>
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>RatingService</span> <span class=o>{}</span>
</code></pre></div><p>第二个修改是配置在请求之间传播哪些标头。这是在 <code>application.properties</code> 文件中设置的：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>    org.eclipse.microprofile.rest.client.propagateHeaders=Authorization
</code></pre></div><p>执行与之前相同的 curl 命令，我们将获得正确的输出：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>&lt; HTTP/1.1 <span class=m>200</span> OK
&lt; Content-Length: <span class=m>39</span>
&lt; Content-Type: application/json
&lt;
* Connection <span class=c1>#0 to host localhost left intact</span>
<span class=o>{</span><span class=s2>&#34;bookId&#34;</span>:2,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;Book 2&#34;</span>,<span class=s2>&#34;rating&#34;</span>:1<span class=o>}</span>* Closing connection <span class=m>0</span>
</code></pre></div><h3 id=弹性>弹性</h3><p>在微服务架构中，具有容错能力很重要，这样可以避免故障从一个服务传播到该服务的所有直接和间接调用方。Quarkus 将 <a href=https://github.com/eclipse/microprofile-fault-tolerance>MicroProfile Fault Tolerance</a> 规范与以下用于处理故障的注释集成在一起：</p><p>●    <code>@Timeout</code>：定义抛出异常之前执行的最长时间。
●    <code>@Retry</code>：如果调用失败，请再次重试执行。
●    <code>@Bulkhead</code>：限制并发执行，以使该区域中的故障不会使整个系统过载。
●    <code>@CircuitBreaker</code>：执行反复失败时，将自动进行快速故障切换。
●    <code>@Fallback</code>：执行失败时，提供备用解决方案/默认值。</p><p>让我们添加三次重试，其中重试之间的延迟计时器为一秒，以防访问<em>评级服务</em>时发生错误。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Retry</span><span class=o>(</span><span class=n>maxRetries</span> <span class=o>=</span> <span class=n>3</span><span class=o>,</span> <span class=n>delay</span> <span class=o>=</span> <span class=n>1000</span><span class=o>)</span>
<span class=n>Rate</span> <span class=nf>getRate</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>);</span>
</code></pre></div><p>现在，停止<em>评级服务</em>并执行请求。引发以下异常：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>org.jboss.resteasy.spi.UnhandledException: javax.ws.rs.ProcessingException: RESTEASY004655: Unable to invoke request: 
org.apache.http.conn.HttpHostConnectException: Connect to localhost:9090 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused
</code></pre></div><p>显然，这里存在错误，但是请注意，由于执行了三次重试（延迟一秒），因此引发异常之前，经过了三秒钟。</p><p>在这种情况下，<em>评级服务</em>已关闭，因此无法进行恢复，但是在一个实际示例中，<em>评级服务</em>可能仅在短时间内就恢复了，或者部署了该服务的多个副本，因此可以简单地重试操作可能足以恢复并提供有效的响应。</p><p>但是，当引发异常时重试次数不够时，我们可以将错误传播给调用方，也可以为调用提供替代值。这种选择可以是对另一个系统的调用（即分布式缓存）或静态值。</p><p>对于此用例，当与评级服务的连接失败时，将返回评级值 0。</p><p>要实现回退逻辑，首先要做的是实现将 <code>org.eclipse.microprofile.faulttolerance.FallbackHandler</code> 返回类型设置为与回退策略方法提供的替代类型相同的接口。对于这种情况，将 <code>Rate</code> 返回默认对象。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>org.eclipse.microprofile.faulttolerance.ExecutionContext</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.eclipse.microprofile.faulttolerance.FallbackHandler</span><span class=o>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>RatingServiceFallback</span> <span class=kd>implements</span> <span class=n>FallbackHandler</span><span class=o>&lt;</span><span class=n>Rate</span><span class=o>&gt;</span> <span class=o>{</span>

   <span class=nd>@Override</span>
   <span class=kd>public</span> <span class=n>Rate</span> <span class=nf>handle</span><span class=o>(</span><span class=n>ExecutionContext</span> <span class=n>context</span><span class=o>)</span> <span class=o>{</span>
       <span class=n>Rate</span> <span class=n>rate</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Rate</span><span class=o>();</span>
       <span class=n>rate</span><span class=o>.</span><span class=na>rate</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
       <span class=k>return</span> <span class=n>rate</span><span class=o>;</span>
   <span class=o>}</span>
 
<span class=o>}</span>
</code></pre></div><p>最后要做的是用注解对 <code>getRating()</code> 方法进行 <code>@org.eclipse.microprofile.faulttolerance.Fallback</code> 注解，以配置无法恢复时要执行的回退类。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Retry</span><span class=o>(</span><span class=n>maxRetries</span> <span class=o>=</span> <span class=n>3</span><span class=o>,</span> <span class=n>delay</span> <span class=o>=</span> <span class=n>1000</span><span class=o>)</span>
<span class=nd>@Fallback</span><span class=o>(</span><span class=n>RatingServiceFallback</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
<span class=n>Rate</span> <span class=nf>getRate</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>);</span>
</code></pre></div><p>如果重复与以前相同的请求，则不会引发任何异常，但是有效值的输出将 rating 字段设置为 0。</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>* Connection #0 to host localhost left intact
{&#34;bookId&#34;:2,&#34;name&#34;:&#34;Book 2&#34;,&#34;rating&#34;:0}* Closing connection 0
</code></pre></div><p>规范提供的任何其他策略都可以使用相同的方法。例如，对于断路器模式：</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@CircuitBreaker</span><span class=o>(</span><span class=n>requestVolumeThreshold</span> <span class=o>=</span> <span class=n>4</span><span class=o>,</span>
               <span class=n>failureRatio</span><span class=o>=</span><span class=n>0</span><span class=o>.</span><span class=na>75</span><span class=o>,</span>
               <span class=n>delay</span> <span class=o>=</span> <span class=n>1000</span><span class=o>)</span>
</code></pre></div><p>如果在四个连续调用的滚动窗口中发生了三个（<em>4 x 0.75</em>）故障，则电路将断开 1000 ms，然后恢复到半断开状态。如果在半开时调用成功，则将其再次关闭。否则，它将保持打开状态</p><h3 id=日志记录>日志记录</h3><p>在微服务架构中，建议将所有服务的日志收集在一个统一的日志中，以更有效地使用和理解。</p><p>一种解决方案是使用 <a href=https://www.fluentd.org/>Fluentd</a>，它是 <a href=https://www.fluentd.org/>Kubernetes</a> 中用于统一日志记录层的开源数据收集器。Quarkus 使用 Graylog 扩展日志格式（GELF）与 Fluentd 集成。</p><p>集成真的很简单。首先，与其他任何 Quarkus 应用程序一样使用日志逻辑：</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>org.jboss.logging.Logger</span><span class=o>;</span>

<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Logger</span> <span class=n>LOG</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=na>getLogger</span><span class=o>(</span><span class=n>BookResource</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>

<span class=nd>@GET</span>
<span class=nd>@Path</span><span class=o>(</span><span class=s>&#34;/{bookId}&#34;</span><span class=o>)</span>
<span class=nd>@RolesAllowed</span><span class=o>(</span><span class=s>&#34;Echoer&#34;</span><span class=o>)</span>
<span class=nd>@Produces</span><span class=o>(</span><span class=n>MediaType</span><span class=o>.</span><span class=na>APPLICATION_JSON</span><span class=o>)</span>
<span class=kd>public</span> <span class=n>Book</span> <span class=nf>book</span><span class=o>(</span><span class=nd>@PathParam</span><span class=o>(</span><span class=s>&#34;bookId&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>bookId</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>LOG</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;Get Book&#34;</span><span class=o>);</span>
</code></pre></div><p>接下来，启用 GELF 格式并设置 Fluentd 服务器位置：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>quarkus.log.handler.gelf.enabled=true
quarkus.log.handler.gelf.host=localhost
quarkus.log.handler.gelf.port=12201
</code></pre></div><p>最后，我们可以向记录的端点发出请求：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl -H <span class=s2>&#34;Authorization: Bearer ...&#34;</span> localhost:8080/book/1

<span class=o>{</span><span class=s2>&#34;bookId&#34;</span>:1,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;Book 1&#34;</span>,<span class=s2>&#34;rating&#34;</span>:3<span class=o>}</span>
</code></pre></div><p>输出方面没有任何变化，但是日志行已传输到 Fluentd。如果使用 <a href=https://www.elastic.co/kibana>Kibana</a> 可视化数据，我们将看到存储的日志行：</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219856876241.jpg alt></p><h3 id=监控>监控</h3><p>监控是另一个需要在我们的微服务架构中实现的 “微服务特性”。Quarkus 与 <a href=https://micrometer.io/>Micrometer</a> 集成在一起以进行应用程序监控。Micrometer 提供了最流行的监控系统的单个入口点，使你无需供应商锁定即可检测基于 JVM 的应用程序代码。</p><p>对于此示例，监控输出采用 <a href=https://prometheus.io/>Prometheus</a> 格式，但 Micrometer（和 Quarkus）还支持其他格式，例如 Azure Monitor、Stackdriver、SignalFx、StatsD 和 DataDog。</p><p>你可以注册以下 Maven 依赖项以提供 Prometheus 输出：</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;dependency&gt;</span>
  <span class=nt>&lt;groupId&gt;</span>io.quarkus<span class=nt>&lt;/groupId&gt;</span>
  <span class=nt>&lt;artifactId&gt;</span>quarkus-micrometer-registry-prometheus<span class=nt>&lt;/artifactId&gt;</span>
<span class=nt>&lt;/dependency&gt;</span>
</code></pre></div><p>默认情况下，Micrometer 扩展注册了一些与系统，JVM 或 HTTP 相关的度量。收集的指标的一个子集在 <code>/q/metrics</code> 端点处可用，如下所示：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl localhost:8080/q/metrics

jvm_threads_states_threads<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;runnable&#34;</span>,<span class=o>}</span> 22.0
jvm_threads_states_threads<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;blocked&#34;</span>,<span class=o>}</span> 0.0
jvm_threads_states_threads<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;waiting&#34;</span>,<span class=o>}</span> 10.0
http_server_bytes_read_count 1.0
http_server_bytes_read_sum 0.0
</code></pre></div><p>但是，也可以使用 Micrometer API 来实现特定于应用程序的指标。
让我们实现一个自定义指标，该指标用于衡量评价最高的图书。</p><p>使用 <code>io.micrometer.core.instrument.MeterRegistry</code> 该类可以完成指标（在这种情况下为量规）的注册。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kd>private</span> <span class=kd>final</span> <span class=n>MeterRegistry</span> <span class=n>registry</span><span class=o>;</span>
<span class=kd>private</span> <span class=kd>final</span> <span class=n>LongAccumulator</span> <span class=n>highestRating</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LongAccumulator</span><span class=o>(</span><span class=n>Long</span><span class=o>::</span><span class=n>max</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
 
<span class=kd>public</span> <span class=nf>BookResource</span><span class=o>(</span><span class=n>MeterRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
    <span class=k>this</span><span class=o>.</span><span class=na>registry</span> <span class=o>=</span> <span class=n>registry</span><span class=o>;</span>
    <span class=n>registry</span><span class=o>.</span><span class=na>gauge</span><span class=o>(</span><span class=s>&#34;book.rating.max&#34;</span><span class=o>,</span> <span class=k>this</span><span class=o>,</span>
               <span class=n>BookResource</span><span class=o>::</span><span class=n>highestRatingBook</span><span class=o>);</span>
<span class=o>}</span>
</code></pre></div><p>请求一下，并验证量规是否正确更新。</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl -H <span class=s2>&#34;Authorization: Bearer ...&#34;</span> localhost:8080/book/1

<span class=o>{</span><span class=s2>&#34;bookId&#34;</span>:1,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;Book 1&#34;</span>,<span class=s2>&#34;rating&#34;</span>:3<span class=o>}</span>

curl localhost:8080/q/metrics

<span class=c1># HELP book_rating_max</span>
<span class=c1># TYPE book_rating_max gauge</span>
book_rating_max 3.0
</code></pre></div><p>我们还可以设置一个计时器来记录从<em>评级服务</em>获取评级信息所花费的时间。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Rate</span><span class=o>&gt;</span> <span class=n>rateSupplier</span> <span class=o>=</span> <span class=o>()</span> <span class=o>-&gt;</span> <span class=o>{</span>
      <span class=k>return</span> <span class=n>ratingService</span><span class=o>.</span><span class=na>getRate</span><span class=o>(</span><span class=n>bookId</span><span class=o>);</span>
<span class=o>};</span>
      
<span class=kd>final</span> <span class=n>Rate</span> <span class=n>rate</span> <span class=o>=</span> <span class=n>registry</span><span class=o>.</span><span class=na>timer</span><span class=o>(</span><span class=s>&#34;book.rating.test&#34;</span><span class=o>).</span><span class=na>wrap</span><span class=o>(</span><span class=n>rateSupplier</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</code></pre></div><p>请求一下，并验证收集评价​​所花费的时间。</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># HELP book_rating_test_seconds
# TYPE book_rating_test_seconds summary
book_rating_test_seconds_count 4.0
book_rating_test_seconds_sum 1.05489108
# HELP book_rating_test_seconds_max
# TYPE book_rating_test_seconds_max gauge
book_rating_test_seconds_max 1.018622001
</code></pre></div><p>Micrometer 使用 <code>MeterFilter</code> 实例来自定义 <code>MeterRegistry</code> 实例发出的度量。Micrometer 扩展将检测 <code>MeterFilter</code> CDI bean，并在初始化 <code>MeterRegistry</code> 实例时使用它们。</p><p>例如，我们可以定义一个通用标签来设置运行应用程序的环境（产品、测试、预发布等）。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Singleton</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MicrometerCustomConfiguration</span> <span class=o>{</span>
 
   <span class=nd>@Produces</span>
   <span class=nd>@Singleton</span>
   <span class=kd>public</span> <span class=n>MeterFilter</span> <span class=nf>configureAllRegistries</span><span class=o>()</span> <span class=o>{</span>
       <span class=k>return</span> <span class=n>MeterFilter</span><span class=o>.</span><span class=na>commonTags</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
               <span class=n>Tag</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;env&#34;</span><span class=o>,</span> <span class=s>&#34;prod&#34;</span><span class=o>)));</span>
   <span class=o>}</span>

<span class=o>}</span>
</code></pre></div><p>发送新请求并验证指标是否已标记。</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>http_client_requests_seconds_max{clientName=&#34;localhost&#34;,env=&#34;prod&#34;,method=&#34;GET&#34;,outcome=&#34;SUCCESS&#34;,status=&#34;200&#34;,uri=&#34;/rate/2&#34;,} 0.0
</code></pre></div><p>请注意 <code>env</code> 包含值为 <code>prod</code> 的标签。</p><h3 id=跟踪>跟踪</h3><p>Quarkus 应用程序利用 <a href=https://opentracing.io/>OpenTracing</a> 规范为交互式 Web 应用程序提供分布式跟踪。</p><p>让我们配置 OpenTracing 以连接到 Jaeger 服务器，将 book-service 设置为服务名称以标识跟踪：</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>quarkus.jaeger.enabled=true
quarkus.jaeger.endpoint=http://localhost:14268/api/traces
quarkus.jaeger.service-name=book-service
quarkus.jaeger.sampler-type=const
quarkus.jaeger.sampler-param=1
</code></pre></div><p>现在发一个请求：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>curl -H <span class=s2>&#34;Authorization: Bearer ...&#34;</span> localhost:8080/book/1 <span class=o>{</span><span class=s2>&#34;bookId&#34;</span>:1,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;Book 1&#34;</span>,<span class=s2>&#34;rating&#34;</span>:3<span class=o>}</span>

</code></pre></div><p>访问Jaeger UI以验证是否跟踪了该调用：</p><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219857070960.jpg alt></p><h2 id=总结>总结</h2><p>与开发整体应用程序相比，开发和实现微服务体系结构更具挑战性。我们认为，微服务可以驱动你根据应用程序基础结构正确地开发服务。</p><p>此处介绍的大多数微服务（API 和管道除外）是新的，或者在整体应用中实现方式有所不同。原因是现在应用程序被分解成几部分，所有部分都在网络中互连。</p><p>如果你May 26, 2021打算开发微服务并将其部署到 Kubernetes，那么 Quarkus 是一个很好的解决方案，因为它可以与 Kubernetes 顺利集成。实施大多数微服务很简单，只需要几行代码。</p><p>本文演示的源代码可以在 <a href=https://github.com/lordofthejars/microservicilities-quarkus>github</a> 上找到。</p><h2 id=关于作者>关于作者</h2><p><img src=https://atbug.oss-cn-hangzhou.aliyuncs.com/2021/05/26/16219857200384.jpg alt></p><p>Alex Soto 是 Red Hat 开发人员经验总监。他对 Java 世界，软件自动化充满热情，并且他相信开源软件模型。Soto 是 <a href=https://www.manning.com/books/testing-java-microservices>Manning</a> 的合著者 | <a href=https://www.manning.com/books/testing-java-microservices>测试 Java 微服务</a>和 <a href=https://www.oreilly.com/library/view/quarkus-cookbook/9781492062646/>O&rsquo;Reilly Quarkus Cookbook</a> 和几个开源项目的贡献者。自 2017 年以来一直是 Java 冠军，他还是 Salle URL University 的国际演讲者和老师。你可以在 Twitter （Alex Soto）上关注他，以随时了解 Kubernetes 和 Java 世界中正在发生的事情。</p><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//addozhang.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article><aside class=sidebar><section class=sidebar_inner><h2>张晓辉</h2><div class=sidebar_description><ul><li>资深码农、云原生践行者</li><li>Kubernetes、DevOps、微服务</li></ul><p><img src=../images/wechat_qr.jpg alt></div><a href=https://atbug.com/about/ class="button mt-1" role=button title=阅读更多>阅读更多</a><h2 class=mt-4>最新文章</h2><ul class=flex-column><li><a href=https://atbug.com/tekton-pipeline-practice/ class=nav-link title="云原生 CICD: Tekton Pipeline 实战">云原生 CICD: Tekton Pipeline 实战</a></li><li><a href=https://atbug.com/kubelet-source-code-analysis/ class=nav-link title="源码解析：一文读懂 Kubelet">源码解析：一文读懂 Kubelet</a></li><li><a href=https://atbug.com/programming-archive-metrics-with-pipy/ class=nav-link title="可编程网关 Pipy 第二弹：编程实现 Metrics 及源码解读">可编程网关 Pipy 第二弹：编程实现 Metrics 及源码解读</a></li><li><a href=https://atbug.com/auto-scaling-best-practice-in-kubernetes/ class=nav-link title="Kubernetes 的自动伸缩你用对了吗？">Kubernetes 的自动伸缩你用对了吗？</a></li><li><a href=https://atbug.com/glance-at-programmable-gateway-pipy/ class=nav-link title="初探可编程网关 Pipy">初探可编程网关 Pipy</a></li></ul><div><h2 class="mt-4 taxonomy" id=categories-section>分类</h2><nav class=tags_nav><a href=https://atbug.com/categories/%E7%AC%94%E8%AE%B0/ class="post_tag button button_translucent" title=笔记>笔记
<span class=button_tally>45</span></a>
<a href=https://atbug.com/categories/%E5%AD%A6%E4%B9%A0/ class="post_tag button button_translucent" title=学习>学习
<span class=button_tally>40</span></a>
<a href=https://atbug.com/categories/%E7%BF%BB%E8%AF%91/ class="post_tag button button_translucent" title=翻译>翻译
<span class=button_tally>7</span></a>
<a href=https://atbug.com/categories/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/ class="post_tag button button_translucent" title=源码解析>源码解析
<span class=button_tally>4</span></a>
<a href=https://atbug.com/categories/quickstart/ class="post_tag button button_translucent" title=quickstart>QUICKSTART
<span class=button_tally>2</span></a>
<a href=https://atbug.com/categories/%E8%BD%AF%E4%BB%B6/ class="post_tag button button_translucent" title=软件>软件
<span class=button_tally>2</span></a>
<a href=https://atbug.com/categories/devops/ class="post_tag button button_translucent" title=devops>DEVOPS
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/envoy/ class="post_tag button button_translucent" title=envoy>ENVOY
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/serverless/ class="post_tag button button_translucent" title=serverless>SERVERLESS
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%AE%B9%E5%99%A8/ class="post_tag button button_translucent" title=容器>容器
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%B7%A5%E5%85%B7/ class="post_tag button button_translucent" title=工具>工具
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ class="post_tag button button_translucent" title=微服务>微服务
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%8A%98%E8%85%BE/ class="post_tag button button_translucent" title=折腾>折腾
<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%B5%8B%E8%AF%95/ class="post_tag button button_translucent" title=测试>测试
<span class=button_tally>1</span></a><br><div class="post_tags_toggle button">所有分类</div><div class=post_tags><div class=tags_list><a href=https://atbug.com/categories/devops/ class="post_tag button button_translucent" data-position=1 title=devops>DEVOPS<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/envoy/ class="post_tag button button_translucent" data-position=1 title=envoy>ENVOY<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/quickstart/ class="post_tag button button_translucent" data-position=2 title=quickstart>QUICKSTART<span class=button_tally>2</span></a>
<a href=https://atbug.com/categories/serverless/ class="post_tag button button_translucent" data-position=1 title=serverless>SERVERLESS<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%AD%A6%E4%B9%A0/ class="post_tag button button_translucent" data-position=40 title=学习>学习<span class=button_tally>40</span></a>
<a href=https://atbug.com/categories/%E5%AE%B9%E5%99%A8/ class="post_tag button button_translucent" data-position=1 title=容器>容器<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%B7%A5%E5%85%B7/ class="post_tag button button_translucent" data-position=1 title=工具>工具<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ class="post_tag button button_translucent" data-position=1 title=微服务>微服务<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%8A%98%E8%85%BE/ class="post_tag button button_translucent" data-position=1 title=折腾>折腾<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%B5%8B%E8%AF%95/ class="post_tag button button_translucent" data-position=1 title=测试>测试<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%BA%90%E7%A0%81/ class="post_tag button button_translucent" data-position=1 title=源码>源码<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class="post_tag button button_translucent" data-position=1 title=源码分析>源码分析<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/ class="post_tag button button_translucent" data-position=4 title=源码解析>源码解析<span class=button_tally>4</span></a>
<a href=https://atbug.com/categories/%E7%AC%94%E8%AE%B0/ class="post_tag button button_translucent" data-position=45 title=笔记>笔记<span class=button_tally>45</span></a>
<a href=https://atbug.com/categories/%E7%BD%91%E5%85%B3/ class="post_tag button button_translucent" data-position=1 title=网关>网关<span class=button_tally>1</span></a>
<a href=https://atbug.com/categories/%E7%BF%BB%E8%AF%91/ class="post_tag button button_translucent" data-position=7 title=翻译>翻译<span class=button_tally>7</span></a>
<a href=https://atbug.com/categories/%E8%BD%AF%E4%BB%B6/ class="post_tag button button_translucent" data-position=2 title=软件>软件<span class=button_tally>2</span></a><div class=tags_sort><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span></div><span class=tags_hide><svg class="icon"><use xlink:href="#closeme"/></svg></span></div></div></nav></div><div><h2 class="mt-4 taxonomy" id=tags-section>标签</h2><nav class=tags_nav><a href=https://atbug.com/tags/java/ class="post_tag button button_translucent" title=java>JAVA
<span class=button_tally>25</span></a>
<a href=https://atbug.com/tags/kubernetes/ class="post_tag button button_translucent" title=kubernetes>KUBERNETES
<span class=button_tally>17</span></a>
<a href=https://atbug.com/tags/kafka/ class="post_tag button button_translucent" title=kafka>KAFKA
<span class=button_tally>9</span></a>
<a href=https://atbug.com/tags/go/ class="post_tag button button_translucent" title=go>GO
<span class=button_tally>8</span></a>
<a href=https://atbug.com/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/ class="post_tag button button_translucent" title=云原生>云原生
<span class=button_tally>8</span></a>
<a href=https://atbug.com/tags/spring-cloud/ class="post_tag button button_translucent" title=spring-cloud>SPRING-CLOUD
<span class=button_tally>7</span></a>
<a href=https://atbug.com/tags/tekton/ class="post_tag button button_translucent" title=tekton>TEKTON
<span class=button_tally>7</span></a>
<a href=https://atbug.com/tags/cicd/ class="post_tag button button_translucent" title=cicd>CICD
<span class=button_tally>6</span></a>
<a href=https://atbug.com/tags/docker/ class="post_tag button button_translucent" title=docker>DOCKER
<span class=button_tally>6</span></a>
<a href=https://atbug.com/tags/spring/ class="post_tag button button_translucent" title=spring>SPRING
<span class=button_tally>5</span></a>
<a href=https://atbug.com/tags/netflix/ class="post_tag button button_translucent" title=netflix>NETFLIX
<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/quarkus/ class="post_tag button button_translucent" title=quarkus>QUARKUS
<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/%E6%9E%B6%E6%9E%84/ class="post_tag button button_translucent" title=架构>架构
<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/eureka/ class="post_tag button button_translucent" title=eureka>EUREKA
<span class=button_tally>3</span></a><br><div class="post_tags_toggle button">所有标签</div><div class=post_tags><div class=tags_list><a href=https://atbug.com/tags/alpine/ class="post_tag button button_translucent" data-position=1 title=alpine>ALPINE<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/apache-camel/ class="post_tag button button_translucent" data-position=1 title=apache-camel>APACHE-CAMEL<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/benchmark/ class="post_tag button button_translucent" data-position=2 title=benchmark>BENCHMARK<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/c3p0/ class="post_tag button button_translucent" data-position=1 title=c3p0>C3P0<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/cas/ class="post_tag button button_translucent" data-position=1 title=cas>CAS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/cassandra/ class="post_tag button button_translucent" data-position=1 title=cassandra>CASSANDRA<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/centos/ class="post_tag button button_translucent" data-position=1 title=centos>CENTOS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/chrome/ class="post_tag button button_translucent" data-position=1 title=chrome>CHROME<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/ci/cd/ class="post_tag button button_translucent" data-position=1 title=ci/cd>CI/CD<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/cicd/ class="post_tag button button_translucent" data-position=6 title=cicd>CICD<span class=button_tally>6</span></a>
<a href=https://atbug.com/tags/dapr/ class="post_tag button button_translucent" data-position=1 title=dapr>DAPR<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/database/ class="post_tag button button_translucent" data-position=1 title=database>DATABASE<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/debug/ class="post_tag button button_translucent" data-position=1 title=debug>DEBUG<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/dekorate/ class="post_tag button button_translucent" data-position=1 title=dekorate>DEKORATE<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/develop/ class="post_tag button button_translucent" data-position=1 title=develop>DEVELOP<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/devops/ class="post_tag button button_translucent" data-position=1 title=devops>DEVOPS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/docekr/ class="post_tag button button_translucent" data-position=1 title=docekr>DOCEKR<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/docker/ class="post_tag button button_translucent" data-position=6 title=docker>DOCKER<span class=button_tally>6</span></a>
<a href=https://atbug.com/tags/elasticsearch/ class="post_tag button button_translucent" data-position=1 title=elasticsearch>ELASTICSEARCH<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/envoy/ class="post_tag button button_translucent" data-position=1 title=envoy>ENVOY<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/eureka/ class="post_tag button button_translucent" data-position=3 title=eureka>EUREKA<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/extension/ class="post_tag button button_translucent" data-position=1 title=extension>EXTENSION<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/flume/ class="post_tag button button_translucent" data-position=1 title=flume>FLUME<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/git/ class="post_tag button button_translucent" data-position=1 title=git>GIT<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/go/ class="post_tag button button_translucent" data-position=8 title=go>GO<span class=button_tally>8</span></a>
<a href=https://atbug.com/tags/golang/ class="post_tag button button_translucent" data-position=1 title=golang>GOLANG<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/google/ class="post_tag button button_translucent" data-position=1 title=google>GOOGLE<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/greenplum/ class="post_tag button button_translucent" data-position=1 title=greenplum>GREENPLUM<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/groovy/ class="post_tag button button_translucent" data-position=1 title=groovy>GROOVY<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/haproxy/ class="post_tag button button_translucent" data-position=1 title=haproxy>HAPROXY<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/hpa/ class="post_tag button button_translucent" data-position=1 title=hpa>HPA<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/https/ class="post_tag button button_translucent" data-position=1 title=https>HTTPS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/hystrix/ class="post_tag button button_translucent" data-position=3 title=hystrix>HYSTRIX<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/istio/ class="post_tag button button_translucent" data-position=3 title=istio>ISTIO<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/java/ class="post_tag button button_translucent" data-position=25 title=java>JAVA<span class=button_tally>25</span></a>
<a href=https://atbug.com/tags/java8/ class="post_tag button button_translucent" data-position=1 title=java8>JAVA8<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/jenkins/ class="post_tag button button_translucent" data-position=3 title=jenkins>JENKINS<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/jib/ class="post_tag button button_translucent" data-position=2 title=jib>JIB<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/json/ class="post_tag button button_translucent" data-position=1 title=json>JSON<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/jvm/ class="post_tag button button_translucent" data-position=1 title=jvm>JVM<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/kafka/ class="post_tag button button_translucent" data-position=9 title=kafka>KAFKA<span class=button_tally>9</span></a>
<a href=https://atbug.com/tags/knative/ class="post_tag button button_translucent" data-position=2 title=knative>KNATIVE<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/kubelet/ class="post_tag button button_translucent" data-position=1 title=kubelet>KUBELET<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/kubenetes/ class="post_tag button button_translucent" data-position=1 title=kubenetes>KUBENETES<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/kubernetes/ class="post_tag button button_translucent" data-position=17 title=kubernetes>KUBERNETES<span class=button_tally>17</span></a>
<a href=https://atbug.com/tags/kuernetes/ class="post_tag button button_translucent" data-position=1 title=kuernetes>KUERNETES<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/kvm/ class="post_tag button button_translucent" data-position=1 title=kvm>KVM<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/linux/ class="post_tag button button_translucent" data-position=3 title=linux>LINUX<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/log4j/ class="post_tag button button_translucent" data-position=1 title=log4j>LOG4J<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/macos/ class="post_tag button button_translucent" data-position=1 title=macos>MACOS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/metaspace/ class="post_tag button button_translucent" data-position=1 title=metaspace>METASPACE<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/minishift/ class="post_tag button button_translucent" data-position=1 title=minishift>MINISHIFT<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/mybatis/ class="post_tag button button_translucent" data-position=1 title=mybatis>MYBATIS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/mysql/ class="post_tag button button_translucent" data-position=1 title=mysql>MYSQL<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/netflix/ class="post_tag button button_translucent" data-position=4 title=netflix>NETFLIX<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/nginx/ class="post_tag button button_translucent" data-position=2 title=nginx>NGINX<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/oci/ class="post_tag button button_translucent" data-position=1 title=oci>OCI<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/opa/ class="post_tag button button_translucent" data-position=1 title=opa>OPA<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/openshift/ class="post_tag button button_translucent" data-position=3 title=openshift>OPENSHIFT<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/ops/ class="post_tag button button_translucent" data-position=1 title=ops>OPS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/pipy/ class="post_tag button button_translucent" data-position=1 title=pipy>PIPY<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/plugin/ class="post_tag button button_translucent" data-position=1 title=plugin>PLUGIN<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/prometheus/ class="post_tag button button_translucent" data-position=1 title=prometheus>PROMETHEUS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/quarkus/ class="post_tag button button_translucent" data-position=4 title=quarkus>QUARKUS<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/rabbitmq/ class="post_tag button button_translucent" data-position=1 title=rabbitmq>RABBITMQ<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/raft/ class="post_tag button button_translucent" data-position=1 title=raft>RAFT<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/redis/ class="post_tag button button_translucent" data-position=2 title=redis>REDIS<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/reids/ class="post_tag button button_translucent" data-position=1 title=reids>REIDS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/ribbon/ class="post_tag button button_translucent" data-position=2 title=ribbon>RIBBON<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/scala/ class="post_tag button button_translucent" data-position=2 title=scala>SCALA<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/serializer/ class="post_tag button button_translucent" data-position=1 title=serializer>SERIALIZER<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/serverless/ class="post_tag button button_translucent" data-position=1 title=serverless>SERVERLESS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/service-mesh/ class="post_tag button button_translucent" data-position=2 title=service-mesh>SERVICE-MESH<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/skaffold/ class="post_tag button button_translucent" data-position=1 title=skaffold>SKAFFOLD<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/slf4j/ class="post_tag button button_translucent" data-position=1 title=slf4j>SLF4J<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/spring/ class="post_tag button button_translucent" data-position=5 title=spring>SPRING<span class=button_tally>5</span></a>
<a href=https://atbug.com/tags/spring-boot/ class="post_tag button button_translucent" data-position=3 title=spring-boot>SPRING-BOOT<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/spring-cloud/ class="post_tag button button_translucent" data-position=7 title=spring-cloud>SPRING-CLOUD<span class=button_tally>7</span></a>
<a href=https://atbug.com/tags/ssl/ class="post_tag button button_translucent" data-position=1 title=ssl>SSL<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/tekton/ class="post_tag button button_translucent" data-position=7 title=tekton>TEKTON<span class=button_tally>7</span></a>
<a href=https://atbug.com/tags/tomcat/ class="post_tag button button_translucent" data-position=1 title=tomcat>TOMCAT<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/tools/ class="post_tag button button_translucent" data-position=1 title=tools>TOOLS<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/troubleshooting/ class="post_tag button button_translucent" data-position=1 title=troubleshooting>TROUBLESHOOTING<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/zuul/ class="post_tag button button_translucent" data-position=3 title=zuul>ZUUL<span class=button_tally>3</span></a>
<a href=https://atbug.com/tags/%E4%B8%80%E8%87%B4%E6%80%A7/ class="post_tag button button_translucent" data-position=1 title=一致性>一致性<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/ class="post_tag button button_translucent" data-position=8 title=云原生>云原生<span class=button_tally>8</span></a>
<a href=https://atbug.com/tags/%E5%88%86%E5%B8%83%E5%BC%8F/ class="post_tag button button_translucent" data-position=1 title=分布式>分布式<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E5%91%8A%E8%AD%A6/ class="post_tag button button_translucent" data-position=1 title=告警>告警<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ class="post_tag button button_translucent" data-position=1 title=多线程>多线程<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E5%AD%A6%E4%B9%A0/ class="post_tag button button_translucent" data-position=1 title=学习>学习<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E5%AE%89%E5%85%A8/ class="post_tag button button_translucent" data-position=1 title=安全>安全<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ class="post_tag button button_translucent" data-position=1 title=微服务>微服务<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2/ class="post_tag button button_translucent" data-position=1 title=数据平面>数据平面<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E6%96%AD%E8%B7%AF%E5%99%A8/ class="post_tag button button_translucent" data-position=1 title=断路器>断路器<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ class="post_tag button button_translucent" data-position=1 title=最佳实践>最佳实践<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E6%9E%B6%E6%9E%84/ class="post_tag button button_translucent" data-position=4 title=架构>架构<span class=button_tally>4</span></a>
<a href=https://atbug.com/tags/%E6%BA%90%E7%A0%81/ class="post_tag button button_translucent" data-position=2 title=源码>源码<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/%E7%AE%97%E6%B3%95/ class="post_tag button button_translucent" data-position=1 title=算法>算法<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E7%BA%BF%E7%A8%8B/ class="post_tag button button_translucent" data-position=1 title=线程>线程<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E7%BD%91%E5%85%B3/ class="post_tag button button_translucent" data-position=2 title=网关>网关<span class=button_tally>2</span></a>
<a href=https://atbug.com/tags/%E7%BF%BB%E8%AF%91/ class="post_tag button button_translucent" data-position=1 title=翻译>翻译<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/ class="post_tag button button_translucent" data-position=1 title=负载均衡>负载均衡<span class=button_tally>1</span></a>
<a href=https://atbug.com/tags/%E9%9A%8F%E7%AC%94/ class="post_tag button button_translucent" data-position=1 title=随笔>随笔<span class=button_tally>1</span></a><div class=tags_sort><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span></div><span class=tags_hide><svg class="icon"><use xlink:href="#closeme"/></svg></span></div></div></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078A3.56 3.56.0 008.766 5.383c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><img src=https://atbug.com/icons/apple-touch-icon.png class="icon icon_2 transparent" alt=乱世浮生><p>Copyright&nbsp;2015 -&nbsp;<span class=year></span>&nbsp;乱世浮生. All Rights Reserved</p><a class=to_top href=#documentTop><svg class="icon"><use xlink:href="#arrow"/></svg></a></div></footer><script type=text/javascript src=https://atbug.com/js/bundle.min.90cbe84f27859868a1c2f20af76ac2cc69c32540555dbbdae845870af41ba688e06385e7e720680cc34e65b9fdd5381585b444e33c735f35d05e6c5dc7d7bdc0.js integrity="sha512-kMvoTyeFmGihwvIK92rCzGnDJUBVXbva6EWHCvQbpojgY4Xn5yBoDMNOZbn91TgVhbRE4zxzXzXQXmxdx9e9wA==" crossorigin=anonymous></script></body></html>